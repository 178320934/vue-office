import{n as Ft}from"./jszip.min-391c5e2f.js";import{l}from"./lodash-cf981bf5.js";import{d as zt,_ as Ut,r as _t,o as Ht,w as Wt,a as Ct,c as Vt,b as Xt,e as Zt,f as Qt,g as Gt,u as Yt}from"./index-69842e67.js";import{P as qt,u as ht}from"./PreviewWrapper-d9a4255b.js";import"./_commonjs-dynamic-modules-302442b1.js";var pt=function(n,t){return pt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(r[a]=e[a])},pt(n,t)};function Lt(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");pt(n,t);function r(){this.constructor=n}n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var B=function(){return B=Object.assign||function(t){for(var r,e=1,a=arguments.length;e<a;e++){r=arguments[e];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},B.apply(this,arguments)};function j(n,t,r,e){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(h){try{f(e.next(h))}catch(g){o(g)}}function u(h){try{f(e.throw(h))}catch(g){o(g)}}function f(h){h.done?s(h.value):a(h.value).then(c,u)}f((e=e.apply(n,t||[])).next())})}function E(n,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},e,a,s,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=c(0),o.throw=c(1),o.return=c(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(f){return function(h){return u([f,h])}}function u(f){if(e)throw new TypeError("Generator is already executing.");for(;o&&(o=0,f[0]&&(r=0)),r;)try{if(e=1,a&&(s=f[0]&2?a.return:f[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,f[1])).done)return s;switch(a=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,a=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(n,r)}catch(h){f=[6,h],a=0}finally{e=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function st(n,t,r){if(r||arguments.length===2)for(var e=0,a=t.length,s;e<a;e++)(s||!(e in t))&&(s||(s=Array.prototype.slice.call(t,0,e)),s[e]=t[e]);return n.concat(s||Array.prototype.slice.call(t))}var I=[];for(var ot=0;ot<256;++ot)I.push((ot+256).toString(16).slice(1));function Jt(n,t=0){return(I[n[t+0]]+I[n[t+1]]+I[n[t+2]]+I[n[t+3]]+"-"+I[n[t+4]]+I[n[t+5]]+"-"+I[n[t+6]]+I[n[t+7]]+"-"+I[n[t+8]]+I[n[t+9]]+"-"+I[n[t+10]]+I[n[t+11]]+I[n[t+12]]+I[n[t+13]]+I[n[t+14]]+I[n[t+15]]).toLowerCase()}var tt,$t=new Uint8Array(16);function Kt(){if(!tt&&(tt=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!tt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return tt($t)}var te=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const ft={randomUUID:te};function ee(n,t,r){if(ft.randomUUID&&!t&&!n)return ft.randomUUID();n=n||{};var e=n.random||(n.rng||Kt)();if(e[6]=e[6]&15|64,e[8]=e[8]&63|128,t){r=r||0;for(var a=0;a<16;++a)t[r+a]=e[a];return t}return Jt(e)}function _(n){return n/12700}function yt(n){return n/100}function Mt(n){return n/6e4}function dt(n){return n/1e5}function it(n){var t=Math.ceil(n/26),r=(n%26||26)-1+65;return String.fromCharCode(r).repeat(t)}var Nt=function(){function n(t,r){this.uuid=ee(),this.offset={x:0,y:0},this.extend={w:0,h:0},this.rotate=0,this.order=0,this.flipV=!1,this.flipH=!1,this.source=t,this.ctx=r;var e=l.get(t,["p:nvSpPr","p:nvPr"]);if(e){var a=l.get(e,"p:ph");a&&a.attrs&&(this.idx=a.attrs.idx,this.type=a.attrs.type),l.get(e,["attrs","userDrawn"])&&(this.userDrawn=l.get(e,["attrs","userDrawn"])==="1")}if(this.order=l.get(t,"attrs.order",0),this.source["p:spPr"]){var s=this.getXfrm();s&&(this.offset={x:Math.round(_(parseInt(s["a:off"].attrs.x))),y:Math.round(_(parseInt(s["a:off"].attrs.y)))},this.extend={w:Math.round(_(parseInt(s["a:ext"].attrs.cx))),h:Math.round(_(parseInt(s["a:ext"].attrs.cy)))},this.rotate=Mt(parseInt(l.get(s,"attrs.rot",0))),this.flipV=l.get(s,"attrs.flipV")==="1",this.flipH=l.get(s,"attrs.flipH")==="1")}}return Object.defineProperty(n.prototype,"theme",{get:function(){return(this.ctx.sliderMaster||this.ctx).theme},enumerable:!1,configurable:!0}),n.prototype.getColorThemeName=function(t){return this.ctx.getColorThemeName(t)},n.prototype.getXfrm=function(){var t=this.source["p:spPr"]["a:xfrm"];return t||(this.idx?t=this.ctx.getNodeInheritAttrsByIdx(this.idx,["p:spPr","a:xfrm"]):this.type&&(t=this.ctx.getNodeInheritAttrsByType(this.type,["p:spPr","a:xfrm"]))),t},n}(),q=function(n){function t(r,e,a,s){var o=n.call(this,e,s)||this;o.userDrawn=!0,o.pptx=a,o.path=r;var c=l.get(o.source,["p:blipFill","a:srcRect"]);return c&&(o.clip={},c.attrs.b&&(o.clip.b=parseInt(c.attrs.b)/1e5),c.attrs.t&&(o.clip.t=parseInt(c.attrs.t)/1e5),c.attrs.l&&(o.clip.l=parseInt(c.attrs.l)/1e5),c.attrs.r&&(o.clip.r=parseInt(c.attrs.r)/1e5)),o}return Lt(t,n),Object.defineProperty(t.prototype,"base64",{get:function(){return this.pptx.getMedia(this.path)},enumerable:!1,configurable:!0}),t}(Nt);function T(n,t,r){var e={type:"solidFill"};if(n["a:srgbClr"])e.color="#"+n["a:srgbClr"].attrs.val;else if(n["a:schemeClr"]){var a=n["a:schemeClr"].attrs.val;r&&(a=r.getColorThemeName(a)),e.color=t.getColor(a)}else n["a:sysClr"]&&(e.color="#"+n["a:sysClr"].attrs.lastClr);var s=n["a:srgbClr"]||n["a:schemeClr"]||n["a:sysClr"],o=l.get(s,["a:alpha","attrs","val"],1e5);e.alpha=o/1e5;var c=l.get(s,["a:shade","attrs","val"]);c&&(e.shade=c/1e5);var u=l.get(s,["a:lumMod","attrs","val"]);u&&(e.lumMod=u/1e5);var f=l.get(s,["a:lumOff","attrs","val"]);return f&&(e.lumOff=f/1e5),e}function at(n,t,r){var e,a={type:"blipFill"},s=l.get(n,["a:blip","attrs","r:embed"]);if(s){var o=(e=r.rels[s])===null||e===void 0?void 0:e.target;o&&(a.base64=t.getMedia(o))}var c=l.get(n,["a:blip","a:alphaModFix","attrs","amt"]);c&&(a.alpha=c/1e5);var u=l.get(n,["a:stretch","a:fillRect","attrs"]);return u&&(a.fillRect={},u.b&&(a.fillRect.b=u.b/1e5),u.t&&(a.fillRect.t=u.t/1e5),u.r&&(a.fillRect.r=u.r/1e5),u.l&&(a.fillRect.l=u.l/1e5)),a}function ct(n){return n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function lt(n){return n<.0031308?12.92*n:1.055*Math.pow(n,1/2.4)-.055}function R(n){if(!n||n.type==="none")return"";if(n.type==="solidFill"&&/^#[\da-fA-F]{3,6}$/.test(n.color)){var t=parseInt(n.color.substr(1,2),16),r=parseInt(n.color.substr(3,2),16),e=parseInt(n.color.substr(5,2),16);if(n.shade){var a=function(o,c){var u=o[0],f=o[1],h=o[2],g=ct(u/255)*c,b=ct(f/255)*c,A=ct(h/255)*c;return[Math.round(255*lt(g)),Math.round(255*lt(b)),Math.round(255*lt(A))]}([t,r,e],n.shade);t=a[0],r=a[1],e=a[2]}var s=n.alpha;return"rgba(".concat(t,",").concat(r,",").concat(e,",").concat(s,")")}}var re=function(){function n(t,r){this.props={},this.inheritProps={},this.source=t,this.node=r,this._getInheritBodyProps(),this._parseBodyProps(),this._parseLstStyle(),this._parseText()}return n.prototype._getInheritBodyProps=function(){var t,r=this.node.ctx,e=this.node.type,a=this.node.idx;if(e||a)switch(r.slideType){case"slideMaster":break;case"slideLayout":(t=e?r.slideMaster.getNodeByType(e):r.slideMaster.getNodeByIdx(a))&&(this.inheritProps=l.get(t,["textBody","props"])||{});break;case"slide":(t=e?r.slideLayout.slideMaster.getNodeByType(e):r.slideLayout.slideMaster.getNodeByIdx(a))&&Object.assign(this.inheritProps,l.get(t,["textBody","props"])||{}),(t=e?r.slideLayout.getNodeByType(e):r.slideLayout.getNodeByIdx(a))&&Object.assign(this.inheritProps,l.get(t,["textBody","props"])||{})}},n.prototype._parseBodyProps=function(){var t=this,r=l.get(this.source,["a:bodyPr","attrs"])||{};Object.keys(r).forEach(function(o){switch(o){case"anchor":t.props.anchor=r[o];break;case"rtlCol":t.props.rtlCol=r[o]==="1";break;case"lIns":case"rIns":case"tIns":case"bIns":t.props[o]=_(parseInt(r[o]));break;case"order":break;default:t.props[o]=r[o]}});var e=l.get(this.source,["a:bodyPr","a:normAutofit","attrs"]);if(e){this.props.normAutofit={};var a=e.fontScale;a&&(this.props.normAutofit.fontScale=dt(parseInt(a)));var s=e.lnSpcReduction;s&&(this.props.normAutofit.lnSpcReduction=dt(parseInt(s)))}},n.prototype._parseLstStyle=function(){var t=this,r={},e=l.get(this.source,"a:lstStyle")||{};Object.keys(e).forEach(function(a){if(a.startsWith("a:")&&a.endsWith("pPr")){var s=a.substr(2,a.length-5);r[s]={props:t._formatPPr(e[a])};var o=l.get(e[a],["a:defRPr"]);r[s].defRPr=t._formatRPr(o)}}),this.lstStyle=r},n.prototype._parseText=function(){var t=this,r=l.get(this.source,["a:p"])||[];Array.isArray(r)||(r=[r]),this.paragraphs=r.map(function(e){return t._parseParagraph(e)})},n.prototype._parseParagraph=function(t){var r=this,e={props:{},inheritProps:{},inheritRProps:{},endParaRProps:{},rows:[]},a=l.get(t,["a:pPr"])||{};e.props=this._formatPPr(a);var s=l.get(t,["a:endParaRPr"]);e.endParaRProps=this._formatRPr(s);var o=l.get(t,["a:r"])||[];Array.isArray(o)||(o=[o]);var c=l.get(t,["a:br"])||[];return Array.isArray(c)||(c=[c]),(o=o.concat(c.map(function(u){return B({isBr:!0},u)}))).sort(function(u,f){return l.get(u,["attrs","order"])-l.get(f,["attrs","order"])}),e.rows=o.map(function(u){return r._parseRow(u)}),e.inheritProps=this._getInheritPProps(e.props.level),e.inheritRProps=this._getInheritRProps(e.props.level),e},n.prototype._getInheritPProps=function(t){t===void 0&&(t="0");var r,e={},a=this.node.ctx,s=this.node.type,o=this.node.idx;switch(a.slideType){case"slideMaster":this.node.isTextBox?Object.assign(e,l.get(a.defaultTextStyle,["lvl".concat(t?+t+1:1),"props"])||{}):Object.assign(e,l.get(a,["textStyles","otherStyle","lvl".concat(t?+t+1:1),"props"])||{});break;case"slideLayout":this.node.isTextBox?Object.assign(e,l.get(a.slideMaster.defaultTextStyle,["lvl".concat(t?+t+1:1),"props"])||{}):Object.assign(e,l.get(a.slideMaster,["textStyles","otherStyle","lvl".concat(t?+t+1:1),"props"])||{}),(s||o)&&(r=s?a.slideMaster.getNodeByType(s):a.slideMaster.getNodeByIdx(o))&&Object.assign(e,l.get(r,["textBody","lstStyle","lvl".concat(t?+t+1:1),"props"])||{});break;case"slide":this.node.isTextBox?Object.assign(e,l.get(a.slideLayout.slideMaster.defaultTextStyle,["lvl".concat(t?+t+1:1),"props"])||{}):Object.assign(e,l.get(a.slideLayout.slideMaster,["textStyles","otherStyle","lvl".concat(t?+t+1:1),"props"])||{}),(s||o)&&(["subTitle","ctrTitle","title"].includes(s)&&Object.assign(e,l.get(a.slideLayout.slideMaster,["textStyles","titleStyle","lvl".concat(t?+t+1:1),"props"])||{}),(r=s?a.slideLayout.slideMaster.getNodeByType(s):a.slideLayout.slideMaster.getNodeByIdx(o))&&Object.assign(e,l.get(r,["textBody","lstStyle","lvl".concat(t?+t+1:1),"props"])||{}),(r=s?a.slideLayout.getNodeByType(s):a.slideLayout.getNodeByIdx(o))&&Object.assign(e,l.get(r,["textBody","lstStyle","lvl".concat(t?+t+1:1),"props"])||{}))}return e},n.prototype._getInheritRProps=function(t){t===void 0&&(t="0");var r,e={},a=this.node.ctx,s=this.node.type,o=this.node.idx;switch(a.slideType){case"slideMaster":this.node.isTextBox?Object.assign(e,l.get(a.defaultTextStyle,["lvl".concat(t?+t+1:1),"defRPr"])||{}):Object.assign(e,l.get(a,["textStyles","otherStyle","lvl".concat(t?+t+1:1),"defRPr"])||{});break;case"slideLayout":this.node.isTextBox?Object.assign(e,l.get(a.slideMaster.defaultTextStyle,["lvl".concat(t?+t+1:1),"defRPr"])||{}):Object.assign(e,l.get(a.slideMaster,["textStyles","otherStyle","lvl".concat(t?+t+1:1),"defRPr"])||{}),(s||o)&&(r=s?a.slideMaster.getNodeByType(s):a.slideMaster.getNodeByIdx(o))&&(e=l.get(r,["textBody","lstStyle","lvl".concat(t?+t+1:1),"defRPr"])||{});break;case"slide":this.node.isTextBox?Object.assign(e,l.get(a.slideLayout.slideMaster.defaultTextStyle,["lvl".concat(t?+t+1:1),"defRPr"])||{}):Object.assign(e,l.get(a.slideLayout.slideMaster,["textStyles","otherStyle","lvl".concat(t?+t+1:1),"defRPr"])||{}),(s||o)&&(["subTitle","ctrTitle","title"].includes(s)&&Object.assign(e,l.get(a.slideLayout.slideMaster,["textStyles","titleStyle","lvl".concat(t?+t+1:1),"defRPr"])||{}),(r=s?a.slideLayout.slideMaster.getNodeByType(s):a.slideLayout.slideMaster.getNodeByIdx(o))&&Object.assign(e,l.get(r,["textBody","lstStyle","lvl".concat(t?+t+1:1),"defRPr"])||{}),(r=s?a.slideLayout.getNodeByType(s):a.slideLayout.getNodeByIdx(o))&&Object.assign(e,l.get(r,["textBody","lstStyle","lvl".concat(t?+t+1:1),"defRPr"])||{}))}var c=l.get(this.node.source,["p:style","a:fontRef"]);return l.get(c,"a:schemeClr")&&(e.color=T(c,this.node.theme,this.node)),l.get(this.lstStyle,["lvl".concat(t?+t+1:1),"defRPr"])&&Object.assign(e,l.get(this.lstStyle,["lvl".concat(t?+t+1:1),"defRPr"])),e},n.prototype._formatPPr=function(t){var r={},e=l.get(t,"attrs")||{};return Object.keys(e).forEach(function(a){switch(a){case"algn":r.align=e[a];break;case"marL":r.marginLeft=_(parseInt(e[a]));break;case"indent":r.indent=_(parseInt(e[a]));break;case"lvl":r.level=e[a]}}),l.get(t,["a:lnSpc","a:spcPct","attrs","val"])&&(r.lineHeight=parseInt(t["a:lnSpc"]["a:spcPct"].attrs.val)/1e5),l.get(t,["a:buAutoNum","attrs","type"])&&(r.buAutoNum=t["a:buAutoNum"].attrs.type),l.get(t,["a:buChar","attrs","char"])&&(r.buChar=t["a:buChar"].attrs.char),l.get(t,["a:spcBef","a:spcPts","attrs","val"])&&(r.spaceBefore=yt(parseInt(t["a:spcBef"]["a:spcPts"].attrs.val))),l.get(t,["a:spcAft","a:spcPts","attrs","val"])&&(r.spaceAfter=yt(parseInt(t["a:spcAft"]["a:spcPts"].attrs.val))),r},n.prototype._parseRow=function(t){if(t.isBr)return{isBr:!0};var r={props:{},text:""},e=l.get(t,["a:rPr"])||{};return r.props=this._formatRPr(e),r.text=l.get(t,"a:t")||"",r},n.prototype._formatRPr=function(t){var r={},e=l.get(t,"attrs")||{};Object.keys(e).forEach(function(o){switch(o){case"sz":r.size=parseInt(e[o])/100;break;case"b":r.bold=e[o]==="1";break;case"i":r.italic=e[o]==="1";break;case"u":r.underline=e[o];break;case"strike":r.strike=e[o];break;case"order":case"dirty":break;default:r[o]=e[o]}});var a=l.get(t,"a:solidFill");a&&(r.color=T(a,this.node.theme,this.node));var s=l.get(t,"a:highlight");return s&&(r.background=T(s,this.node.theme,this.node)),r},n}(),X=function(n){function t(r,e,a){var s=n.call(this,r,a)||this;return s.border={},s.prstGeom={},s.isTextBox=!1,s.pptx=e,s.shape=l.get(r,["p:spPr","a:prstGeom","attrs","prst"]),s._parIsTextBox(),s._parsePrstGeom(),s._parseBackground(),s._parseBorder(),s._parseTxt(),s}return Lt(t,n),t.prototype._parIsTextBox=function(){this.isTextBox=l.get(this.source,["p:nvSpPr","p:cNvSpPr","attrs","txBox"])==="1"},t.prototype._parsePrstGeom=function(){var r=l.get(this.source,["p:spPr","a:prstGeom"]),e=l.get(r,["a:avLst","a:gd"]);e&&(Array.isArray(e)||(e=[e]),this.prstGeom.gd=e.map(function(a){return{name:a.attrs.name,fmla:dt(parseInt(a.attrs.fmla.split(" ")[1]))}}))},t.prototype._parseBackground=function(){if(!l.get(this.source,["p:spPr","a:noFill"])){var r=l.get(this.source,["p:spPr","a:solidFill"]);if(r)this.background=T(r,this.theme,this);else if(!l.get(this.source,["p:spPr","a:gradFill"])){var e=l.get(this.source,["p:spPr","a:blipFill"]);if(e)this.background=at(e,this.pptx,this.ctx);else{var a=l.get(this.source,["p:style","a:fillRef"]);a&&(this.background=T(a,this.theme,this))}}}},t.prototype._parseBorder=function(){var r=l.get(this.source,["p:style","a:lnRef"]);if(r){var e=parseInt(r.attrs.idx),a=this.theme.getLineStyle(e);this.border=B(B({},a),this.border),this.border.color&&this.border.color.color||(this.border.color=T(r,this.theme,this))}var s=l.get(this.source,["p:spPr","a:ln"]);if(s){if(l.get(s,"a:noFill"))return;l.get(s,"attrs.w")&&(this.border.width=_(parseInt(l.get(s,"attrs.w"))));var o=l.get(s,"a:solidFill");o&&(this.border.color=T(o,this.theme,this));var c=l.get(s,"a:prstDash");if(c&&(this.border.type=c.attrs.val),l.get(s,["a:miter"])&&(this.border.lineJoin="miter"),l.get(s,["a:bevel"])&&(this.border.lineJoin="bevel"),l.get(s,["a:round"])&&(this.border.lineJoin="round"),l.get(s,["a:miter","attrs","lim"])&&(this.border.miterLim=_(parseInt(l.get(s,["a:miter","attrs","lim"])))),l.get(s,["a:headEnd"])){var u=l.get(s,["a:headEnd","attrs"]);this.border.headEnd={type:u.type,len:u.len,w:u.w}}if(l.get(s,["a:tailEnd"])){var f=l.get(s,["a:tailEnd","attrs"]);this.border.tailEnd={type:f.type,len:f.len,w:f.w}}Object.assign(this.border,l.omit(l.get(s,"attrs")||{},["w","order"]))}this.border.color&&this.border.color.color&&!this.border.width&&(this.border.width=t.defaultBorderWidth)},t.prototype._parseTxt=function(){this.textBody=new re(l.get(this.source,["p:txBody"]),this)},t.defaultBorderWidth=.75,t}(Nt),ut=function(){function n(t,r,e){if(this.offset={x:0,y:0},this.chOffset={x:0,y:0},this.extend={w:0,h:0},this.chExtend={w:0,h:0},this.rotate=0,this.nodes=[],this.flipV=!1,this.flipH=!1,this.order=l.get(t,["attrs","order"]),this.pptx=r,this.ctx=e,this.source=t,this.source["p:grpSpPr"]){var a=l.get(this.source,["p:grpSpPr","a:xfrm"]);a&&(this.offset={x:Math.round(_(parseInt(a["a:off"].attrs.x))),y:Math.round(_(parseInt(a["a:off"].attrs.y)))},this.chOffset={x:Math.round(_(parseInt(a["a:chOff"].attrs.x))),y:Math.round(_(parseInt(a["a:chOff"].attrs.y)))},this.extend={w:Math.round(_(parseInt(a["a:ext"].attrs.cx))),h:Math.round(_(parseInt(a["a:ext"].attrs.cy)))},this.chExtend={w:Math.round(_(parseInt(a["a:chExt"].attrs.cx))),h:Math.round(_(parseInt(a["a:chExt"].attrs.cy)))},this.rotate=Mt(parseInt(l.get(a,"attrs.rot",0))),this.flipV=l.get(a,"attrs.flipV")==="1",this.flipH=l.get(a,"attrs.flipH")==="1")}this._parseNodes()}return n.prototype._parseNodes=function(){var t=this.source;for(var r in t)switch(r){case"p:sp":for(var e=Array.isArray(t[r])?t[r]:[t[r]],a=0;a<e.length;a++){var s=e[a];this.nodes.push(new X(s,this.pptx,this.ctx))}break;case"p:pic":var o=Array.isArray(t[r])?t[r]:[t[r]];for(a=0;a<o.length;a++){var c=o[a],u=c["p:blipFill"]["a:blip"].attrs["r:embed"],f=this.ctx.rels[u].target,h=new q(f,c,this.pptx,this.ctx);this.nodes.push(h)}break;case"p:cxnSp":var g=Array.isArray(t[r])?t[r]:[t[r]];for(a=0;a<g.length;a++)s=g[a],this.nodes.push(new X(s,this.pptx,this.ctx));break;case"p:grpSp":var b=Array.isArray(t[r])?t[r]:[t[r]];for(a=0;a<b.length;a++){var A=b[a];this.nodes.push(new n(A,this.pptx,this.ctx))}}},n}(),rt=1;function U(n){var t="<".charCodeAt(0),r=">".charCodeAt(0),e="-".charCodeAt(0),a="/".charCodeAt(0),s="!".charCodeAt(0),o="'".charCodeAt(0),c='"'.charCodeAt(0),u="?".charCodeAt(0),f=`\r
	>/= `,h=0;return rt=1,It(function g(){for(var b=[];n[h];){if(n.charCodeAt(h)==t){if(n.charCodeAt(h+1)===a)return h=n.indexOf(">",h),b;if(n.charCodeAt(h+1)===s){if(n.charCodeAt(h+2)==e){for(;n.charCodeAt(h)!==r||n.charCodeAt(h-1)!=e||n.charCodeAt(h-2)!=e||h==-1;)h=n.indexOf(">",h+1);h===-1&&(h=n.length)}else for(h+=2;n.charCodeAt(h)!==r;h++);h++;continue}if(n.charCodeAt(h+1)===u){h=n.indexOf(">",h),h++;continue}for(var A=++h;f.indexOf(n[h])===-1;h++);for(var P=n.slice(A,h),x=!1,v={};n.charCodeAt(h)!==r;h++){var p=n.charCodeAt(h);if(p>64&&p<91||p>96&&p<123){for(A=h;f.indexOf(n[h])===-1;h++);for(var i=n.slice(A,h),d=n.charCodeAt(h);d!==o&&d!==c;)h++,d=n.charCodeAt(h);var y=n[h],m=++h;h=n.indexOf(y,m);var w=n.slice(m,h);x||(v={},x=!0),v[i]=w}}var k=[];n.charCodeAt(h-1)!==a&&(h++,k=g()),b.push({children:k,tagName:P,attrs:v})}else{var C=h;(h=n.indexOf("<",h)-1)===-2&&(h=n.length);var S=n.slice(C,h+1);S.length>0&&b.push(S)}h++}return b}())}function It(n){var t={};if(n===void 0)return{};if(n.length===1&&typeof n[0]=="string")return n[0];for(var r in n.forEach(function(e){if(t[e.tagName]||(t[e.tagName]=[]),typeof e=="object"){var a=It(e.children);typeof a=="object"&&(e.attrs&&(a.attrs=e.attrs),a.attrs===void 0?a.attrs={order:rt}:a.attrs.order=rt),rt++,t[e.tagName].push(a)}}),t)t[r].length==1&&(t[r]=t[r][0]);return t}var ne=function(){function n(t,r,e){this.slideType="slide",this.rels={},this.background={type:"none"},this.nodes=[],this.name=t,this.source=r,this.pptx=e}return Object.defineProperty(n.prototype,"index",{get:function(){if(!this.name)return 0;var t=this.name.match(/(\d+)/);return t?parseInt(t[0]):1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"slideMaster",{get:function(){return this.slideLayout&&this.slideLayout.slideMaster},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"theme",{get:function(){return this.slideMaster.theme},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_relsPath",{get:function(){return this.name.replace("slides/slide","slides/_rels/slide")+".rels"},enumerable:!1,configurable:!0}),n.prototype.load=function(){return j(this,void 0,void 0,function(){return E(this,function(t){switch(t.label){case 0:return[4,this._loadRels()];case 1:return t.sent(),this._loadBackground(),[4,this._loadNodes()];case 2:return t.sent(),[2]}})})},n.prototype._loadRels=function(){return j(this,void 0,void 0,function(){var t,r,e,a=this;return E(this,function(s){switch(s.label){case 0:return r=U,[4,this.pptx.getXmlByPath(this._relsPath)];case 1:return t=r.apply(void 0,[s.sent()]),e=l.get(t,["Relationships","Relationship"])||[],Array.isArray(e)||(e=[e]),e.forEach(function(o){switch(l.get(o,["attrs","Type"])){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout":var c=o.attrs.Target.replace("../","ppt/");a.slideLayout=a.pptx.getSlideLayout(c);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image":a.rels[o.attrs.Id]={type:o.attrs.Type.replace("http://schemas.openxmlformats.org/officeDocument/2006/relationships/",""),target:o.attrs.Target.replace("../","ppt/")}}}),[2]}})})},n.prototype._loadBackground=function(){var t=l.get(this.source,["p:sld","p:cSld","p:bg","p:bgPr"]);t&&t["a:solidFill"]&&(this.background=T(t["a:solidFill"],this.theme,this)),t&&t["a:blipFill"]&&(this.background=at(t["a:blipFill"],this.pptx,this))},n.prototype._loadNodes=function(){return j(this,void 0,void 0,function(){var t,r,e,a,s,o,c,u,f,h,g,b,A;return E(this,function(P){for(r in t=l.get(this.source,["p:sld","p:cSld","p:spTree"]))switch(r){case"p:sp":for(e=Array.isArray(t[r])?t[r]:[t[r]],b=0;b<e.length;b++)h=e[b],this.nodes.push(new X(h,this.pptx,this));break;case"p:pic":for(a=Array.isArray(t[r])?t[r]:[t[r]],b=0;b<a.length;b++)s=a[b],o=s["p:blipFill"]["a:blip"].attrs["r:embed"],c=this.rels[o].target,u=new q(c,s,this.pptx,this),this.nodes.push(u);break;case"p:cxnSp":for(f=Array.isArray(t[r])?t[r]:[t[r]],b=0;b<f.length;b++)h=f[b],this.nodes.push(new X(h,this.pptx,this));break;case"p:graphicFrame":break;case"p:grpSp":for(g=Array.isArray(t[r])?t[r]:[t[r]],b=0;b<g.length;b++)A=g[b],this.nodes.push(new ut(A,this.pptx,this))}return[2]})})},n.prototype.getColorThemeName=function(t){return this.slideLayout.getColorThemeName(t)},n.prototype.getNodeInheritAttrsByType=function(t,r){var e=this.slideLayout.getNodeByType(t),a=l.get(e.source,r);return a||this.slideLayout.getNodeInheritAttrsByType(t,r)},n.prototype.getNodeInheritAttrsByIdx=function(t,r){var e=this.slideLayout.getNodeByIdx(t),a=l.get(e.source,r);return a||this.slideLayout.getNodeInheritAttrsByIdx(t,r)},n}(),ae=function(){function n(t,r,e){this.slideType="slideLayout",this.rels={},this.background={type:"none"},this.nodes=[],this.name=t,this.source=r,this.pptx=e}return Object.defineProperty(n.prototype,"_relsPath",{get:function(){return this.name.replace("slideLayouts/slideLayout","slideLayouts/_rels/slideLayout")+".rels"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"theme",{get:function(){return this.slideMaster.theme},enumerable:!1,configurable:!0}),n.prototype.load=function(){return j(this,void 0,void 0,function(){return E(this,function(t){switch(t.label){case 0:return[4,this._loadRels()];case 1:return t.sent(),[4,this._loadBackground()];case 2:return t.sent(),[4,this._loadNodes()];case 3:return t.sent(),[2]}})})},n.prototype._loadRels=function(){return j(this,void 0,void 0,function(){var t,r,e,a=this;return E(this,function(s){switch(s.label){case 0:return r=U,[4,this.pptx.getXmlByPath(this._relsPath)];case 1:return t=r.apply(void 0,[s.sent()]),e=l.get(t,["Relationships","Relationship"])||[],Array.isArray(e)||(e=[e]),e.forEach(function(o){switch(l.get(o,["attrs","Type"])){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster":var c=o.attrs.Target.replace("../","ppt/");a.slideMaster=a.pptx.getSlideMaster(c);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image":a.rels[o.attrs.Id]={type:o.attrs.Type.replace("http://schemas.openxmlformats.org/officeDocument/2006/relationships/",""),target:o.attrs.Target.replace("../","ppt/")}}}),[2]}})})},n.prototype._loadBackground=function(){return j(this,void 0,void 0,function(){var t;return E(this,function(r){return(t=l.get(this.source,["p:sldLayout","p:cSld","p:bg","p:bgPr"]))&&t["a:solidFill"]&&(this.background=T(t["a:solidFill"],this.theme)),t&&t["a:blipFill"]&&(this.background=at(t["a:blipFill"],this.pptx,this)),[2]})})},n.prototype._loadNodes=function(){return j(this,void 0,void 0,function(){var t,r,e,a,s,o,c,u,f,h;return E(this,function(g){for(r in t=l.get(this.source,["p:sldLayout","p:cSld","p:spTree"]))switch(r){case"p:sp":for(e=Array.isArray(t[r])?t[r]:[t[r]],o=0;o<e.length;o++)a=e[o],this.nodes.push(new X(a,this.pptx,this));break;case"p:pic":for(s=Array.isArray(t[r])?t[r]:[t[r]],o=0;o<s.length;o++)c=s[o],u=c["p:blipFill"]["a:blip"].attrs["r:embed"],f=this.rels[u].target,h=new q(f,c,this.pptx,this),this.nodes.push(h)}return[2]})})},n.prototype.getColorThemeName=function(t){return this.slideMaster.getColorThemeName(t)},n.prototype.getNodeByType=function(t){return this.nodes.find(function(r){return r.type===t})},n.prototype.getNodeByIdx=function(t){return this.nodes.find(function(r){return r.idx===t})},n.prototype.getNodeInheritAttrsByType=function(t,r){var e=this.slideMaster.getNodeByType(t);return e&&l.get(e.source,r)},n.prototype.getNodeInheritAttrsByIdx=function(t,r){var e=this.slideMaster.getNodeByIdx(t);return e&&l.get(e.source,r)},n}();function gt(n){var t={},r=l.get(n,"attrs")||{};return Object.keys(r).forEach(function(e){switch(e){case"algn":t.align=r[e];break;case"marL":t.marginLeft=_(parseInt(r[e]));break;case"indent":t.indent=_(parseInt(r[e]));break;case"lvl":t.level=r[e]}}),l.get(n,["a:lnSpc","a:spcPct","attrs","val"])&&(t.lineHeight=parseInt(n["a:lnSpc"]["a:spcPct"].attrs.val)/1e5),t}function mt(n,t,r){var e={},a=l.get(n,"attrs")||{};Object.keys(a).forEach(function(o){switch(o){case"sz":e.size=parseInt(a[o])/100;break;case"b":e.bold=a[o]==="1";break;case"i":e.italic=a[o]==="1";break;case"u":e.underline=a[o];break;case"strike":e.strike=a[o];break;case"order":case"dirty":break;default:e[o]=a[o]}});var s=l.get(n,"a:solidFill");return s&&(e.color=T(s,t,r)),e}var se=function(){function n(t,r,e){this.slideType="slideMaster",this.rels={},this.background={type:"none"},this.textStyles={titleStyle:{},bodyStyle:{},otherStyle:{}},this.defaultTextStyle={},this.nodes=[],this.name=t,this.source=r,this.pptx=e,this.load()}return Object.defineProperty(n.prototype,"_relsPath",{get:function(){return this.name.replace("slideMasters/slideMaster","slideMasters/_rels/slideMaster")+".rels"},enumerable:!1,configurable:!0}),n.prototype.load=function(){return j(this,void 0,void 0,function(){return E(this,function(t){switch(t.label){case 0:return[4,this._parseRels()];case 1:return t.sent(),this._parseColorMap(),this._parseBackground(),this._parseTextStyles(),this._parseDefaultTextStyle(),this._loadNodes(),[2]}})})},n.prototype._parseRels=function(){return j(this,void 0,void 0,function(){var t,r,e,a=this;return E(this,function(s){switch(s.label){case 0:return r=U,[4,this.pptx.getXmlByPath(this._relsPath)];case 1:return t=r.apply(void 0,[s.sent()]),e=l.get(t,["Relationships","Relationship"])||[],Array.isArray(e)||(e=[e]),e.forEach(function(o){switch(l.get(o,["attrs","Type"])){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme":var c=o.attrs.Target.replace("../","ppt/");a.theme=a.pptx.getTheme(c);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image":a.rels[o.attrs.Id]={type:o.attrs.Type.replace("http://schemas.openxmlformats.org/officeDocument/2006/relationships/",""),target:o.attrs.Target.replace("../","ppt/")}}}),[2]}})})},n.prototype._parseColorMap=function(){this.colorMap=l.omit(l.get(this.source,["p:sldMaster","p:clrMap","attrs"])||{},["order"])},n.prototype.getColorThemeName=function(t){return this.colorMap[t]||t},n.prototype._parseBackground=function(){var t=l.get(this.source,["p:sldMaster","p:cSld","p:bg","p:bgPr"]),r=l.get(this.source,["p:sldMaster","p:cSld","p:bg","p:bgRef"]);t&&t["a:solidFill"]?this.background=T(t["a:solidFill"],this.theme,this):t&&t["a:blipFill"]?this.background=at(t["a:blipFill"],this.pptx,this):r&&(this.background=T(r,this.theme,this))},n.prototype._parseDefaultTextStyle=function(){var t=this,r=this.pptx.defaultTextStyleSource;Object.keys(r).forEach(function(e){if(e.startsWith("a:")&&e.endsWith("pPr")){var a=e.substr(2,e.length-5),s=l.get(r[e],["a:defRPr"]);t.defaultTextStyle[a]={props:gt(r[e]),defRPr:mt(s,t.theme,t)}}})},n.prototype._parseTextStyles=function(){var t=this,r=l.get(this.source,["p:sldMaster","p:txStyles"]);["titleStyle","bodyStyle","otherStyle"].forEach(function(e){var a=t.textStyles[e],s=l.get(r,"p:".concat(e))||{};Object.keys(s).forEach(function(o){if(o.startsWith("a:")&&o.endsWith("pPr")){var c=o.substr(2,o.length-5);a[c]={},a[c].props=gt(s[o]);var u=l.get(s[o],["a:defRPr"]);a[c].defRPr=mt(u,t.theme,t)}})})},n.prototype._loadNodes=function(){return j(this,void 0,void 0,function(){var t,r,e,a,s,o,c,u,f,h;return E(this,function(g){for(r in t=l.get(this.source,["p:sldMaster","p:cSld","p:spTree"]))switch(r){case"p:sp":for(e=Array.isArray(t[r])?t[r]:[t[r]],o=0;o<e.length;o++)a=e[o],this.nodes.push(new X(a,this.pptx,this));break;case"p:pic":for(s=Array.isArray(t[r])?t[r]:[t[r]],o=0;o<s.length;o++)c=s[o],u=c["p:blipFill"]["a:blip"].attrs["r:embed"],f=this.rels[u].target,h=new q(f,c,this.pptx,this),this.nodes.push(h)}return[2]})})},n.prototype.getNodeByType=function(t){return this.nodes.find(function(r){return r.type===t})},n.prototype.getNodeByIdx=function(t){return this.nodes.find(function(r){return r.idx===t})},n.prototype.getNodeInheritAttrsByType=function(t,r){},n.prototype.getNodeInheritAttrsByIdx=function(t,r){},n}(),oe=function(){function n(t,r,e){this.clrScheme={},this.borderScheme=[],this.name=t,this.source=r,this.pptx=e,this._parseClrScheme(),this._parseLineStyleLst()}return n.prototype._parseClrScheme=function(){var t=l.get(this.source,["a:theme","a:themeElements","a:clrScheme"]);for(var r in t)if(r.startsWith("a:")){var e=r.substring(2),a=l.get(t[r],["a:sysClr","attrs","lastClr"])||l.get(t[r],["a:srgbClr","attrs","val"]);this.clrScheme[e]="#"+a}},n.prototype._parseLineStyleLst=function(){var t=this,r=l.get(this.source,["a:theme","a:themeElements","a:fmtScheme","a:lnStyleLst","a:ln"]);this.borderScheme=r.map(function(e){var a={color:{}};return l.get(e,["attrs","w"])&&(a.width=_(parseInt(l.get(e,["attrs","w"])))),l.get(e,["attrs","algn"])&&(a.algn=l.get(e,["attrs","algn"])),l.get(e,["attrs","cap"])&&(a.cap=l.get(e,["attrs","cap"])),l.get(e,["attrs","cmpd"])&&(a.cmpd=l.get(e,["attrs","cmpd"])),l.get(e,["a:miter","attrs","lim"])&&(a.miterLim=_(parseInt(l.get(e,["a:miter","attrs","lim"])))),l.get(e,["a:prstDash","attrs","val"])&&(a.type=l.get(e,["a:prstDash","attrs","val"])),l.get(e,["a:solidFill"])&&(a.color=T(l.get(e,["a:solidFill"]),t)),a})},n.prototype.getColor=function(t){if(t!=="phClr")return this.clrScheme[t]||this.defaultColor},n.prototype.getLineStyle=function(t){return this.borderScheme[t-1]},n}(),ie=function(){function n(){this.slides=[],this.slideLayouts=[],this.slideMaster=[],this.themes=[],this.medias={}}return n.prototype.load=function(t){return j(this,void 0,void 0,function(){var r,e;return E(this,function(a){switch(a.label){case 0:return r=new Ft,e=this,[4,r.loadAsync(t)];case 1:return e._zipContents=a.sent(),[4,this._loadThumbnail()];case 2:return a.sent(),[4,this._loadMedia()];case 3:return a.sent(),[4,this._loadPresentation()];case 4:return a.sent(),[4,this._loadContentTypes()];case 5:return a.sent(),[2]}})})},n.prototype._loadThumbnail=function(){return j(this,void 0,void 0,function(){var t,r;return E(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),this._zipContents.files["docProps/thumbnail.jpeg"]?[4,this._zipContents.files["docProps/thumbnail.jpeg"].async("base64")]:[3,2];case 1:t=e.sent(),this.thumbnail="data:image/jpeg;base64,"+t,e.label=2;case 2:return[3,4];case 3:return r=e.sent(),console.log("获取PPTX缩略图失败",r),[3,4];case 4:return[2]}})})},n.prototype._loadPresentation=function(){return j(this,void 0,void 0,function(){var t,r,e,a;return E(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,this._zipContents.files["ppt/presentation.xml"].async("text")];case 1:return t=s.sent(),r=U(t),e=r["p:presentation"]["p:sldSz"].attrs,this.width=_(parseInt(e.cx)),this.height=_(parseInt(e.cy)),this.defaultTextStyleSource=l.get(r,["p:presentation","p:defaultTextStyle"]),[3,3];case 2:return a=s.sent(),console.log("获取PPTX尺寸失败",a),[3,3];case 3:return[2]}})})},n.prototype._loadContentTypes=function(){return j(this,void 0,void 0,function(){var t,r,e,a,s,o,c,u,f,h,g,b,A,P,x,v,p,i,d,y;return E(this,function(m){switch(m.label){case 0:return m.trys.push([0,20,,21]),r=U,[4,this._zipContents.files["[Content_Types].xml"].async("text")];case 1:if(t=r.apply(void 0,[m.sent()]),e=t.Types.Override,!(a=e.filter(function(w){return w.attrs.ContentType==="application/vnd.openxmlformats-officedocument.theme+xml"})))return[3,5];s=0,o=a,m.label=2;case 2:return s<o.length?(c=o[s],v=c.attrs.PartName.substr(1),u=U,[4,this._zipContents.files[v].async("text")]):[3,5];case 3:p=u.apply(void 0,[m.sent()]),this.themes.push(new oe(v,p,this)),m.label=4;case 4:return s++,[3,2];case 5:f=e.filter(function(w){return w.attrs.ContentType==="application/vnd.openxmlformats-officedocument.presentationml.slideMaster+xml"}),x=0,m.label=6;case 6:return x<f.length?(v=f[x].attrs.PartName.substr(1),h=U,[4,this._zipContents.files[v].async("text")]):[3,9];case 7:p=h.apply(void 0,[m.sent()]),this.slideMaster.push(new se(v,p,this)),m.label=8;case 8:return x++,[3,6];case 9:g=e.filter(function(w){return w.attrs.ContentType==="application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml"}),x=0,m.label=10;case 10:return x<g.length?(v=g[x].attrs.PartName.substr(1),b=U,[4,this._zipContents.files[v].async("text")]):[3,14];case 11:return p=b.apply(void 0,[m.sent()]),[4,(A=new ae(v,p,this)).load()];case 12:m.sent(),this.slideLayouts.push(A),m.label=13;case 13:return x++,[3,10];case 14:P=e.filter(function(w){return w.attrs.ContentType==="application/vnd.openxmlformats-officedocument.presentationml.slide+xml"}),x=0,m.label=15;case 15:return x<P.length?(v=P[x].attrs.PartName.substr(1),i=U,[4,this._zipContents.files[v].async("text")]):[3,19];case 16:return p=i.apply(void 0,[m.sent()]),[4,(d=new ne(v,p,this)).load()];case 17:m.sent(),this.slides.push(d),m.label=18;case 18:return x++,[3,15];case 19:return[3,21];case 20:return y=m.sent(),console.log("Content Type获取失败",y),[3,21];case 21:return[2]}})})},n.prototype._loadMedia=function(){return j(this,void 0,void 0,function(){var t,r,e,a,s,o,c=this;return E(this,function(u){switch(u.label){case 0:t=Object.keys(this._zipContents.files).filter(function(h){return h.startsWith("ppt/media/image")}).map(function(h){return c._zipContents.files[h]}),r=0,e=t,u.label=1;case 1:return r<e.length?(a=e[r],s=function(h){var g;switch(h){case"jpg":case"jpeg":g="image/jpeg";break;case"png":g="image/png";break;case"gif":g="image/gif";break;case"emf":g="image/x-emf";break;case"wmf":g="image/x-wmf";break;default:g="image/*"}return g}((f=a.name).substr(2+(~-f.lastIndexOf(".")>>>0))),[4,a.async("base64")]):[3,4];case 2:o=u.sent(),this.medias[a.name]="data:".concat(s,";base64,").concat(o),u.label=3;case 3:return r++,[3,1];case 4:return[2]}var f})})},n.prototype.getXmlByPath=function(t){return j(this,void 0,void 0,function(){return E(this,function(r){switch(r.label){case 0:if(!this._zipContents.files[t])throw new Error("文件不存在");return[4,this._zipContents.files[t].async("text")];case 1:return[2,r.sent()]}})})},n.prototype.getSlideLayout=function(t){return this.slideLayouts.find(function(r){return r.name===t})},n.prototype.getSlideMaster=function(t){return this.slideMaster.find(function(r){return r.name===t})},n.prototype.getTheme=function(t){return this.themes.find(function(r){return r.name===t})},n.prototype.getMedia=function(t){return this.medias[t]},n}();function jt(n){var t,r,e,a,s=n.extend,o=n.offset,c=n.clip,u=n.base64,f=document.createElement("div");f.style.setProperty("position","absolute"),f.style.setProperty("left",o.x+"px"),f.style.setProperty("top",o.y+"px"),f.style.setProperty("width",s.w+"px"),f.style.setProperty("height",s.h+"px"),f.style.setProperty("overflow","hidden"),c?(t=s.w/(1-(c.l===void 0?0:c.l)-(c.r===void 0?0:c.r)),r=s.h/(1-(c.t===void 0?0:c.t)-(c.b===void 0?0:c.b)),e=-1*t*(c.l===void 0?0:c.l),a=-1*r*(c.t===void 0?0:c.t)):(t=s.w,r=s.h,e=0);var h=document.createElement("img");return h.src=u,h.width=t,h.height=r,h.style.setProperty("position","absolute"),h.style.setProperty("left",e+"px"),h.style.setProperty("top",a+"px"),f.append(h),f}function ce(n,t,r){var e,a=n.props,s=n.text,o=B(B({},t),a),c=document.createElement("span");c.textContent=s,o.size&&(!((e=r==null?void 0:r.normAutofit)===null||e===void 0)&&e.fontScale?c.style.fontSize=o.size*r.normAutofit.fontScale+"px":c.style.fontSize=o.size+"px");var u=R(o.color);return u&&(c.style.color=u),o.bold&&(c.style.fontWeight="bold"),o.italic&&(c.style.fontStyle="italic"),o.underline&&(c.style.textDecoration="underline"),o.background&&(c.style.backgroundColor=R(o.background)),c}function le(n,t,r){var e=document.createElement("span"),a=n.firstElementChild;switch(e.style.fontSize=a.style.fontSize,e.style.color=a.style.color,e.style.fontWeight=a.style.fontWeight,e.style.fontStyle=a.style.fontStyle,e.style.marginRight="10px",t.buAutoNum){case"arabicPeriod":default:e.textContent=r+".";break;case"circleNumDbPlain":e.textContent=["①","②","③","④","⑤","⑥","⑦","⑧","⑨","⑩","⑪","⑫","⑬","⑭","⑮","⑯","⑰","⑱","⑲","⑳"][r-1]||r+"";break;case"romanUcPeriod":e.textContent=function(s){var o=[{value:1e3,numeral:"M"},{value:900,numeral:"CM"},{value:500,numeral:"D"},{value:400,numeral:"CD"},{value:100,numeral:"C"},{value:90,numeral:"XC"},{value:50,numeral:"L"},{value:40,numeral:"XL"},{value:10,numeral:"X"},{value:9,numeral:"IX"},{value:5,numeral:"V"},{value:4,numeral:"IV"},{value:1,numeral:"I"}];if(typeof s!="number"||s<1||s>3999)throw new Error("Input must be a number between 1 and 3999.");for(var c="",u=0;u<o.length;u++)for(;s>=o[u].value;)c+=o[u].numeral,s-=o[u].value;return c}(r)+".";break;case"alphaUcPeriod":e.textContent=it(r)+".";break;case"alphaLcPeriod":e.textContent=it(r).toLowerCase()+".";break;case"alphaLcParenR":e.textContent=it(r).toLowerCase()+")";break;case"ea1JpnChsDbPeriod":e.textContent=function(s){var o=["〇","一","二","三","四","五","六","七","八","九"];if(!Number.isInteger(s)||s<0)return"";for(var c="",u=s.toString(),f=0;f<u.length;f++)c+=o[parseInt(u[f],10)];return c}(r)+"."}n.prepend(e)}function bt(n,t,r){var e,a,s,o;t===void 0&&(t=0),r===void 0&&(r={});var c=n.inheritProps,u=n.inheritRProps,f=n.props,h=n.rows,g=B(B({},c),f),b=document.createElement("div"),A=r.isFirst?0:g.spaceBefore||0,P=r.isLast?0:g.spaceAfter||0;b.style.margin="0px",b.style.padding="".concat(A,"px 0px ").concat(P,"px 0px");var x=document.createElement("p");x.style.margin="0px",x.style.padding="0px",x.style.wordBreak="break-word",x.style.textAlign=g.align&&{ctr:"center",l:"left",r:"right",dist:"justify"}[g.align]||"center",g.align==="dist"&&(x.style.textAlignLast="justify");var v=g.hasOwnProperty("lineHeight")?1.2*g.lineHeight:1.2;if(!((a=(e=r.bodyProps)===null||e===void 0?void 0:e.normAutofit)===null||a===void 0)&&a.lnSpcReduction&&(v*=1-((o=(s=r.bodyProps)===null||s===void 0?void 0:s.normAutofit)===null||o===void 0?void 0:o.lnSpcReduction)),x.style.lineHeight=v+"",h.length){for(var p=0,i=h;p<i.length;p++){var d=i[p];x.appendChild(ce(d,u,r.bodyProps))}g.buAutoNum?le(x,g,t):g.buChar&&function(m,w){var k=document.createElement("span"),C=m.firstElementChild;k.style.color=C.style.color,k.style.fontSize=C.style.fontSize,k.textContent={n:"■",l:"●",u:"◆",p:"□",ü:"✔",Ø:"➢","•":"•"}[w.buChar]||"■",k.style.marginRight="10px",m.prepend(k)}(x,g),x.style.paddingLeft=(g.marginLeft||0)+(g.indent||0)+"px"}else{var y=document.createElement("span");y.innerHTML="&nbsp;",y.style.fontSize=u.size+"px",x.appendChild(y)}return b.appendChild(x),b}var M="http://www.w3.org/2000/svg";function O(n,t){var r=0;switch(n){case"sm":r=1*t;break;case"med":r=1.5*t;break;case"lg":r=2.5*t}return Math.max(r,2)}function vt(n,t,r,e){e===void 0&&(e=!1);var a=n.border,s=a===void 0?{}:a,o=n.uuid,c=s.headEnd,u=s.width,f=s.color,h=s.tailEnd,g=e?c:h,b=g.len,A=b===void 0?"med":b,P=g.w,x=P===void 0?"med":P,v=O(A,u),p=O(x,u),i=document.createElementNS(M,"defs"),d=document.createElementNS(M,"marker"),y="marker-".concat(o,"-").concat(e?"start":"end");d.setAttribute("id",y),d.setAttribute("viewBox","0 0 ".concat(2*v," ").concat(2*p)),d.setAttribute("refX",v+"px"),d.setAttribute("refY",p+"px"),d.setAttribute("markerWidth",2*v+"px"),d.setAttribute("markerHeight",2*p+"px"),d.setAttribute("orient","auto"),d.setAttribute("markerUnits","userSpaceOnUse");var m=document.createElementNS(M,"ellipse");m.setAttribute("cx",v+"px"),m.setAttribute("cy",p+"px"),m.setAttribute("rx",v+"px"),m.setAttribute("ry",p+"px"),m.setAttribute("fill",R(f)||"transparent"),d.appendChild(m),i.appendChild(d),t.appendChild(i),r.setAttribute(e?"marker-start":"marker-end","url(#".concat(y,")"))}function xt(n,t,r,e){e===void 0&&(e=!1);var a=n.border,s=a===void 0?{}:a,o=n.uuid,c=s.headEnd,u=s.width,f=s.color,h=s.tailEnd,g=e?c:h,b=g.len,A=b===void 0?"med":b,P=g.w,x=P===void 0?"med":P,v=O(A,u),p=O(x,u),i=document.createElementNS(M,"defs"),d=document.createElementNS(M,"marker"),y="marker-".concat(o,"-").concat(e?"start":"end");d.setAttribute("id",y),d.setAttribute("viewBox","0 0 ".concat(2*v," ").concat(2*p)),d.setAttribute("refX",(e?.9*v:1.1*v)+"px"),d.setAttribute("refY",p+"px"),d.setAttribute("markerWidth",2*v+"px"),d.setAttribute("markerHeight",2*p+"px"),d.setAttribute("orient","auto"),d.setAttribute("markerUnits","userSpaceOnUse");var m=document.createElementNS(M,"path"),w=e?["M ".concat(2*v,",0"),"L 0,".concat(p),"L ".concat(2*v,",").concat(2*p),"Z"].join(" "):["M 0,0","L ".concat(2*v,",").concat(p),"L 0,".concat(2*p),"Z"].join(" ");m.setAttribute("d",w),m.setAttribute("fill",R(f)||"transparent"),d.appendChild(m),i.appendChild(d),t.appendChild(i),r.setAttribute(e?"marker-start":"marker-end","url(#".concat(y,")"))}function wt(n,t,r,e){e===void 0&&(e=!1);var a=n.border,s=a===void 0?{}:a,o=n.uuid,c=s.headEnd,u=s.width,f=s.color,h=s.tailEnd,g=e?c:h,b=g.len,A=b===void 0?"med":b,P=g.w,x=P===void 0?"med":P,v=O(A,u),p=O(x,u),i=document.createElementNS(M,"defs"),d=document.createElementNS(M,"marker"),y="marker-".concat(o,"-").concat(e?"start":"end");d.setAttribute("id",y),d.setAttribute("viewBox","0 0 ".concat(2*v," ").concat(2*p)),d.setAttribute("refX",v+"px"),d.setAttribute("refY",p+"px"),d.setAttribute("markerWidth",2*v+"px"),d.setAttribute("markerHeight",2*p+"px"),d.setAttribute("orient","auto"),d.setAttribute("markerUnits","userSpaceOnUse");var m=document.createElementNS(M,"path"),w=["M 0,".concat(p),"L ".concat(v,",0"),"L ".concat(2*v,",").concat(p),"L ".concat(v,",").concat(2*p),"Z"].join(" ");m.setAttribute("d",w),m.setAttribute("fill",R(f)||"transparent"),d.appendChild(m),i.appendChild(d),t.appendChild(i),r.setAttribute(e?"marker-start":"marker-end","url(#".concat(y,")"))}function Pt(n,t,r,e){e===void 0&&(e=!1);var a=n.border,s=a===void 0?{}:a,o=n.uuid,c=s.headEnd,u=s.width,f=s.color,h=s.tailEnd,g=e?c:h,b=g.len,A=b===void 0?"med":b,P=g.w,x=P===void 0?"med":P,v=O(A,u),p=O(x,u),i=document.createElementNS(M,"defs"),d=document.createElementNS(M,"marker"),y="marker-".concat(o,"-").concat(e?"start":"end");d.setAttribute("id",y),d.setAttribute("viewBox","0 0 ".concat(2*v+2*u," ").concat(2*p+2*u));var m=e?x==="lg"?2*u:3*u:x==="lg"?2*v:2*v-u;d.setAttribute("refX",m+"px"),d.setAttribute("refY",p+u+"px"),d.setAttribute("markerWidth",2*v+"px"),d.setAttribute("markerHeight",2*p+"px"),d.setAttribute("orient","auto"),d.setAttribute("markerUnits","userSpaceOnUse");var w=document.createElementNS(M,"path"),k=e?["M ".concat(2*v+u,", ").concat(u),"L ".concat(u,",").concat(p+u),"L ".concat(2*v+u,",").concat(2*p+u)].join(" "):["M ".concat(u,", ").concat(u),"L ".concat(2*v+u,",").concat(p+u),"L ".concat(u,",").concat(2*p+u)].join(" ");w.setAttribute("d",k),w.setAttribute("stroke-width",u+"px"),w.setAttribute("stroke",R(f)||"transparent"),w.setAttribute("fill","transparent"),w.setAttribute("stroke-linecap","round"),w.setAttribute("stroke-linejoin","miter"),w.style.overflow="visible",d.appendChild(w),i.appendChild(d),t.appendChild(i),r.setAttribute(e?"marker-start":"marker-end","url(#".concat(y,")"))}function At(n,t,r,e){e===void 0&&(e=!1);var a=n.border,s=a===void 0?{}:a,o=n.uuid,c=s.headEnd,u=s.width,f=s.color,h=s.tailEnd,g=e?c:h,b=g.len,A=b===void 0?"med":b,P=g.w,x=P===void 0?"med":P,v=O(A,u),p=O(x,u),i=document.createElementNS(M,"defs"),d=document.createElementNS(M,"marker"),y="marker-".concat(o,"-").concat(e?"start":"end");d.setAttribute("id",y),d.setAttribute("viewBox","0 0 ".concat(2*v," ").concat(2*p));var m=e?x==="sm"?1.5*u:2*u:x==="sm"?2*v-1.5*u:2*v-2*u;d.setAttribute("refX",m+"px"),d.setAttribute("refY",p+"px"),d.setAttribute("markerWidth",2*v+"px"),d.setAttribute("markerHeight",2*p+"px"),d.setAttribute("orient","auto"),d.setAttribute("markerUnits","userSpaceOnUse");var w=document.createElementNS(M,"path"),k=e?["M 0, ".concat(p),"L ".concat(2*v,",0"),"L ".concat(v,",").concat(p),"L ".concat(2*v,",").concat(2*p),"Z"].join(" "):["M 0,0","L ".concat(2*v,",").concat(p),"L 0,".concat(2*p),"L ".concat(v,",").concat(p),"Z"].join(" ");w.setAttribute("d",k),w.setAttribute("fill",R(f)||"transparent"),w.style.overflow="visible",d.appendChild(w),i.appendChild(d),t.appendChild(i),r.setAttribute(e?"marker-start":"marker-end","url(#".concat(y,")"))}function et(n,t,r){var e=n.border,a=e===void 0?{}:e;n.extend;var s=a.headEnd,o=a.tailEnd;if(s&&s.type!=="none")switch(s.type){case"triangle":xt(n,t,r,!0);break;case"oval":vt(n,t,r,!0);break;case"diamond":wt(n,t,r,!0);break;case"arrow":Pt(n,t,r,!0);break;case"stealth":At(n,t,r,!0)}if(o&&o.type!=="none")switch(o.type){case"triangle":xt(n,t,r,!1);break;case"oval":vt(n,t,r,!1);break;case"diamond":wt(n,t,r,!1);break;case"arrow":Pt(n,t,r,!1);break;case"stealth":At(n,t,r,!1)}}var L="http://www.w3.org/2000/svg";function z(n){var t=n.extend;return .16667*Math.min(t.w,t.h)}function N(n,t,r){r===void 0&&(r=0);var e=t.extend,a=t.prstGeom,s=((a==null?void 0:a.gd)||[]).find(function(o){return o.name===n});return s?Math.min(e.w,e.h)*s.fmla:r}function kt(n,t,r){r===void 0&&(r=0);var e=t.extend,a=t.prstGeom,s=((a==null?void 0:a.gd)||[]).find(function(o){return o.name===n});return s?Math.max(e.w,e.h)*s.fmla:r}function St(n){var t=n.extend,r=document.createElementNS(L,"rect");return r.setAttribute("x","0"),r.setAttribute("y","0"),r.setAttribute("width",t.w+"px"),r.setAttribute("height",t.h+"px"),r}function Et(n){var t=n.extend,r=n.offset,e=n.border,a=n.background,s=n.rotate,o=n.flipH,c=n.flipV,u=document.createElement("div"),f=r.x,h=r.y;u.className="shape-wrapper shape-".concat(n.shape),u.style.setProperty("position","absolute"),u.style.setProperty("width",(t.w||1)+"px"),u.style.setProperty("height",(t.h||1)+"px"),u.style.setProperty("left",f+"px"),u.style.setProperty("top",h+"px");var g,b=document.createElementNS(L,"svg");b.style.setProperty("position","absolute"),b.setAttribute("width","100%"),b.setAttribute("height","100%"),b.style.setProperty("left","0"),b.style.setProperty("top","0"),b.style.overflow="visible";var A={left:0,top:0,right:0,bottom:0,w:t.w,h:t.h},P=!0;switch(n.shape){case"flowChartProcess":case"rect":g=St(n);break;case"snip1Rect":g=function(p){var i=p.extend,d=document.createElementNS(L,"polygon"),y=N("adj",p,z(p)),m=["0,0","".concat(i.w-y,",0"),"".concat(i.w,",").concat(y),"".concat(i.w,",").concat(i.h),"0,".concat(i.h)].join(" ");return d.setAttribute("points",m),d}(n);break;case"snip2SameRect":g=function(p){var i=p.extend,d=document.createElementNS(L,"polygon"),y=N("adj1",p,z(p)),m=N("adj2",p,0),w=[[y,0],[i.w-y,0],[i.w,y],[i.w,i.h-m],[i.w-m,i.h],[m,i.h],[0,i.h-m],[0,y]].map(function(k){return"".concat(k[0],",").concat(k[1])}).join(" ");return d.setAttribute("points",w),d}(n);break;case"snip2DiagRect":g=function(p){var i=p.extend,d=document.createElementNS(L,"polygon"),y=N("adj1",p,0),m=N("adj2",p,z(p)),w=[[y,0],[i.w-m,0],[i.w,m],[i.w,i.h-y],[i.w-y,i.h],[m,i.h],[0,i.h-m],[0,y]].map(function(k){return"".concat(k[0],",").concat(k[1])}).join(" ");return d.setAttribute("points",w),d}(n);break;case"snipRoundRect":g=function(p){var i=p.extend,d=document.createElementNS(L,"path"),y=N("adj1",p,z(p)),m=N("adj2",p,z(p)),w=["M ".concat(y,",0"),"L ".concat(i.w-m,",0"),"L ".concat(i.w,",").concat(m),"L ".concat(i.w,",").concat(i.h),"L 0,".concat(i.h),"L 0,".concat(y),"Q 0,0 ".concat(y,",0"),"Z"].join(" ");return d.setAttribute("d",w),d}(n);break;case"roundRect":g=function(p){var i=St(p),d=N("adj",p,z(p));return i.setAttribute("rx",d+"px"),i.setAttribute("ry",d+"px"),i}(n);break;case"round1Rect":g=function(p){var i=p.extend,d=document.createElementNS(L,"path"),y=N("adj",p,z(p)),m=["M 0,0","L ".concat(i.w-y,",0"),"Q ".concat(i.w,",0 ").concat(i.w,",").concat(y),"L ".concat(i.w,",").concat(i.h),"L 0,".concat(i.h),"Z"].join(" ");return d.setAttribute("d",m),d}(n);break;case"round2SameRect":g=function(p){var i=p.extend,d=document.createElementNS(L,"path"),y=N("adj1",p,z(p)),m=N("adj2",p,0),w=["M ".concat(y,",0"),"L ".concat(i.w-y,",0"),"Q ".concat(i.w,",0 ").concat(i.w,",").concat(y),"L ".concat(i.w,",").concat(i.h-m),"Q ".concat(i.w,",").concat(i.h," ").concat(i.w-m,",").concat(i.h),"L ".concat(m,",").concat(i.h),"Q 0,".concat(i.h," 0,").concat(i.h-m),"L 0,".concat(y),"Q 0,0 ".concat(y,",0"),"Z"].join(" ");return d.setAttribute("d",w),d}(n);break;case"round2DiagRect":g=function(p){var i=p.extend,d=document.createElementNS(L,"path"),y=N("adj1",p,z(p)),m=N("adj2",p,0),w=["M ".concat(y,",0"),"L ".concat(i.w-m,",0"),"Q ".concat(i.w,",0 ").concat(i.w,",").concat(m),"L ".concat(i.w,",").concat(i.h-y),"Q ".concat(i.w,",").concat(i.h," ").concat(i.w-y,",").concat(i.h),"L ".concat(m,",").concat(i.h),"Q 0,".concat(i.h," 0,").concat(i.h-m),"L 0,".concat(y),"Q 0,0 ".concat(y,",0"),"Z"].join(" ");return d.setAttribute("d",w),d}(n);break;case"triangle":g=function(p){var i=p.extend,d=document.createElementNS(L,"polygon"),y=["".concat(i.w/2,",0"),"0,".concat(i.h),"".concat(i.w,",").concat(i.h)].join(" ");return d.setAttribute("points",y),d}(n);break;case"rtTriangle":g=function(p){var i=p.extend,d=document.createElementNS(L,"polygon"),y=["0,".concat(i.h),"0,0","".concat(i.w,",").concat(i.h)].join(" ");return d.setAttribute("points",y),d}(n);break;case"ellipse":g=function(p){var i=p.extend,d=document.createElementNS(L,"ellipse"),y=i.w/2,m=i.h/2,w=y,k=m;return d.setAttribute("cx",y+"px"),d.setAttribute("cy",m+"px"),d.setAttribute("rx",w+"px"),d.setAttribute("ry",k+"px"),d}(n);break;case"line":g=function(p){var i=p.extend,d=document.createElementNS(L,"path"),y=["M 0,0","L ".concat(i.w,",").concat(i.h)].join(" ");return d.setAttribute("d",y),d}(n),et(n,b,g),P=!1;break;case"straightConnector1":g=function(p){var i=p.extend,d=document.createElementNS(L,"path"),y=["M 0,0","L ".concat(i.w,",").concat(i.h)].join(" ");return d.setAttribute("d",y),d}(n),et(n,b,g),P=!1;break;case"bentConnector3":g=function(p){var i=p.extend,d=document.createElementNS(L,"path"),y=kt("adj1",p,.5*Math.max(i.w,i.h)),m=["M 0,0","L ".concat(y,",0"),"L ".concat(y,",").concat(i.h),"L ".concat(i.w,",").concat(i.h)].join(" ");return d.setAttribute("d",m),d}(n),et(n,b,g),P=!1;break;case"curvedConnector3":g=function(p){var i=p.extend,d=document.createElementNS(L,"path"),y=kt("adj1",p,.5*Math.max(i.w,i.h)),m=["M0,0","Q".concat(y,",0 ").concat(y,",").concat(i.h/2),"T".concat(i.w,",").concat(i.h)].join(" ");return d.setAttribute("d",m),d}(n),et(n,b,g),P=!1;break;case"parallelogram":g=function(p){var i=p.extend,d=document.createElementNS(L,"path"),y=N("adj",p,.5*Math.min(i.w,i.h)),m=["M".concat(y,",0"),"L".concat(i.w,",0"),"L".concat(i.w-y,",").concat(i.h),"L0,".concat(i.h),"Z"].join(" ");return d.setAttribute("d",m),d}(n),A=function(p){var i=p.extend,d=N("adj",p,.5*Math.min(i.w,i.h)),y=.84*(i.w-d),m=.08*i.h+d/i.w*i.h*.42;return{top:m,bottom:m,left:(i.w-y)/2,right:(i.w-y)/2,w:y,h:i.h-2*m}}(n);break;case"trapezoid":g=function(p){var i=p.extend,d=document.createElementNS(L,"path"),y=N("adj",p,.25*Math.min(i.w,i.h)),m=["M".concat(y,",0"),"L".concat(i.w-y,",0"),"L".concat(i.w,",").concat(i.h),"L0,".concat(i.h),"Z"].join(" ");return d.setAttribute("d",m),d}(n),A=function(p){var i=p.extend,d=N("adj",p,.5*Math.min(i.w,i.h)),y=d/i.w*.66*i.h,m=.66*d;return{top:y,bottom:0,left:m,right:m,w:i.w-2*m,h:i.h-y}}(n);break;case"diamond":g=function(p){var i=p.extend,d=document.createElementNS(L,"path"),y=["M".concat(i.w/2,",0"),"L".concat(i.w,",").concat(i.h/2),"L".concat(i.w/2,",").concat(i.h),"L0,".concat(i.h/2),"Z"].join(" ");return d.setAttribute("d",y),d}(n),A=function(p){var i=p.extend,d=.25*i.h,y=.25*i.w;return{top:d,bottom:d,left:y,right:y,w:.5*i.w,h:.5*i.h}}(n)}g&&(P?(a==null?void 0:a.type)==="blipFill"?function(p,i,d){var y=p.background,m=y===void 0?{}:y,w=p.extend,k=m.base64,C=m.alpha,S=m.fillRect,Q=S===void 0?{}:S,D=Q.b,Z=D===void 0?0:D,K=Q.t,G=K===void 0?0:K,J=Q.l,H=J===void 0?0:J,Y=Q.r,$=Y===void 0?0:Y,W=document.createElementNS(M,"defs"),F=document.createElementNS(M,"pattern");F.setAttribute("id","background_"+p.uuid),F.setAttribute("patternUnits","userSpaceOnUse"),F.setAttribute("width",w.w+""),F.setAttribute("height",w.h+"");var V=document.createElementNS(M,"image");V.setAttribute("href",k),V.setAttribute("preserveAspectRatio","none");var Tt=w.w*H,Rt=w.h*G,Ot=w.w*(1-H-$),Dt=w.h*(1-G-Z);V.setAttribute("width",Ot+""),V.setAttribute("height",Dt+""),V.setAttribute("x",Tt+""),V.setAttribute("y",Rt+""),typeof C=="number"&&V.setAttribute("opacity",C+""),F.appendChild(V),W.appendChild(F),i.appendChild(W),d.setAttribute("fill","url(#background_".concat(p.uuid,")"))}(n,b,g):g.setAttribute("fill",R(a)||"transparent"):g.setAttribute("fill","transparent"),e.width?(g.setAttribute("stroke-width",e.width+"px"),g.setAttribute("stroke",R(e.color)||"transparent")):g.setAttribute("stroke-width","0"),g.setAttribute("stroke-dasharray",function(p){return p&&p.type!=="solid"?({sysDot:[1,1],sysDash:[3,1],dash:[4,3],dashDot:[4,3,1,3],lgDash:[8,3],lgDashDot:[8,3,1,3],lgDashDotDot:[8,3,1,3,1,3]}[p.type]||[]).map(function(i){return i*p.width}).join(","):""}(e)),g.setAttribute("stroke-linecap",e.cap&&{sq:"square",rnd:"round",flat:"butt"}[e.cap]||"square"),g.setAttribute("stroke-linejoin",e.lineJoin||"round"),e.lineJoin==="miter"&&g.setAttribute("stroke-miterlimit",e.miterLim+""),b.appendChild(g));var x=[];o&&x.push("scaleX(-1)"),c&&x.push("scaleY(-1)"),b.style.setProperty("transform",x.join(" ")),u.appendChild(b);var v=function(p,i,d){var y;d===void 0&&(d=!1);var m=p.inheritProps,w=p.props,k=p.paragraphs;if(!k||k.length===0)return null;var C=B(B({},m),w),S=document.createElement("div");switch(S.className="text-wrapper",S.style.boxSizing="border-box",S.style.position="absolute",S.style.left=i.left+"px",C.vert==="eaVert"?(S.style.writingMode="vertical-rl",S.style.height=i.h+"px"):S.style.width=i.w+"px",C.anchor){case"b":S.style.bottom=i.bottom+"px";break;case"t":S.style.top=i.top+"px";break;case"ctr":S.style.top=i.top+i.h/2+"px",S.style.transform="translateY(-50%)";break;default:d?S.style.top=i.top+"px":(S.style.top=i.top+i.h/2+"px",S.style.transform="translateY(-50%)")}var Q=[C.hasOwnProperty("tIns")?C.tIns+"px":"4px",C.hasOwnProperty("rIns")?C.rIns+"px":"7px",C.hasOwnProperty("bIns")?C.bIns+"px":"4px",C.hasOwnProperty("lIns")?C.lIns+"px":"7px"];S.style.padding=Q.join(" ");for(var D={},Z=0,K=function(H){var Y=B(B({},H.inheritProps),H.props),$=void 0;if(Y.buAutoNum){var W=Y.level?+Y.level:0;D[W]||(D[W]=0),!((y=H.rows)===null||y===void 0)&&y.length&&D[W]++,Object.keys(D).forEach(function(F){+F>W&&(D[F]=0)}),$=bt(H,D[W],{isFirst:Z===0,isLast:k.length-1===Z,bodyProps:C})}else $=bt(H,0,{isFirst:Z===0,isLast:k.length-1===Z,bodyProps:C});S.appendChild($),Z++},G=0,J=k;G<J.length;G++)K(J[G]);return S}(n.textBody,A,n.isTextBox);return v&&u.appendChild(v),s&&u.style.setProperty("transform","rotate(".concat(s,"deg)")),u}function Bt(n){var t=document.createElement("div"),r=n.extend;n.chExtend;var e=n.offset,a=n.chOffset,s=n.flipV,o=n.flipH,c=n.rotate,u=e.x,f=e.y,h=r.w,g=r.h;t.className="group",t.style.position="absolute",t.style.left=u+"px",t.style.top=f+"px",t.style.width=h+"px",t.style.height=g+"px";var b=[];o&&b.push("scaleX(-1)"),s&&b.push("scaleY(-1)"),c&&b.push("rotate(".concat(c,"deg)")),t.style.transformOrigin="center center",t.style.transform=b.join(" ");for(var A=0;A<n.nodes.length;A++){var P=n.nodes[A],x=void 0;P instanceof q?x=jt(P):P instanceof X?x=Et(P):P instanceof ut&&(x=Bt(P)),x.style.left=parseInt(x.style.left)-a.x+"px",x.style.top=parseInt(x.style.top)-a.y+"px",t.appendChild(x)}return t}var pe=function(){function n(t,r,e){this.scale=1,this.wrapper=t,this.pptx=r,this.options=e,this._calcScaleAndRenderPort()}return n.prototype._calcScaleAndRenderPort=function(){var t=this.options.viewPort.width/this.pptx.width,r=this.options.viewPort.height/this.pptx.height;if(this.scale=Math.min(t,r),t<r){var e=this.options.viewPort.width,a=this.pptx.height*this.scale;this.renderPort={width:e,height:a,left:0,top:(this.options.viewPort.height-a)/2}}else e=this.pptx.width*this.scale,a=this.options.viewPort.height,this.renderPort={width:e,height:a,left:(this.options.viewPort.width-e)/2,top:0}},n.prototype.renderSlide=function(t){var r=this.pptx.slides[t],e=document.createElement("div");e.classList.add("pptx-preview-slide-wrapper"),e.style.setProperty("width",this.renderPort.width+"px"),e.style.setProperty("height",this.renderPort.height+"px"),e.style.setProperty("position","relative"),e.style.margin="0 auto 10px",e.style.setProperty("background","#fff"),e.style.setProperty("overflow","hidden"),this._renderBackground(r,e),this._renderSlideMaster(r.slideMaster,e),this._renderSlideLayout(r.slideLayout,e),this._renderSlide(r,e),this.wrapper.append(e)},n.prototype._renderSlideMaster=function(t,r){var e=document.createElement("div");e.classList.add("slide-master-wrapper"),e.style.setProperty("position","absolute"),e.style.setProperty("left","0"),e.style.setProperty("top","0"),e.style.setProperty("width","100%"),e.style.setProperty("height","100%");var a=st([],t.nodes,!0).filter(function(c){return c.userDrawn});a.sort(function(c,u){return c.order>u.order?1:-1});for(var s=0;s<a.length;s++){var o=this._renderNode(a[s]);o&&e.append(o)}r.append(e)},n.prototype._renderSlideLayout=function(t,r){var e=document.createElement("div");e.classList.add("slide-layout-wrapper"),e.style.setProperty("position","absolute"),e.style.setProperty("left","0"),e.style.setProperty("top","0"),e.style.setProperty("width","100%"),e.style.setProperty("height","100%");var a=st([],t.nodes,!0).filter(function(c){return c.userDrawn});a.sort(function(c,u){return c.order>u.order?1:-1});for(var s=0;s<a.length;s++){var o=this._renderNode(a[s]);o&&e.append(o)}r.append(e)},n.prototype._renderSlide=function(t,r){var e=document.createElement("div");e.classList.add("slide-wrapper"),e.style.setProperty("position","absolute"),e.style.setProperty("left","0"),e.style.setProperty("top","0"),e.style.setProperty("width",this.pptx.width+"px"),e.style.setProperty("height",this.pptx.height+"px"),e.style.setProperty("transform","scale(".concat(this.scale,")")),e.style.setProperty("transform-origin","0 0");var a=st([],t.nodes,!0);a.sort(function(c,u){return c.order>u.order?1:-1});for(var s=0;s<a.length;s++){var o=this._renderNode(a[s]);o&&e.append(o)}r.append(e)},n.prototype._renderNode=function(t){return t instanceof q?jt(t):t instanceof X?Et(t):t instanceof ut?Bt(t):void 0},n.prototype._renderBackground=function(t,r){var e=document.createElement("div");e.classList.add("slide-background"),e.style.setProperty("position","absolute"),e.style.setProperty("left","0"),e.style.setProperty("top","0"),e.style.setProperty("width","100%"),e.style.setProperty("height","100%");var a=t.background;if(a.type==="none"&&(a=t.slideLayout.background),a.type==="none"&&(a=t.slideMaster.background),a.type==="blipFill"){var s=a,o=s.base64,c=s.alpha,u=s.fillRect,f=u===void 0?{}:u,h=f.b,g=h===void 0?0:h,b=f.t,A=b===void 0?0:b,P=f.l,x=P===void 0?0:P,v=f.r,p=v===void 0?0:v,i=this.renderPort.width*x,d=this.renderPort.height*A,y=this.renderPort.width*(1-x-p),m=this.renderPort.height*(1-A-g);e.style.backgroundImage="url(".concat(o,")"),e.style.backgroundSize="".concat(y," ").concat(m),e.style.backgroundPosition="".concat(i,"px ").concat(d,"px"),c&&(e.style.opacity=c+""),e.style.backgroundRepeat="no-repeat"}else{var w=R(t.background)||R(t.slideLayout.background)||R(t.slideMaster.background);w?e.style.setProperty("background",w):e.style.setProperty("background","#fff")}r.append(e)},n}(),de=function(){function n(t,r){this.dom=t,this.options=r,this._renderWrapper()}return n.prototype._renderWrapper=function(){var t=document.createElement("div");t.classList.add("pptx-preview-wrapper"),t.style.setProperty("background","#000"),t.style.setProperty("width",this.options.width+"px"),this.options.height&&t.style.setProperty("height",this.options.height+"px"),t.style.setProperty("position","relative"),this.options.height&&t.style.setProperty("overflow-y","auto"),this.dom.append(t),this.wrapper=t},n.prototype.preview=function(t){var r=this;return new Promise(function(e,a){r.wrapper.innerHTML="";var s=new ie;s.load(t).then(function(){console.log("pptx 实例",s),console.log("slide1",s.slides[0]);var o=new pe(r.wrapper,s,{viewPort:{width:r.options.width,height:r.options.height}});console.log("htmlRender",o);for(var c=0;c<s.slides.length;c++)o.renderSlide(c)})})},n}();function ue(n,t){return new de(n,t)}const he=zt({name:"VueOfficePptx",props:{src:[String,ArrayBuffer,Blob],requestOptions:{type:Object,default:()=>({})},options:{type:Object,default:()=>({})}},emits:["rendered","error"],setup(n,{emit:t}){let r=null;const e=_t(null);function a(){let c=e.value,u=n.options.width||c.getBoundingClientRect().width||960,f=n.options.height||c.getBoundingClientRect().height||540;r=ue(c,{width:u,height:f})}function s(c){if(typeof c=="string")return fetch(c,n.requestOptions).then(u=>u.arrayBuffer());if(c instanceof ArrayBuffer)return Promise.resolve(c)}function o(){n.src&&s(n.src).then(c=>{r.preview(c),t("rendered")}).catch(c=>{t("error",c)})}return Ht(()=>{a(),o()}),Wt(()=>n.src,()=>{o()}),{rootRef:e}}}),fe={class:"vue-office-pptx"},ye={class:"vue-office-pptx-main",ref:"rootRef"};function ge(n,t,r,e,a,s){return Ct(),Vt("div",fe,[Xt("div",ye,null,512)])}const nt=Ut(he,[["render",ge]]);nt.install=function(n){n.component(nt.name,nt)};const Pe={__name:"PptxDemo",setup(n){function t(){ht.hideLoading()}function r(o){console.log("出差",o),ht.hideLoading()}const e=location.origin+(location.pathname+"/").replace("//","/")+"static/test-files/test.pptx",a=_t(),s={headers:{}};return(o,c)=>(Ct(),Zt(qt,{accept:".pptx",placeholder:"请输入pptx文件地址","default-src":e},{default:Qt(u=>[Gt(Yt(nt),{ref_key:"docxRef",ref:a,src:u.src,style:{flex:"1",height:"0"},"request-options":s,onRendered:t,onError:r},null,8,["src"])]),_:1}))}};export{Pe as default};
