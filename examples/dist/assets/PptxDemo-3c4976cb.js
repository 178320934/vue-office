import{o as Gt}from"./jszip.min-c9cc99f2.js";import{l as d}from"./lodash-4a4505dd.js";import{d as Qt,_ as qt,r as Tt,o as Yt,w as Jt,a as Rt,c as $t,b as Kt,e as te,f as ee,g as re,u as ne}from"./index-b5843e08.js";import{P as ae,u as xt}from"./PreviewWrapper-07c4c014.js";import"./_commonjs-dynamic-modules-302442b1.js";var mt=function(n,t){return mt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,e){a.__proto__=e}||function(a,e){for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(a[s]=e[s])},mt(n,t)};function Ot(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");mt(n,t);function a(){this.constructor=n}n.prototype=t===null?Object.create(t):(a.prototype=t.prototype,new a)}var X=function(){return X=Object.assign||function(t){for(var a,e=1,s=arguments.length;e<s;e++){a=arguments[e];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(t[o]=a[o])}return t},X.apply(this,arguments)};function O(n,t,a,e){function s(o){return o instanceof a?o:new a(function(c){c(o)})}return new(a||(a=Promise))(function(o,c){function h(g){try{m(e.next(g))}catch(y){c(y)}}function u(g){try{m(e.throw(g))}catch(y){c(y)}}function m(g){g.done?o(g.value):s(g.value).then(h,u)}m((e=e.apply(n,t||[])).next())})}function F(n,t){var a={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},e,s,o,c=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return c.next=h(0),c.throw=h(1),c.return=h(2),typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function h(m){return function(g){return u([m,g])}}function u(m){if(e)throw new TypeError("Generator is already executing.");for(;c&&(c=0,m[0]&&(a=0)),a;)try{if(e=1,s&&(o=m[0]&2?s.return:m[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,m[1])).done)return o;switch(s=0,o&&(m=[m[0]&2,o.value]),m[0]){case 0:case 1:o=m;break;case 4:return a.label++,{value:m[1],done:!1};case 5:a.label++,s=m[1],m=[0];continue;case 7:m=a.ops.pop(),a.trys.pop();continue;default:if(o=a.trys,!(o=o.length>0&&o[o.length-1])&&(m[0]===6||m[0]===2)){a=0;continue}if(m[0]===3&&(!o||m[1]>o[0]&&m[1]<o[3])){a.label=m[1];break}if(m[0]===6&&a.label<o[1]){a.label=o[1],o=m;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(m);break}o[2]&&a.ops.pop(),a.trys.pop();continue}m=t.call(n,a)}catch(g){m=[6,g],s=0}finally{e=o=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}function pt(n,t,a){if(a||arguments.length===2)for(var e=0,s=t.length,o;e<s;e++)(o||!(e in t))&&(o||(o=Array.prototype.slice.call(t,0,e)),o[e]=t[e]);return n.concat(o||Array.prototype.slice.call(t))}var R=[];for(var ht=0;ht<256;++ht)R.push((ht+256).toString(16).slice(1));function oe(n,t=0){return(R[n[t+0]]+R[n[t+1]]+R[n[t+2]]+R[n[t+3]]+"-"+R[n[t+4]]+R[n[t+5]]+"-"+R[n[t+6]]+R[n[t+7]]+"-"+R[n[t+8]]+R[n[t+9]]+"-"+R[n[t+10]]+R[n[t+11]]+R[n[t+12]]+R[n[t+13]]+R[n[t+14]]+R[n[t+15]]).toLowerCase()}var at,se=new Uint8Array(16);function ie(){if(!at&&(at=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!at))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return at(se)}var ce=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const wt={randomUUID:ce};function le(n,t,a){if(wt.randomUUID&&!t&&!n)return wt.randomUUID();n=n||{};var e=n.random||(n.rng||ie)();if(e[6]=e[6]&15|64,e[8]=e[8]&63|128,t){a=a||0;for(var s=0;s<16;++s)t[a+s]=e[s];return t}return oe(e)}var ot=1;function J(n){var t="<".charCodeAt(0),a=">".charCodeAt(0),e="-".charCodeAt(0),s="/".charCodeAt(0),o="!".charCodeAt(0),c="'".charCodeAt(0),h='"'.charCodeAt(0),u="?".charCodeAt(0),m=`\r
	>/= `,g=0;return ot=1,Ft(function y(){for(var x=[];n[g];){if(n.charCodeAt(g)==t){if(n.charCodeAt(g+1)===s)return g=n.indexOf(">",g),x;if(n.charCodeAt(g+1)===o){if(n.charCodeAt(g+2)==e){for(;n.charCodeAt(g)!==a||n.charCodeAt(g-1)!=e||n.charCodeAt(g-2)!=e||g==-1;)g=n.indexOf(">",g+1);g===-1&&(g=n.length)}else for(g+=2;n.charCodeAt(g)!==a;g++);g++;continue}if(n.charCodeAt(g+1)===u){g=n.indexOf(">",g),g++;continue}for(var k=++g;m.indexOf(n[g])===-1;g++);for(var L=n.slice(k,g),w=!1,v={};n.charCodeAt(g)!==a;g++){var l=n.charCodeAt(g);if(l>64&&l<91||l>96&&l<123){for(k=g;m.indexOf(n[g])===-1;g++);for(var r=n.slice(k,g),i=n.charCodeAt(g);i!==c&&i!==h;)g++,i=n.charCodeAt(g);var p=n[g],f=++g;g=n.indexOf(p,f);var b=n.slice(f,g);w||(v={},w=!0),v[r]=b}}var P=[];n.charCodeAt(g-1)!==s&&(g++,P=y()),x.push({children:P,tagName:L,attrs:v})}else{var S=g;(g=n.indexOf("<",g)-1)===-2&&(g=n.length);var A=n.slice(S,g+1);A.length>0&&x.push(A)}g++}return x}())}function Ft(n){var t={};if(n===void 0)return{};if(n.length===1&&typeof n[0]=="string")return n[0];for(var a in n.forEach(function(e){if(t[e.tagName]||(t[e.tagName]=[]),typeof e=="object"){var s=Ft(e.children);typeof s=="object"&&(e.attrs&&(s.attrs=e.attrs),s.attrs===void 0?s.attrs={order:ot}:s.attrs.order=ot),ot++,t[e.tagName].push(s)}}),t)t[a].length==1&&(t[a]=t[a][0]);return t}function j(n){return n/12700}function Pt(n){return n/100}function ct(n){return n/6e4}function $(n){return n/1e5}function dt(n){var t=Math.ceil(n/26),a=(n%26||26)-1+65;return String.fromCharCode(a).repeat(t)}function U(n,t,a){var e={type:"solidFill"};if(n["a:srgbClr"])e.color="#"+n["a:srgbClr"].attrs.val;else if(n["a:schemeClr"]){var s=n["a:schemeClr"].attrs.val;a&&(s=a.getColorThemeName(s)),e.color=t.getColor(s)}else n["a:sysClr"]&&(e.color="#"+n["a:sysClr"].attrs.lastClr);var o=n["a:srgbClr"]||n["a:schemeClr"]||n["a:sysClr"],c=d.get(o,["a:alpha","attrs","val"],1e5);e.alpha=c/1e5;var h=d.get(o,["a:shade","attrs","val"]);h&&(e.shade=h/1e5);var u=d.get(o,["a:lumMod","attrs","val"]);u&&(e.lumMod=u/1e5);var m=d.get(o,["a:lumOff","attrs","val"]);return m&&(e.lumOff=m/1e5),e}function rt(n,t,a){var e,s={type:"blipFill"},o=d.get(n,["a:blip","attrs","r:embed"]);if(o){var c=(e=a.rels[o])===null||e===void 0?void 0:e.target;c&&(s.base64=t.getMedia(c))}var h=d.get(n,["a:blip","a:alphaModFix","attrs","amt"]);h&&(s.alpha=h/1e5);var u=d.get(n,["a:stretch","a:fillRect","attrs"]);return u&&(s.fillRect={},u.b&&(s.fillRect.b=u.b/1e5),u.t&&(s.fillRect.t=u.t/1e5),u.r&&(s.fillRect.r=u.r/1e5),u.l&&(s.fillRect.l=u.l/1e5)),s}function nt(n,t,a){var e={type:"gradFill",tileRect:{},lin:{},gsList:[]};e.flip=n.attrs.flip,e.path=d.get(n,["a:path","attrs","path"])||"linear",e.rotWithShape=n.attrs.rotWithShape==="1",d.get(n,["a:lin","attrs","ang"])&&(e.lin.ang=ct(n["a:lin"].attrs.ang)),d.get(n,["a:lin","attrs","scaled"])&&(e.lin.scaled=n["a:lin"].attrs.scaled==="1");var s=d.get(n,["a:gsLst","a:gs"])||[];return e.gsList=s.map(function(o){return{color:U(o,t,a),pos:$(o.attrs.pos)}}),d.get(n,["a:tileRect","attrs","l"])&&(e.tileRect.l=$(n["a:tileRect"].attrs.l)),d.get(n,["a:tileRect","attrs","t"])&&(e.tileRect.t=$(n["a:tileRect"].attrs.t)),d.get(n,["a:tileRect","attrs","r"])&&(e.tileRect.r=$(n["a:tileRect"].attrs.r)),d.get(n,["a:tileRect","attrs","b"])&&(e.tileRect.b=$(n["a:tileRect"].attrs.b)),e}function ut(n){return n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function ft(n){return n<.0031308?12.92*n:1.055*Math.pow(n,1/2.4)-.055}function kt(n,t,a){var e=n/255,s=t/255,o=a/255,c=Math.max(e,s,o),h=Math.min(e,s,o),u=c-h,m=0,g=(c+h)/2;return u===0?m=0:c===e?m=(s-o)/u%6:c===s?m=(o-e)/u+2:c===o&&(m=(e-s)/u+4),(m=Math.round(60*m))<0&&(m+=360),{h:m,s:u===0||g===0||g===1?0:u/(1-Math.abs(2*g-1)),l:g}}function At(n,t,a){var e,s,o,c=(1-Math.abs(2*a-1))*t,h=c*(1-Math.abs(n/60%2-1)),u=a-c/2;return n<60?(e=c,s=h,o=0):n<120?(e=h,s=c,o=0):n<180?(e=0,s=c,o=h):n<240?(e=0,s=h,o=c):n<300?(e=h,s=0,o=c):(e=c,s=0,o=h),[e=Math.round(255*(e+u)),s=Math.round(255*(s+u)),o=Math.round(255*(o+u))]}function Z(n){if(!n||n.type==="none")return"";if(n.type==="solidFill"&&/^#[\da-fA-F]{3,6}$/.test(n.color)){var t=parseInt(n.color.substr(1,2),16),a=parseInt(n.color.substr(3,2),16),e=parseInt(n.color.substr(5,2),16);if(n.shade){var s=function(h,u){var m=h[0],g=h[1],y=h[2],x=ut(m/255)*u,k=ut(g/255)*u,L=ut(y/255)*u;return[Math.round(255*ft(x)),Math.round(255*ft(k)),Math.round(255*ft(L))]}([t,a,e],n.shade);t=s[0],a=s[1],e=s[2]}if(n.lumMod){var o=function(h,u,m,g){var y=kt(h,u,m),x=y.h,k=y.l*g;return k>=1&&(k=1),At(x,y.s,k)}(t,a,e,n.lumMod);t=o[0],a=o[1],e=o[2]}n.lumOff&&(o=function(h,u,m,g){var y=kt(h,u,m),x=y.h,k=g+y.l;return k>1&&(k=1),At(x,y.s,k)}(t,a,e,n.lumOff),t=o[0],a=o[1],e=o[2]);var c=n.alpha;return"rgba(".concat(t,",").concat(a,",").concat(e,",").concat(c,")")}}var Dt=function(){function n(t,a,e){this.uuid=le(),this.offset={x:0,y:0},this.extend={w:0,h:0},this.rotate=0,this.order=0,this.flipV=!1,this.flipH=!1,this.source=t,this.ctx=a,this.group=e;var s=d.get(t,["p:nvSpPr","p:nvPr"]);if(s){var o=d.get(s,"p:ph");o&&o.attrs&&(this.idx=o.attrs.idx,this.type=o.attrs.type),d.get(s,["attrs","userDrawn"])&&(this.userDrawn=d.get(s,["attrs","userDrawn"])==="1")}if(this.order=d.get(t,"attrs.order",0),this.source["p:spPr"]){var c=this.getXfrm();c&&(this.offset={x:Math.round(j(parseInt(c["a:off"].attrs.x))),y:Math.round(j(parseInt(c["a:off"].attrs.y)))},this.extend={w:Math.round(j(parseInt(c["a:ext"].attrs.cx))),h:Math.round(j(parseInt(c["a:ext"].attrs.cy)))},this.rotate=ct(parseInt(d.get(c,"attrs.rot",0))),this.flipV=d.get(c,"attrs.flipV")==="1",this.flipH=d.get(c,"attrs.flipH")==="1")}}return Object.defineProperty(n.prototype,"theme",{get:function(){return(this.ctx.sliderMaster||this.ctx).theme},enumerable:!1,configurable:!0}),n.prototype.getColorThemeName=function(t){return this.ctx.getColorThemeName(t)},n.prototype.getXfrm=function(){var t=this.source["p:spPr"]["a:xfrm"];return t||(this.idx?t=this.ctx.getNodeInheritAttrsByIdx(this.idx,["p:spPr","a:xfrm"]):this.type&&(t=this.ctx.getNodeInheritAttrsByType(this.type,["p:spPr","a:xfrm"]))),t},n}(),pe=function(){function n(t,a){this.props={},this.inheritProps={},this.source=t,this.node=a,this._getInheritBodyProps(),this._parseBodyProps(),this._parseLstStyle(),this._parseText()}return n.prototype._getInheritBodyProps=function(){var t,a=this.node.ctx,e=this.node.type,s=this.node.idx;if(e||s)switch(a.slideType){case"slideMaster":break;case"slideLayout":(t=e?a.slideMaster.getNodeByType(e):a.slideMaster.getNodeByIdx(s))&&(this.inheritProps=d.get(t,["textBody","props"])||{});break;case"slide":(t=e?a.slideLayout.slideMaster.getNodeByType(e):a.slideLayout.slideMaster.getNodeByIdx(s))&&Object.assign(this.inheritProps,d.get(t,["textBody","props"])||{}),(t=e?a.slideLayout.getNodeByType(e):a.slideLayout.getNodeByIdx(s))&&Object.assign(this.inheritProps,d.get(t,["textBody","props"])||{})}},n.prototype._parseBodyProps=function(){var t=this,a=d.get(this.source,["a:bodyPr","attrs"])||{};Object.keys(a).forEach(function(c){switch(c){case"anchor":t.props.anchor=a[c];break;case"rtlCol":t.props.rtlCol=a[c]==="1";break;case"lIns":case"rIns":case"tIns":case"bIns":t.props[c]=j(parseInt(a[c]));break;case"order":break;default:t.props[c]=a[c]}});var e=d.get(this.source,["a:bodyPr","a:normAutofit","attrs"]);if(e){this.props.normAutofit={};var s=e.fontScale;s&&(this.props.normAutofit.fontScale=$(parseInt(s)));var o=e.lnSpcReduction;o&&(this.props.normAutofit.lnSpcReduction=$(parseInt(o)))}},n.prototype._parseLstStyle=function(){var t=this,a={},e=d.get(this.source,"a:lstStyle")||{};Object.keys(e).forEach(function(s){if(s.startsWith("a:")&&s.endsWith("pPr")){var o=s.substr(2,s.length-5);a[o]={props:t._formatPPr(e[s])};var c=d.get(e[s],["a:defRPr"]);a[o].defRPr=t._formatRPr(c)}}),this.lstStyle=a},n.prototype._parseText=function(){var t=this,a=d.get(this.source,["a:p"])||[];Array.isArray(a)||(a=[a]),this.paragraphs=a.map(function(e){return t._parseParagraph(e)})},n.prototype._parseParagraph=function(t){var a=this,e={props:{},inheritProps:{},inheritRProps:{},endParaRProps:{},rows:[]},s=d.get(t,["a:pPr"])||{};e.props=this._formatPPr(s);var o=d.get(t,["a:endParaRPr"]);e.endParaRProps=this._formatRPr(o);var c=d.get(t,["a:r"])||[];Array.isArray(c)||(c=[c]);var h=d.get(t,["a:br"])||[];return Array.isArray(h)||(h=[h]),(c=c.concat(h.map(function(u){return X({isBr:!0},u)}))).sort(function(u,m){return d.get(u,["attrs","order"])-d.get(m,["attrs","order"])}),e.rows=c.map(function(u){return a._parseRow(u)}),e.inheritProps=this._getInheritPProps(e.props.level),e.inheritRProps=this._getInheritRProps(e.props.level),e},n.prototype._getInheritPProps=function(t){t===void 0&&(t="0");var a,e={},s=this.node.ctx,o=this.node.type,c=this.node.idx;switch(s.slideType){case"slideMaster":this.node.isTextBox?Object.assign(e,d.get(s.defaultTextStyle,["lvl".concat(t?+t+1:1),"props"])||{}):Object.assign(e,d.get(s,["textStyles","otherStyle","lvl".concat(t?+t+1:1),"props"])||{});break;case"slideLayout":this.node.isTextBox?Object.assign(e,d.get(s.slideMaster.defaultTextStyle,["lvl".concat(t?+t+1:1),"props"])||{}):Object.assign(e,d.get(s.slideMaster,["textStyles","otherStyle","lvl".concat(t?+t+1:1),"props"])||{}),(o||c)&&(a=o?s.slideMaster.getNodeByType(o):s.slideMaster.getNodeByIdx(c))&&Object.assign(e,d.get(a,["textBody","lstStyle","lvl".concat(t?+t+1:1),"props"])||{});break;case"slide":this.node.isTextBox?Object.assign(e,d.get(s.slideLayout.slideMaster.defaultTextStyle,["lvl".concat(t?+t+1:1),"props"])||{}):Object.assign(e,d.get(s.slideLayout.slideMaster,["textStyles","otherStyle","lvl".concat(t?+t+1:1),"props"])||{}),(o||c)&&(["subTitle","ctrTitle","title"].includes(o)&&Object.assign(e,d.get(s.slideLayout.slideMaster,["textStyles","titleStyle","lvl".concat(t?+t+1:1),"props"])||{}),(a=o?s.slideLayout.slideMaster.getNodeByType(o):s.slideLayout.slideMaster.getNodeByIdx(c))&&Object.assign(e,d.get(a,["textBody","lstStyle","lvl".concat(t?+t+1:1),"props"])||{}),(a=o?s.slideLayout.getNodeByType(o):s.slideLayout.getNodeByIdx(c))&&Object.assign(e,d.get(a,["textBody","lstStyle","lvl".concat(t?+t+1:1),"props"])||{}))}return e},n.prototype._getInheritRProps=function(t){t===void 0&&(t="0");var a,e={},s=this.node.ctx,o=this.node.type,c=this.node.idx;switch(s.slideType){case"slideMaster":this.node.isTextBox?Object.assign(e,d.get(s.defaultTextStyle,["lvl".concat(t?+t+1:1),"defRPr"])||{}):Object.assign(e,d.get(s,["textStyles","otherStyle","lvl".concat(t?+t+1:1),"defRPr"])||{});break;case"slideLayout":this.node.isTextBox?Object.assign(e,d.get(s.slideMaster.defaultTextStyle,["lvl".concat(t?+t+1:1),"defRPr"])||{}):Object.assign(e,d.get(s.slideMaster,["textStyles","otherStyle","lvl".concat(t?+t+1:1),"defRPr"])||{}),(o||c)&&(a=o?s.slideMaster.getNodeByType(o):s.slideMaster.getNodeByIdx(c))&&(e=d.get(a,["textBody","lstStyle","lvl".concat(t?+t+1:1),"defRPr"])||{});break;case"slide":this.node.isTextBox?Object.assign(e,d.get(s.slideLayout.slideMaster.defaultTextStyle,["lvl".concat(t?+t+1:1),"defRPr"])||{}):Object.assign(e,d.get(s.slideLayout.slideMaster,["textStyles","otherStyle","lvl".concat(t?+t+1:1),"defRPr"])||{}),(o||c)&&(["subTitle","ctrTitle","title"].includes(o)&&Object.assign(e,d.get(s.slideLayout.slideMaster,["textStyles","titleStyle","lvl".concat(t?+t+1:1),"defRPr"])||{}),(a=o?s.slideLayout.slideMaster.getNodeByType(o):s.slideLayout.slideMaster.getNodeByIdx(c))&&Object.assign(e,d.get(a,["textBody","lstStyle","lvl".concat(t?+t+1:1),"defRPr"])||{}),(a=o?s.slideLayout.getNodeByType(o):s.slideLayout.getNodeByIdx(c))&&Object.assign(e,d.get(a,["textBody","lstStyle","lvl".concat(t?+t+1:1),"defRPr"])||{}))}var h=d.get(this.node.source,["p:style","a:fontRef"]);return d.get(h,"a:schemeClr")&&(e.color=U(h,this.node.theme,this.node)),d.get(this.lstStyle,["lvl".concat(t?+t+1:1),"defRPr"])&&Object.assign(e,d.get(this.lstStyle,["lvl".concat(t?+t+1:1),"defRPr"])),e},n.prototype._formatPPr=function(t){var a={},e=d.get(t,"attrs")||{};return Object.keys(e).forEach(function(s){switch(s){case"algn":a.align=e[s];break;case"marL":a.marginLeft=j(parseInt(e[s]));break;case"indent":a.indent=j(parseInt(e[s]));break;case"lvl":a.level=e[s]}}),d.get(t,["a:lnSpc","a:spcPct","attrs","val"])&&(a.lineHeight=parseInt(t["a:lnSpc"]["a:spcPct"].attrs.val)/1e5),d.get(t,["a:buAutoNum","attrs","type"])&&(a.buAutoNum=t["a:buAutoNum"].attrs.type),d.get(t,["a:buChar","attrs","char"])&&(a.buChar=t["a:buChar"].attrs.char),d.get(t,["a:spcBef","a:spcPts","attrs","val"])&&(a.spaceBefore=Pt(parseInt(t["a:spcBef"]["a:spcPts"].attrs.val))),d.get(t,["a:spcAft","a:spcPts","attrs","val"])&&(a.spaceAfter=Pt(parseInt(t["a:spcAft"]["a:spcPts"].attrs.val))),a},n.prototype._parseRow=function(t){if(t.isBr)return{isBr:!0};var a={props:{},text:""},e=d.get(t,["a:rPr"])||{};return a.props=this._formatRPr(e),a.text=d.get(t,"a:t")||"",a},n.prototype._formatRPr=function(t){var a={},e=d.get(t,"attrs")||{};Object.keys(e).forEach(function(c){switch(c){case"sz":a.size=parseInt(e[c])/100;break;case"b":a.bold=e[c]==="1";break;case"i":a.italic=e[c]==="1";break;case"u":a.underline=e[c];break;case"strike":a.strike=e[c];break;case"order":case"dirty":break;default:a[c]=e[c]}});var s=d.get(t,"a:solidFill");s&&(a.color=U(s,this.node.theme,this.node));var o=d.get(t,"a:highlight");return o&&(a.background=U(o,this.node.theme,this.node)),a.typeface=d.get(t,["a:ea","attrs","typeface"]),a},n}(),it=function(n){function t(a,e,s,o){var c=n.call(this,a,s,o)||this;return c.border={},c.prstGeom={},c.isTextBox=!1,c.pptx=e,c._parseShape(),c._parIsTextBox(),c._parsePrstGeom(),c._parseBackground(),c._parseBorder(),c._parseTxt(),c}return Ot(t,n),t.prototype._parseShape=function(){if(this.shape=d.get(this.source,["p:spPr","a:prstGeom","attrs","prst"]),!this.shape&&d.get(this.source,["p:spPr","a:custGeom"])){this.shape="customGeom";var a=d.get(this.source,["p:spPr","a:custGeom","a:pathLst","a:path"]),e=[],s=[],o=function(h){switch(h){case"a:moveTo":case"a:cubicBezTo":case"a:lnTo":s=Array.isArray(a[h])?a[h]:[a[h]],e=e.concat(s.map(function(u){return{order:u.attrs.order,type:h.split(":")[1],points:(Array.isArray(u["a:pt"])?u["a:pt"]:[u["a:pt"]]).map(function(m){return[j(parseInt(d.get(m,["attrs","x"]))),j(parseInt(d.get(m,["attrs","y"])))]})}}));break;case"a:close":s=Array.isArray(a[h])?a[h]:[a[h]],e=e.concat(s.map(function(u){return{order:u.attrs.order,type:h.split(":")[1]}}))}};for(var c in a)o(c);e.sort(function(h,u){return h.order-u.order}),this.prstGeom.pathList=e}},t.prototype._parIsTextBox=function(){this.isTextBox=d.get(this.source,["p:nvSpPr","p:cNvSpPr","attrs","txBox"])==="1"},t.prototype._parsePrstGeom=function(){var a=this,e=d.get(this.source,["p:spPr","a:prstGeom"]),s=d.get(e,["a:avLst","a:gd"]);s&&(Array.isArray(s)||(s=[s]),this.prstGeom.gd=s.map(function(o){var c=["pie","chord"].includes(a.shape)?ct(parseInt(o.attrs.fmla.split(" ")[1])):$(parseInt(o.attrs.fmla.split(" ")[1]));return{name:o.attrs.name,fmla:c}}))},t.prototype._parseBackground=function(){if(!d.get(this.source,["p:spPr","a:noFill"]))if(d.get(this.source,["p:spPr","a:grpFill"])&&this.group)this.background=this.group.getBackground();else{var a=d.get(this.source,["p:spPr","a:solidFill"]);if(a)this.background=U(a,this.theme,this);else{var e=d.get(this.source,["p:spPr","a:gradFill"]);if(e)this.background=nt(e,this.theme,this);else{var s=d.get(this.source,["p:spPr","a:blipFill"]);if(s)this.background=rt(s,this.pptx,this.ctx);else{var o=d.get(this.source,["p:style","a:fillRef"]);o&&(this.background=U(o,this.theme,this))}}}}},t.prototype._parseBorder=function(){var a=d.get(this.source,["p:style","a:lnRef"]);if(a){var e=parseInt(a.attrs.idx),s=this.theme.getLineStyle(e);this.border=X(X({},s),this.border),this.border.color&&this.border.color.color||(this.border.color=U(a,this.theme,this))}var o=d.get(this.source,["p:spPr","a:ln"]);if(o){if(d.get(o,"a:noFill"))return;d.get(o,"attrs.w")&&(this.border.width=j(parseInt(d.get(o,"attrs.w"))));var c=d.get(o,"a:solidFill");c&&(this.border.color=U(c,this.theme,this));var h=d.get(o,"a:prstDash");if(h&&(this.border.type=h.attrs.val),d.get(o,["a:miter"])&&(this.border.lineJoin="miter"),d.get(o,["a:bevel"])&&(this.border.lineJoin="bevel"),d.get(o,["a:round"])&&(this.border.lineJoin="round"),d.get(o,["a:miter","attrs","lim"])&&(this.border.miterLim=j(parseInt(d.get(o,["a:miter","attrs","lim"])))),d.get(o,["a:headEnd"])){var u=d.get(o,["a:headEnd","attrs"]);this.border.headEnd={type:u.type,len:u.len,w:u.w}}if(d.get(o,["a:tailEnd"])){var m=d.get(o,["a:tailEnd","attrs"]);this.border.tailEnd={type:m.type,len:m.len,w:m.w}}Object.assign(this.border,d.omit(d.get(o,"attrs")||{},["w","order"]))}this.border.color&&this.border.color.color&&!this.border.width&&(this.border.width=t.defaultBorderWidth)},t.prototype._parseTxt=function(){this.textBody=new pe(d.get(this.source,["p:txBody"]),this)},t.defaultBorderWidth=.75,t}(Dt),bt=function(n){function t(a,e,s,o){var c=n.call(this,e,o)||this;c.userDrawn=!0,c.pptx=s,c.path=a;var h=d.get(c.source,["p:blipFill","a:srcRect"]);return h&&(c.clip={},h.attrs.b&&(c.clip.b=parseInt(h.attrs.b)/1e5),h.attrs.t&&(c.clip.t=parseInt(h.attrs.t)/1e5),h.attrs.l&&(c.clip.l=parseInt(h.attrs.l)/1e5),h.attrs.r&&(c.clip.r=parseInt(h.attrs.r)/1e5)),c}return Ot(t,n),Object.defineProperty(t.prototype,"base64",{get:function(){return this.pptx.getMedia(this.path)},enumerable:!1,configurable:!0}),t}(Dt),vt=function(){function n(t,a,e,s){if(this.offset={x:0,y:0},this.chOffset={x:0,y:0},this.extend={w:0,h:0},this.chExtend={w:0,h:0},this.rotate=0,this.nodes=[],this.flipV=!1,this.flipH=!1,this.userDrawn=!0,this.order=d.get(t,["attrs","order"]),this.pptx=a,this.ctx=e,this.source=t,this.group=s,this.source["p:grpSpPr"]){var o=d.get(this.source,["p:grpSpPr","a:xfrm"]);o&&(this.offset={x:Math.round(j(parseInt(o["a:off"].attrs.x))),y:Math.round(j(parseInt(o["a:off"].attrs.y)))},this.chOffset={x:Math.round(j(parseInt(o["a:chOff"].attrs.x))),y:Math.round(j(parseInt(o["a:chOff"].attrs.y)))},this.extend={w:Math.round(j(parseInt(o["a:ext"].attrs.cx))),h:Math.round(j(parseInt(o["a:ext"].attrs.cy)))},this.chExtend={w:Math.round(j(parseInt(o["a:chExt"].attrs.cx))),h:Math.round(j(parseInt(o["a:chExt"].attrs.cy)))},this.rotate=ct(parseInt(d.get(o,"attrs.rot",0))),this.flipV=d.get(o,"attrs.flipV")==="1",this.flipH=d.get(o,"attrs.flipH")==="1")}this._parseBackground(),this._parseNodes()}return n.prototype.getBackground=function(){return this.background&&this.background.type!=="none"?this.background:this.group?this.group.getBackground():void 0},n.prototype._parseBackground=function(){var t=d.get(this.source,["p:grpSpPr"]);t&&t["a:solidFill"]?this.background=U(t["a:solidFill"],this.ctx.theme,this.ctx):t&&t["a:gradFill"]?this.background=nt(t["a:gradFill"],this.ctx.theme,this.ctx):t&&t["a:blipFill"]&&(this.background=rt(t["a:blipFill"],this.pptx,this.ctx))},n.prototype._parseNodes=function(){var t=this.source;lt(this.nodes,t,this.pptx,this.ctx,this)},n}();function Lt(n){var t={},a=d.get(n,"attrs")||{};return Object.keys(a).forEach(function(e){switch(e){case"algn":t.align=a[e];break;case"marL":t.marginLeft=j(parseInt(a[e]));break;case"indent":t.indent=j(parseInt(a[e]));break;case"lvl":t.level=a[e]}}),d.get(n,["a:lnSpc","a:spcPct","attrs","val"])&&(t.lineHeight=parseInt(n["a:lnSpc"]["a:spcPct"].attrs.val)/1e5),t}function St(n,t,a){var e={},s=d.get(n,"attrs")||{};Object.keys(s).forEach(function(c){switch(c){case"sz":e.size=parseInt(s[c])/100;break;case"b":e.bold=s[c]==="1";break;case"i":e.italic=s[c]==="1";break;case"u":e.underline=s[c];break;case"strike":e.strike=s[c];break;case"order":case"dirty":break;default:e[c]=s[c]}});var o=d.get(n,"a:solidFill");return o&&(e.color=U(o,t,a)),e}function lt(n,t,a,e,s){for(var o in t)switch(o){case"p:sp":for(var c=Array.isArray(t[o])?t[o]:[t[o]],h=0;h<c.length;h++){var u=c[h];n.push(new it(u,a,e,s))}break;case"p:pic":var m=Array.isArray(t[o])?t[o]:[t[o]];for(h=0;h<m.length;h++){var g=m[h],y=g["p:blipFill"]["a:blip"].attrs["r:embed"],x=e.rels[y].target,k=new bt(x,g,a,e);n.push(k)}break;case"p:cxnSp":var L=Array.isArray(t[o])?t[o]:[t[o]];for(h=0;h<L.length;h++)u=L[h],n.push(new it(u,a,e,s));break;case"p:graphicFrame":break;case"p:grpSp":var w=Array.isArray(t[o])?t[o]:[t[o]];for(h=0;h<w.length;h++){var v=w[h];n.push(new vt(v,a,e,s))}}}var he=function(){function n(t,a,e){this.slideType="slide",this.rels={},this.background={type:"none"},this.nodes=[],this.name=t,this.source=a,this.pptx=e}return Object.defineProperty(n.prototype,"index",{get:function(){if(!this.name)return 0;var t=this.name.match(/(\d+)/);return t?parseInt(t[0]):1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"slideMaster",{get:function(){return this.slideLayout&&this.slideLayout.slideMaster},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"theme",{get:function(){return this.slideMaster.theme},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_relsPath",{get:function(){return this.name.replace("slides/slide","slides/_rels/slide")+".rels"},enumerable:!1,configurable:!0}),n.prototype.load=function(){return O(this,void 0,void 0,function(){return F(this,function(t){switch(t.label){case 0:return[4,this._loadRels()];case 1:return t.sent(),this._loadBackground(),[4,this._loadNodes()];case 2:return t.sent(),[2]}})})},n.prototype._loadRels=function(){return O(this,void 0,void 0,function(){var t,a,e,s=this;return F(this,function(o){switch(o.label){case 0:return a=J,[4,this.pptx.getXmlByPath(this._relsPath)];case 1:return t=a.apply(void 0,[o.sent()]),e=d.get(t,["Relationships","Relationship"])||[],Array.isArray(e)||(e=[e]),e.forEach(function(c){switch(d.get(c,["attrs","Type"])){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout":var h=c.attrs.Target.replace("../","ppt/");s.slideLayout=s.pptx.getSlideLayout(h);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image":s.rels[c.attrs.Id]={type:c.attrs.Type.replace("http://schemas.openxmlformats.org/officeDocument/2006/relationships/",""),target:c.attrs.Target.replace("../","ppt/")}}}),[2]}})})},n.prototype._loadBackground=function(){var t=d.get(this.source,["p:sld","p:cSld","p:bg","p:bgPr"]);t&&t["a:solidFill"]?this.background=U(t["a:solidFill"],this.theme,this):t&&t["a:gradFill"]?this.background=nt(t["a:gradFill"],this.theme,this):t&&t["a:blipFill"]&&(this.background=rt(t["a:blipFill"],this.pptx,this))},n.prototype._loadNodes=function(){return O(this,void 0,void 0,function(){var t;return F(this,function(a){return t=d.get(this.source,["p:sld","p:cSld","p:spTree"]),lt(this.nodes,t,this.pptx,this),[2]})})},n.prototype.getColorThemeName=function(t){return this.slideLayout.getColorThemeName(t)},n.prototype.getNodeInheritAttrsByType=function(t,a){var e=this.slideLayout.getNodeByType(t),s=d.get(e.source,a);return s||this.slideLayout.getNodeInheritAttrsByType(t,a)},n.prototype.getNodeInheritAttrsByIdx=function(t,a){var e=this.slideLayout.getNodeByIdx(t),s=d.get(e.source,a);return s||this.slideLayout.getNodeInheritAttrsByIdx(t,a)},n}(),de=function(){function n(t,a,e){this.slideType="slideLayout",this.rels={},this.background={type:"none"},this.nodes=[],this.name=t,this.source=a,this.pptx=e}return Object.defineProperty(n.prototype,"_relsPath",{get:function(){return this.name.replace("slideLayouts/slideLayout","slideLayouts/_rels/slideLayout")+".rels"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"theme",{get:function(){return this.slideMaster.theme},enumerable:!1,configurable:!0}),n.prototype.load=function(){return O(this,void 0,void 0,function(){return F(this,function(t){switch(t.label){case 0:return[4,this._loadRels()];case 1:return t.sent(),[4,this._loadBackground()];case 2:return t.sent(),[4,this._loadNodes()];case 3:return t.sent(),[2]}})})},n.prototype._loadRels=function(){return O(this,void 0,void 0,function(){var t,a,e,s=this;return F(this,function(o){switch(o.label){case 0:return a=J,[4,this.pptx.getXmlByPath(this._relsPath)];case 1:return t=a.apply(void 0,[o.sent()]),e=d.get(t,["Relationships","Relationship"])||[],Array.isArray(e)||(e=[e]),e.forEach(function(c){switch(d.get(c,["attrs","Type"])){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster":var h=c.attrs.Target.replace("../","ppt/");s.slideMaster=s.pptx.getSlideMaster(h);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image":s.rels[c.attrs.Id]={type:c.attrs.Type.replace("http://schemas.openxmlformats.org/officeDocument/2006/relationships/",""),target:c.attrs.Target.replace("../","ppt/")}}}),[2]}})})},n.prototype._loadBackground=function(){return O(this,void 0,void 0,function(){var t;return F(this,function(a){return(t=d.get(this.source,["p:sldLayout","p:cSld","p:bg","p:bgPr"]))&&t["a:solidFill"]?this.background=U(t["a:solidFill"],this.theme):t&&t["a:gradFill"]?this.background=nt(t["a:gradFill"],this.theme,this):t&&t["a:blipFill"]&&(this.background=rt(t["a:blipFill"],this.pptx,this)),[2]})})},n.prototype._loadNodes=function(){return O(this,void 0,void 0,function(){var t;return F(this,function(a){return t=d.get(this.source,["p:sldLayout","p:cSld","p:spTree"]),lt(this.nodes,t,this.pptx,this),[2]})})},n.prototype.getColorThemeName=function(t){return this.slideMaster.getColorThemeName(t)},n.prototype.getNodeByType=function(t){return this.nodes.find(function(a){return a.type===t})},n.prototype.getNodeByIdx=function(t){return this.nodes.find(function(a){return a.idx===t})},n.prototype.getNodeInheritAttrsByType=function(t,a){var e=this.slideMaster.getNodeByType(t);return e&&d.get(e.source,a)},n.prototype.getNodeInheritAttrsByIdx=function(t,a){var e=this.slideMaster.getNodeByIdx(t);return e&&d.get(e.source,a)},n}(),ue=function(){function n(t,a,e){this.slideType="slideMaster",this.rels={},this.background={type:"none"},this.textStyles={titleStyle:{},bodyStyle:{},otherStyle:{}},this.defaultTextStyle={},this.nodes=[],this.name=t,this.source=a,this.pptx=e,this.load()}return Object.defineProperty(n.prototype,"_relsPath",{get:function(){return this.name.replace("slideMasters/slideMaster","slideMasters/_rels/slideMaster")+".rels"},enumerable:!1,configurable:!0}),n.prototype.load=function(){return O(this,void 0,void 0,function(){return F(this,function(t){switch(t.label){case 0:return[4,this._parseRels()];case 1:return t.sent(),this._parseColorMap(),this._parseBackground(),this._parseTextStyles(),this._parseDefaultTextStyle(),this._loadNodes(),[2]}})})},n.prototype._parseRels=function(){return O(this,void 0,void 0,function(){var t,a,e,s=this;return F(this,function(o){switch(o.label){case 0:return a=J,[4,this.pptx.getXmlByPath(this._relsPath)];case 1:return t=a.apply(void 0,[o.sent()]),e=d.get(t,["Relationships","Relationship"])||[],Array.isArray(e)||(e=[e]),e.forEach(function(c){switch(d.get(c,["attrs","Type"])){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme":var h=c.attrs.Target.replace("../","ppt/");s.theme=s.pptx.getTheme(h);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image":s.rels[c.attrs.Id]={type:c.attrs.Type.replace("http://schemas.openxmlformats.org/officeDocument/2006/relationships/",""),target:c.attrs.Target.replace("../","ppt/")}}}),[2]}})})},n.prototype._parseColorMap=function(){this.colorMap=d.omit(d.get(this.source,["p:sldMaster","p:clrMap","attrs"])||{},["order"])},n.prototype.getColorThemeName=function(t){return this.colorMap[t]||t},n.prototype._parseBackground=function(){var t=d.get(this.source,["p:sldMaster","p:cSld","p:bg","p:bgPr"]),a=d.get(this.source,["p:sldMaster","p:cSld","p:bg","p:bgRef"]);t&&t["a:solidFill"]?this.background=U(t["a:solidFill"],this.theme,this):t&&t["a:gradFill"]?this.background=nt(t["a:gradFill"],this.theme,this):t&&t["a:blipFill"]?this.background=rt(t["a:blipFill"],this.pptx,this):a&&(this.background=U(a,this.theme,this))},n.prototype._parseDefaultTextStyle=function(){var t=this,a=this.pptx.defaultTextStyleSource;Object.keys(a).forEach(function(e){if(e.startsWith("a:")&&e.endsWith("pPr")){var s=e.substr(2,e.length-5),o=d.get(a[e],["a:defRPr"]);t.defaultTextStyle[s]={props:Lt(a[e]),defRPr:St(o,t.theme,t)}}})},n.prototype._parseTextStyles=function(){var t=this,a=d.get(this.source,["p:sldMaster","p:txStyles"]);["titleStyle","bodyStyle","otherStyle"].forEach(function(e){var s=t.textStyles[e],o=d.get(a,"p:".concat(e))||{};Object.keys(o).forEach(function(c){if(c.startsWith("a:")&&c.endsWith("pPr")){var h=c.substr(2,c.length-5);s[h]={},s[h].props=Lt(o[c]);var u=d.get(o[c],["a:defRPr"]);s[h].defRPr=St(u,t.theme,t)}})})},n.prototype._loadNodes=function(){return O(this,void 0,void 0,function(){var t;return F(this,function(a){return t=d.get(this.source,["p:sldMaster","p:cSld","p:spTree"]),lt(this.nodes,t,this.pptx,this),[2]})})},n.prototype.getNodeByType=function(t){return this.nodes.find(function(a){return a.type===t})},n.prototype.getNodeByIdx=function(t){return this.nodes.find(function(a){return a.idx===t})},n.prototype.getNodeInheritAttrsByType=function(t,a){},n.prototype.getNodeInheritAttrsByIdx=function(t,a){},n}(),fe=function(){function n(t,a,e){this.clrScheme={},this.borderScheme=[],this.name=t,this.source=a,this.pptx=e,this._parseClrScheme(),this._parseLineStyleLst()}return n.prototype._parseClrScheme=function(){var t=d.get(this.source,["a:theme","a:themeElements","a:clrScheme"]);for(var a in t)if(a.startsWith("a:")){var e=a.substring(2),s=d.get(t[a],["a:sysClr","attrs","lastClr"])||d.get(t[a],["a:srgbClr","attrs","val"]);this.clrScheme[e]="#"+s}},n.prototype._parseLineStyleLst=function(){var t=this,a=d.get(this.source,["a:theme","a:themeElements","a:fmtScheme","a:lnStyleLst","a:ln"])||[];this.borderScheme=a.map(function(e){var s={color:{}};return d.get(e,["attrs","w"])&&(s.width=j(parseInt(d.get(e,["attrs","w"])))),d.get(e,["attrs","algn"])&&(s.algn=d.get(e,["attrs","algn"])),d.get(e,["attrs","cap"])&&(s.cap=d.get(e,["attrs","cap"])),d.get(e,["attrs","cmpd"])&&(s.cmpd=d.get(e,["attrs","cmpd"])),d.get(e,["a:miter","attrs","lim"])&&(s.miterLim=j(parseInt(d.get(e,["a:miter","attrs","lim"])))),d.get(e,["a:prstDash","attrs","val"])&&(s.type=d.get(e,["a:prstDash","attrs","val"])),d.get(e,["a:solidFill"])&&(s.color=U(d.get(e,["a:solidFill"]),t)),s})},n.prototype.getColor=function(t){if(t!=="phClr")return this.clrScheme[t]||this.defaultColor},n.prototype.getLineStyle=function(t){return this.borderScheme[t-1]},n}(),ye=function(){function n(){this.slides=[],this.slideLayouts=[],this.slideMaster=[],this.themes=[],this.medias={}}return n.prototype.load=function(t){return O(this,void 0,void 0,function(){var a,e;return F(this,function(s){switch(s.label){case 0:return a=new Gt,e=this,[4,a.loadAsync(t)];case 1:return e._zipContents=s.sent(),[4,this._loadThumbnail()];case 2:return s.sent(),[4,this._loadMedia()];case 3:return s.sent(),[4,this._loadPresentation()];case 4:return s.sent(),[4,this._loadContentTypes()];case 5:return s.sent(),[2]}})})},n.prototype._loadThumbnail=function(){return O(this,void 0,void 0,function(){var t,a;return F(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),this._zipContents.files["docProps/thumbnail.jpeg"]?[4,this._zipContents.files["docProps/thumbnail.jpeg"].async("base64")]:[3,2];case 1:t=e.sent(),this.thumbnail="data:image/jpeg;base64,"+t,e.label=2;case 2:return[3,4];case 3:return a=e.sent(),console.log("获取PPTX缩略图失败",a),[3,4];case 4:return[2]}})})},n.prototype._loadPresentation=function(){return O(this,void 0,void 0,function(){var t,a,e,s;return F(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this._zipContents.files["ppt/presentation.xml"].async("text")];case 1:return t=o.sent(),a=J(t),e=a["p:presentation"]["p:sldSz"].attrs,this.width=j(parseInt(e.cx)),this.height=j(parseInt(e.cy)),this.defaultTextStyleSource=d.get(a,["p:presentation","p:defaultTextStyle"]),[3,3];case 2:return s=o.sent(),console.log("获取PPTX尺寸失败",s),[3,3];case 3:return[2]}})})},n.prototype._loadContentTypes=function(){return O(this,void 0,void 0,function(){var t,a,e,s,o,c,h,u,m,g,y,x,k,L,w,v,l,r,i,p;return F(this,function(f){switch(f.label){case 0:return f.trys.push([0,20,,21]),a=J,[4,this._zipContents.files["[Content_Types].xml"].async("text")];case 1:if(t=a.apply(void 0,[f.sent()]),e=t.Types.Override,!(s=e.filter(function(b){return b.attrs.ContentType==="application/vnd.openxmlformats-officedocument.theme+xml"})))return[3,5];o=0,c=s,f.label=2;case 2:return o<c.length?(h=c[o],v=h.attrs.PartName.substr(1),u=J,[4,this._zipContents.files[v].async("text")]):[3,5];case 3:l=u.apply(void 0,[f.sent()]),this.themes.push(new fe(v,l,this)),f.label=4;case 4:return o++,[3,2];case 5:m=e.filter(function(b){return b.attrs.ContentType==="application/vnd.openxmlformats-officedocument.presentationml.slideMaster+xml"}),w=0,f.label=6;case 6:return w<m.length?(v=m[w].attrs.PartName.substr(1),g=J,[4,this._zipContents.files[v].async("text")]):[3,9];case 7:l=g.apply(void 0,[f.sent()]),this.slideMaster.push(new ue(v,l,this)),f.label=8;case 8:return w++,[3,6];case 9:y=e.filter(function(b){return b.attrs.ContentType==="application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml"}),w=0,f.label=10;case 10:return w<y.length?(v=y[w].attrs.PartName.substr(1),x=J,[4,this._zipContents.files[v].async("text")]):[3,14];case 11:return l=x.apply(void 0,[f.sent()]),[4,(k=new de(v,l,this)).load()];case 12:f.sent(),this.slideLayouts.push(k),f.label=13;case 13:return w++,[3,10];case 14:L=e.filter(function(b){return b.attrs.ContentType==="application/vnd.openxmlformats-officedocument.presentationml.slide+xml"}),w=0,f.label=15;case 15:return w<L.length?(v=L[w].attrs.PartName.substr(1),r=J,[4,this._zipContents.files[v].async("text")]):[3,19];case 16:return l=r.apply(void 0,[f.sent()]),[4,(i=new he(v,l,this)).load()];case 17:f.sent(),this.slides.push(i),f.label=18;case 18:return w++,[3,15];case 19:return this.slides.sort(function(b,P){return b.index-P.index}),[3,21];case 20:return p=f.sent(),console.log("Content Type获取失败",p),[3,21];case 21:return[2]}})})},n.prototype._loadMedia=function(){return O(this,void 0,void 0,function(){var t,a,e,s,o,c,h=this;return F(this,function(u){switch(u.label){case 0:t=Object.keys(this._zipContents.files).filter(function(g){return g.startsWith("ppt/media/image")}).map(function(g){return h._zipContents.files[g]}),a=0,e=t,u.label=1;case 1:return a<e.length?(s=e[a],o=function(g){var y;switch(g){case"jpg":case"jpeg":y="image/jpeg";break;case"png":y="image/png";break;case"gif":y="image/gif";break;case"emf":y="image/x-emf";break;case"wmf":y="image/x-wmf";break;default:y="image/*"}return y}((m=s.name).substr(2+(~-m.lastIndexOf(".")>>>0))),[4,s.async("base64")]):[3,4];case 2:c=u.sent(),this.medias[s.name]="data:".concat(o,";base64,").concat(c),u.label=3;case 3:return a++,[3,1];case 4:return[2]}var m})})},n.prototype.getXmlByPath=function(t){return O(this,void 0,void 0,function(){return F(this,function(a){switch(a.label){case 0:if(!this._zipContents.files[t])throw new Error("文件不存在");return[4,this._zipContents.files[t].async("text")];case 1:return[2,a.sent()]}})})},n.prototype.getSlideLayout=function(t){return this.slideLayouts.find(function(a){return a.name===t})},n.prototype.getSlideMaster=function(t){return this.slideMaster.find(function(a){return a.name===t})},n.prototype.getTheme=function(t){return this.themes.find(function(a){return a.name===t})},n.prototype.getMedia=function(t){return this.medias[t]},n}();function zt(n){var t,a,e,s,o=n.extend,c=n.offset,h=n.clip,u=n.base64,m=document.createElement("div");m.style.setProperty("position","absolute"),m.style.setProperty("left",c.x+"px"),m.style.setProperty("top",c.y+"px"),m.style.setProperty("width",o.w+"px"),m.style.setProperty("height",o.h+"px"),m.style.setProperty("overflow","hidden"),h?(t=o.w/(1-(h.l===void 0?0:h.l)-(h.r===void 0?0:h.r)),a=o.h/(1-(h.t===void 0?0:h.t)-(h.b===void 0?0:h.b)),e=-1*t*(h.l===void 0?0:h.l),s=-1*a*(h.t===void 0?0:h.t)):(t=o.w,a=o.h,e=0);var g=document.createElement("img");return g.src=u,g.width=t,g.height=a,g.style.setProperty("position","absolute"),g.style.setProperty("left",e+"px"),g.style.setProperty("top",s+"px"),m.append(g),m}function ge(n,t,a){var e,s=n.props,o=n.text,c=X(X({},t),s),h=document.createElement("span");h.textContent=o,c.size&&(!((e=a==null?void 0:a.normAutofit)===null||e===void 0)&&e.fontScale?h.style.fontSize=c.size*a.normAutofit.fontScale+"px":h.style.fontSize=c.size+"px");var u=Z(c.color);return u&&(h.style.color=u),c.typeface&&(h.style.fontFamily=c.typeface),c.bold&&(h.style.fontWeight="bold"),c.italic&&(h.style.fontStyle="italic"),c.underline&&(h.style.textDecoration="underline"),c.background&&(h.style.backgroundColor=Z(c.background)),h}function me(n,t,a){var e=document.createElement("span"),s=n.firstElementChild;switch(e.style.fontSize=s.style.fontSize,e.style.color=s.style.color,e.style.fontWeight=s.style.fontWeight,e.style.fontStyle=s.style.fontStyle,e.style.marginRight="10px",t.buAutoNum){case"arabicPeriod":default:e.textContent=a+".";break;case"circleNumDbPlain":e.textContent=["①","②","③","④","⑤","⑥","⑦","⑧","⑨","⑩","⑪","⑫","⑬","⑭","⑮","⑯","⑰","⑱","⑲","⑳"][a-1]||a+"";break;case"romanUcPeriod":e.textContent=function(o){var c=[{value:1e3,numeral:"M"},{value:900,numeral:"CM"},{value:500,numeral:"D"},{value:400,numeral:"CD"},{value:100,numeral:"C"},{value:90,numeral:"XC"},{value:50,numeral:"L"},{value:40,numeral:"XL"},{value:10,numeral:"X"},{value:9,numeral:"IX"},{value:5,numeral:"V"},{value:4,numeral:"IV"},{value:1,numeral:"I"}];if(typeof o!="number"||o<1||o>3999)throw new Error("Input must be a number between 1 and 3999.");for(var h="",u=0;u<c.length;u++)for(;o>=c[u].value;)h+=c[u].numeral,o-=c[u].value;return h}(a)+".";break;case"alphaUcPeriod":e.textContent=dt(a)+".";break;case"alphaLcPeriod":e.textContent=dt(a).toLowerCase()+".";break;case"alphaLcParenR":e.textContent=dt(a).toLowerCase()+")";break;case"ea1JpnChsDbPeriod":e.textContent=function(o){var c=["〇","一","二","三","四","五","六","七","八","九"];if(!Number.isInteger(o)||o<0)return"";for(var h="",u=o.toString(),m=0;m<u.length;m++)h+=c[parseInt(u[m],10)];return h}(a)+"."}n.prepend(e)}function Mt(n,t,a){var e,s,o,c;t===void 0&&(t=0),a===void 0&&(a={});var h=n.inheritProps,u=n.inheritRProps,m=n.props,g=n.rows,y=X(X({},h),m),x=document.createElement("div"),k=a.isFirst?0:y.spaceBefore||0,L=a.isLast?0:y.spaceAfter||0;x.style.margin="0px",x.style.padding="".concat(k,"px 0px ").concat(L,"px 0px");var w=document.createElement("p");w.style.margin="0px",w.style.padding="0px",w.style.wordBreak="break-word",w.style.textAlign=y.align&&{ctr:"center",l:"left",r:"right",dist:"justify"}[y.align]||"center",y.align==="dist"&&(w.style.textAlignLast="justify");var v=y.hasOwnProperty("lineHeight")?1.2*y.lineHeight:1.2;if(!((s=(e=a.bodyProps)===null||e===void 0?void 0:e.normAutofit)===null||s===void 0)&&s.lnSpcReduction&&(v*=1-((c=(o=a.bodyProps)===null||o===void 0?void 0:o.normAutofit)===null||c===void 0?void 0:c.lnSpcReduction)),w.style.lineHeight=v+"",g.length){for(var l=0,r=g;l<r.length;l++){var i=r[l];w.appendChild(ge(i,u,a.bodyProps))}y.buAutoNum?me(w,y,t):y.buChar&&function(f,b){var P=document.createElement("span"),S=f.firstElementChild;P.style.color=S.style.color,P.style.fontSize=S.style.fontSize,P.textContent={n:"■",l:"●",u:"◆",p:"□",ü:"✔",Ø:"➢","•":"•"}[b.buChar]||"■",P.style.marginRight="10px",f.prepend(P)}(w,y),w.style.paddingLeft=(y.marginLeft||0)+(y.indent||0)+"px"}else{var p=document.createElement("span");p.innerHTML="&nbsp;",p.style.fontSize=u.size+"px",w.appendChild(p)}return x.appendChild(w),x}var I="http://www.w3.org/2000/svg";function q(n,t){var a=0;switch(n){case"sm":a=1*t;break;case"med":a=1.5*t;break;case"lg":a=2.5*t}return Math.max(a,2)}function _t(n,t,a,e){e===void 0&&(e=!1);var s=n.border,o=s===void 0?{}:s,c=n.uuid,h=o.headEnd,u=o.width,m=o.color,g=o.tailEnd,y=e?h:g,x=y.len,k=x===void 0?"med":x,L=y.w,w=L===void 0?"med":L,v=q(k,u),l=q(w,u),r=document.createElementNS(I,"defs"),i=document.createElementNS(I,"marker"),p="marker-".concat(c,"-").concat(e?"start":"end");i.setAttribute("id",p),i.setAttribute("viewBox","0 0 ".concat(2*v," ").concat(2*l)),i.setAttribute("refX",v+"px"),i.setAttribute("refY",l+"px"),i.setAttribute("markerWidth",2*v+"px"),i.setAttribute("markerHeight",2*l+"px"),i.setAttribute("orient","auto"),i.setAttribute("markerUnits","userSpaceOnUse");var f=document.createElementNS(I,"ellipse");f.setAttribute("cx",v+"px"),f.setAttribute("cy",l+"px"),f.setAttribute("rx",v+"px"),f.setAttribute("ry",l+"px"),f.setAttribute("fill",Z(m)||"transparent"),i.appendChild(f),r.appendChild(i),t.appendChild(r),a.setAttribute(e?"marker-start":"marker-end","url(#".concat(p,")"))}function jt(n,t,a,e){e===void 0&&(e=!1);var s=n.border,o=s===void 0?{}:s,c=n.uuid,h=o.headEnd,u=o.width,m=o.color,g=o.tailEnd,y=e?h:g,x=y.len,k=x===void 0?"med":x,L=y.w,w=L===void 0?"med":L,v=q(k,u),l=q(w,u),r=document.createElementNS(I,"defs"),i=document.createElementNS(I,"marker"),p="marker-".concat(c,"-").concat(e?"start":"end");i.setAttribute("id",p),i.setAttribute("viewBox","0 0 ".concat(2*v," ").concat(2*l)),i.setAttribute("refX",(e?.9*v:1.1*v)+"px"),i.setAttribute("refY",l+"px"),i.setAttribute("markerWidth",2*v+"px"),i.setAttribute("markerHeight",2*l+"px"),i.setAttribute("orient","auto"),i.setAttribute("markerUnits","userSpaceOnUse");var f=document.createElementNS(I,"path"),b=e?["M ".concat(2*v,",0"),"L 0,".concat(l),"L ".concat(2*v,",").concat(2*l),"Z"].join(" "):["M 0,0","L ".concat(2*v,",").concat(l),"L 0,".concat(2*l),"Z"].join(" ");f.setAttribute("d",b),f.setAttribute("fill",Z(m)||"transparent"),i.appendChild(f),r.appendChild(i),t.appendChild(r),a.setAttribute(e?"marker-start":"marker-end","url(#".concat(p,")"))}function Ct(n,t,a,e){e===void 0&&(e=!1);var s=n.border,o=s===void 0?{}:s,c=n.uuid,h=o.headEnd,u=o.width,m=o.color,g=o.tailEnd,y=e?h:g,x=y.len,k=x===void 0?"med":x,L=y.w,w=L===void 0?"med":L,v=q(k,u),l=q(w,u),r=document.createElementNS(I,"defs"),i=document.createElementNS(I,"marker"),p="marker-".concat(c,"-").concat(e?"start":"end");i.setAttribute("id",p),i.setAttribute("viewBox","0 0 ".concat(2*v," ").concat(2*l)),i.setAttribute("refX",v+"px"),i.setAttribute("refY",l+"px"),i.setAttribute("markerWidth",2*v+"px"),i.setAttribute("markerHeight",2*l+"px"),i.setAttribute("orient","auto"),i.setAttribute("markerUnits","userSpaceOnUse");var f=document.createElementNS(I,"path"),b=["M 0,".concat(l),"L ".concat(v,",0"),"L ".concat(2*v,",").concat(l),"L ".concat(v,",").concat(2*l),"Z"].join(" ");f.setAttribute("d",b),f.setAttribute("fill",Z(m)||"transparent"),i.appendChild(f),r.appendChild(i),t.appendChild(r),a.setAttribute(e?"marker-start":"marker-end","url(#".concat(p,")"))}function Nt(n,t,a,e){e===void 0&&(e=!1);var s=n.border,o=s===void 0?{}:s,c=n.uuid,h=o.headEnd,u=o.width,m=o.color,g=o.tailEnd,y=e?h:g,x=y.len,k=x===void 0?"med":x,L=y.w,w=L===void 0?"med":L,v=q(k,u),l=q(w,u),r=document.createElementNS(I,"defs"),i=document.createElementNS(I,"marker"),p="marker-".concat(c,"-").concat(e?"start":"end");i.setAttribute("id",p),i.setAttribute("viewBox","0 0 ".concat(2*v+2*u," ").concat(2*l+2*u));var f=e?w==="lg"?2*u:3*u:w==="lg"?2*v:2*v-u;i.setAttribute("refX",f+"px"),i.setAttribute("refY",l+u+"px"),i.setAttribute("markerWidth",2*v+"px"),i.setAttribute("markerHeight",2*l+"px"),i.setAttribute("orient","auto"),i.setAttribute("markerUnits","userSpaceOnUse");var b=document.createElementNS(I,"path"),P=e?["M ".concat(2*v+u,", ").concat(u),"L ".concat(u,",").concat(l+u),"L ".concat(2*v+u,",").concat(2*l+u)].join(" "):["M ".concat(u,", ").concat(u),"L ".concat(2*v+u,",").concat(l+u),"L ".concat(u,",").concat(2*l+u)].join(" ");b.setAttribute("d",P),b.setAttribute("stroke-width",u+"px"),b.setAttribute("stroke",Z(m)||"transparent"),b.setAttribute("fill","transparent"),b.setAttribute("stroke-linecap","round"),b.setAttribute("stroke-linejoin","miter"),b.style.overflow="visible",i.appendChild(b),r.appendChild(i),t.appendChild(r),a.setAttribute(e?"marker-start":"marker-end","url(#".concat(p,")"))}function Et(n,t,a,e){e===void 0&&(e=!1);var s=n.border,o=s===void 0?{}:s,c=n.uuid,h=o.headEnd,u=o.width,m=o.color,g=o.tailEnd,y=e?h:g,x=y.len,k=x===void 0?"med":x,L=y.w,w=L===void 0?"med":L,v=q(k,u),l=q(w,u),r=document.createElementNS(I,"defs"),i=document.createElementNS(I,"marker"),p="marker-".concat(c,"-").concat(e?"start":"end");i.setAttribute("id",p),i.setAttribute("viewBox","0 0 ".concat(2*v," ").concat(2*l));var f=e?w==="sm"?1.5*u:2*u:w==="sm"?2*v-1.5*u:2*v-2*u;i.setAttribute("refX",f+"px"),i.setAttribute("refY",l+"px"),i.setAttribute("markerWidth",2*v+"px"),i.setAttribute("markerHeight",2*l+"px"),i.setAttribute("orient","auto"),i.setAttribute("markerUnits","userSpaceOnUse");var b=document.createElementNS(I,"path"),P=e?["M 0, ".concat(l),"L ".concat(2*v,",0"),"L ".concat(v,",").concat(l),"L ".concat(2*v,",").concat(2*l),"Z"].join(" "):["M 0,0","L ".concat(2*v,",").concat(l),"L 0,".concat(2*l),"L ".concat(v,",").concat(l),"Z"].join(" ");b.setAttribute("d",P),b.setAttribute("fill",Z(m)||"transparent"),b.style.overflow="visible",i.appendChild(b),r.appendChild(i),t.appendChild(r),a.setAttribute(e?"marker-start":"marker-end","url(#".concat(p,")"))}function et(n,t,a){var e=n.border,s=e===void 0?{}:e;n.extend;var o=s.headEnd,c=s.tailEnd;if(o&&o.type!=="none")switch(o.type){case"triangle":jt(n,t,a,!0);break;case"oval":_t(n,t,a,!0);break;case"diamond":Ct(n,t,a,!0);break;case"arrow":Nt(n,t,a,!0);break;case"stealth":Et(n,t,a,!0)}if(c&&c.type!=="none")switch(c.type){case"triangle":jt(n,t,a,!1);break;case"oval":_t(n,t,a,!1);break;case"diamond":Ct(n,t,a,!1);break;case"arrow":Nt(n,t,a,!1);break;case"stealth":Et(n,t,a,!1)}}var M="http://www.w3.org/2000/svg";function Y(n){var t=n.extend;return .16667*Math.min(t.w,t.h)}function K(n,t,a){a===void 0&&(a=0);var e=t.prstGeom,s=((e==null?void 0:e.gd)||[]).find(function(o){return o.name===n});return s?s.fmla:a}function _(n,t,a){a===void 0&&(a=0);var e=t.extend,s=t.prstGeom,o=((s==null?void 0:s.gd)||[]).find(function(c){return c.name===n});return o?Math.min(e.w,e.h)*o.fmla:a}function It(n,t,a){a===void 0&&(a=0);var e=t.extend,s=t.prstGeom,o=((s==null?void 0:s.gd)||[]).find(function(c){return c.name===n});return o?Math.max(e.w,e.h)*o.fmla:a}function Bt(n){var t=n.extend,a=document.createElementNS(M,"rect");return a.setAttribute("x","0"),a.setAttribute("y","0"),a.setAttribute("width",t.w+"px"),a.setAttribute("height",t.h+"px"),a}function tt(n,t,a,e,s){var o=n*Math.PI/180;return[o===0||o===2*Math.PI?t+e:o===Math.PI?t-e:o===Math.PI/2||o===3*Math.PI/2?t:o>0&&o<Math.PI/2||o>3*Math.PI/2&&o<2*Math.PI?t+Math.sqrt(1/(1/Math.pow(e,2)+Math.pow(Math.tan(o),2)/Math.pow(s,2))):t-Math.sqrt(1/(1/Math.pow(e,2)+Math.pow(Math.tan(o),2)/Math.pow(s,2))),o===0||o===2*Math.PI||o===Math.PI?a:o===Math.PI/2?a+s:o===3*Math.PI/2?a-s:o>Math.PI&&o<2*Math.PI?a-Math.sqrt(1/(1/Math.pow(s,2)+Math.pow(1/Math.tan(o),2)/Math.pow(e,2))):a+Math.sqrt(1/(1/Math.pow(s,2)+Math.pow(1/Math.tan(o),2)/Math.pow(e,2)))]}function yt(n,t){var a=0;return(t>n&&t-n>180||t<n&&n-t<180)&&(a=1),a}function gt(n){var t=n.extend,a=.146*t.w,e=.146*t.h;return{top:e,bottom:e,left:a,right:a,w:t.w-2*a,h:t.h-2*e}}function Zt(n){var t=n.extend,a=n.offset,e=n.border,s=n.background,o=n.rotate,c=n.flipH,h=n.flipV,u=document.createElement("div"),m=a.x,g=a.y;u.className="shape-wrapper shape-".concat(n.shape),u.style.setProperty("position","absolute"),u.style.setProperty("width",(t.w||1)+"px"),u.style.setProperty("height",(t.h||1)+"px"),u.style.setProperty("left",m+"px"),u.style.setProperty("top",g+"px");var y,x=document.createElementNS(M,"svg");x.style.setProperty("position","absolute"),x.setAttribute("width","100%"),x.setAttribute("height","100%"),x.style.setProperty("left","0"),x.style.setProperty("top","0"),x.style.overflow="visible";var k={left:0,top:0,right:0,bottom:0,w:t.w,h:t.h},L=!0;switch(n.shape){case"customGeom":y=function(l){var r=l.prstGeom,i=(r===void 0?{}:r).pathList,p=document.createElementNS(M,"path"),f={moveTo:"M",lnTo:"L",cubicBezTo:"C",close:"Z"},b=i.map(function(P){var S=f[P.type],A=Array.isArray(P.points)?P.points.map(function(C){return"".concat(C[0],",").concat(C[1])}).join(" "):"";return A?"".concat(S," ").concat(A):"".concat(S)}).join(" ");return p.setAttribute("d",b),p}(n),et(n,x,y);break;case"flowChartProcess":case"rect":y=Bt(n);break;case"snip1Rect":y=function(l){var r=l.extend,i=document.createElementNS(M,"polygon"),p=_("adj",l,Y(l)),f=["0,0","".concat(r.w-p,",0"),"".concat(r.w,",").concat(p),"".concat(r.w,",").concat(r.h),"0,".concat(r.h)].join(" ");return i.setAttribute("points",f),i}(n);break;case"snip2SameRect":y=function(l){var r=l.extend,i=document.createElementNS(M,"polygon"),p=_("adj1",l,Y(l)),f=_("adj2",l,0),b=[[p,0],[r.w-p,0],[r.w,p],[r.w,r.h-f],[r.w-f,r.h],[f,r.h],[0,r.h-f],[0,p]].map(function(P){return"".concat(P[0],",").concat(P[1])}).join(" ");return i.setAttribute("points",b),i}(n);break;case"snip2DiagRect":y=function(l){var r=l.extend,i=document.createElementNS(M,"polygon"),p=_("adj1",l,0),f=_("adj2",l,Y(l)),b=[[p,0],[r.w-f,0],[r.w,f],[r.w,r.h-p],[r.w-p,r.h],[f,r.h],[0,r.h-f],[0,p]].map(function(P){return"".concat(P[0],",").concat(P[1])}).join(" ");return i.setAttribute("points",b),i}(n);break;case"snipRoundRect":y=function(l){var r=l.extend,i=document.createElementNS(M,"path"),p=_("adj1",l,Y(l)),f=_("adj2",l,Y(l)),b=["M ".concat(p,",0"),"L ".concat(r.w-f,",0"),"L ".concat(r.w,",").concat(f),"L ".concat(r.w,",").concat(r.h),"L 0,".concat(r.h),"L 0,".concat(p),"Q 0,0 ".concat(p,",0"),"Z"].join(" ");return i.setAttribute("d",b),i}(n);break;case"roundRect":y=function(l){var r=Bt(l),i=_("adj",l,Y(l));return r.setAttribute("rx",i+"px"),r.setAttribute("ry",i+"px"),r}(n);break;case"round1Rect":y=function(l){var r=l.extend,i=document.createElementNS(M,"path"),p=_("adj",l,Y(l)),f=["M 0,0","L ".concat(r.w-p,",0"),"Q ".concat(r.w,",0 ").concat(r.w,",").concat(p),"L ".concat(r.w,",").concat(r.h),"L 0,".concat(r.h),"Z"].join(" ");return i.setAttribute("d",f),i}(n);break;case"round2SameRect":y=function(l){var r=l.extend,i=document.createElementNS(M,"path"),p=_("adj1",l,Y(l)),f=_("adj2",l,0),b=["M ".concat(p,",0"),"L ".concat(r.w-p,",0"),"Q ".concat(r.w,",0 ").concat(r.w,",").concat(p),"L ".concat(r.w,",").concat(r.h-f),"Q ".concat(r.w,",").concat(r.h," ").concat(r.w-f,",").concat(r.h),"L ".concat(f,",").concat(r.h),"Q 0,".concat(r.h," 0,").concat(r.h-f),"L 0,".concat(p),"Q 0,0 ".concat(p,",0"),"Z"].join(" ");return i.setAttribute("d",b),i}(n);break;case"round2DiagRect":y=function(l){var r=l.extend,i=document.createElementNS(M,"path"),p=_("adj1",l,Y(l)),f=_("adj2",l,0),b=["M ".concat(p,",0"),"L ".concat(r.w-f,",0"),"Q ".concat(r.w,",0 ").concat(r.w,",").concat(f),"L ".concat(r.w,",").concat(r.h-p),"Q ".concat(r.w,",").concat(r.h," ").concat(r.w-p,",").concat(r.h),"L ".concat(f,",").concat(r.h),"Q 0,".concat(r.h," 0,").concat(r.h-f),"L 0,".concat(p),"Q 0,0 ".concat(p,",0"),"Z"].join(" ");return i.setAttribute("d",b),i}(n);break;case"triangle":y=function(l){var r=l.extend,i=document.createElementNS(M,"polygon"),p=["".concat(r.w/2,",0"),"0,".concat(r.h),"".concat(r.w,",").concat(r.h)].join(" ");return i.setAttribute("points",p),i}(n);break;case"rtTriangle":y=function(l){var r=l.extend,i=document.createElementNS(M,"polygon"),p=["0,".concat(r.h),"0,0","".concat(r.w,",").concat(r.h)].join(" ");return i.setAttribute("points",p),i}(n);break;case"ellipse":y=function(l){var r=l.extend,i=document.createElementNS(M,"ellipse"),p=r.w/2,f=r.h/2,b=p,P=f;return i.setAttribute("cx",p+"px"),i.setAttribute("cy",f+"px"),i.setAttribute("rx",b+"px"),i.setAttribute("ry",P+"px"),i}(n);break;case"line":y=function(l){var r=l.extend,i=document.createElementNS(M,"path"),p=["M 0,0","L ".concat(r.w,",").concat(r.h)].join(" ");return i.setAttribute("d",p),i}(n),et(n,x,y),L=!1;break;case"straightConnector1":y=function(l){var r=l.extend,i=document.createElementNS(M,"path"),p=["M 0,0","L ".concat(r.w,",").concat(r.h)].join(" ");return i.setAttribute("d",p),i}(n),et(n,x,y),L=!1;break;case"bentConnector3":y=function(l){var r=l.extend,i=document.createElementNS(M,"path"),p=It("adj1",l,.5*Math.max(r.w,r.h)),f=["M 0,0","L ".concat(p,",0"),"L ".concat(p,",").concat(r.h),"L ".concat(r.w,",").concat(r.h)].join(" ");return i.setAttribute("d",f),i}(n),et(n,x,y),L=!1;break;case"curvedConnector3":y=function(l){var r=l.extend,i=document.createElementNS(M,"path"),p=It("adj1",l,.5*Math.max(r.w,r.h)),f=["M0,0","Q".concat(p,",0 ").concat(p,",").concat(r.h/2),"T".concat(r.w,",").concat(r.h)].join(" ");return i.setAttribute("d",f),i}(n),et(n,x,y),L=!1;break;case"parallelogram":y=function(l){var r=l.extend,i=document.createElementNS(M,"path"),p=_("adj",l,.5*Math.min(r.w,r.h)),f=["M".concat(p,",0"),"L".concat(r.w,",0"),"L".concat(r.w-p,",").concat(r.h),"L0,".concat(r.h),"Z"].join(" ");return i.setAttribute("d",f),i}(n),k=function(l){var r=l.extend,i=_("adj",l,.5*Math.min(r.w,r.h)),p=.84*(r.w-i),f=.08*r.h+i/r.w*r.h*.42;return{top:f,bottom:f,left:(r.w-p)/2,right:(r.w-p)/2,w:p,h:r.h-2*f}}(n);break;case"trapezoid":y=function(l){var r=l.extend,i=document.createElementNS(M,"path"),p=_("adj",l,.25*Math.min(r.w,r.h)),f=["M".concat(p,",0"),"L".concat(r.w-p,",0"),"L".concat(r.w,",").concat(r.h),"L0,".concat(r.h),"Z"].join(" ");return i.setAttribute("d",f),i}(n),k=function(l){var r=l.extend,i=_("adj",l,.5*Math.min(r.w,r.h)),p=i/r.w*.66*r.h,f=.66*i;return{top:p,bottom:0,left:f,right:f,w:r.w-2*f,h:r.h-p}}(n);break;case"diamond":y=function(l){var r=l.extend,i=document.createElementNS(M,"path"),p=["M".concat(r.w/2,",0"),"L".concat(r.w,",").concat(r.h/2),"L".concat(r.w/2,",").concat(r.h),"L0,".concat(r.h/2),"Z"].join(" ");return i.setAttribute("d",p),i}(n),k=function(l){var r=l.extend,i=.25*r.h,p=.25*r.w;return{top:i,bottom:i,left:p,right:p,w:.5*r.w,h:.5*r.h}}(n);break;case"pentagon":y=function(l){var r=l.extend,i=document.createElementNS(M,"path"),p=["M".concat(r.w/2,",0"),"L".concat(r.w,",").concat(.3771*r.h),"L".concat(.808*r.w,",").concat(r.h),"L".concat(.192*r.w,",").concat(r.h),"L0,".concat(.3771*r.h),"Z"].join(" ");return i.setAttribute("d",p),i}(n),k=function(l){var r=l.extend,i=.227*r.h,p=.192*r.w;return{top:i,bottom:0,left:p,right:p,w:.616*r.w,h:.773*r.h}}(n);break;case"hexagon":y=function(l){var r=l.extend,i=document.createElementNS(M,"path"),p=_("adj",l,.25*Math.min(r.w,r.h)),f=["M".concat(p,",0"),"L".concat(r.w-p,",0"),"L".concat(r.w,",").concat(r.h/2),"L".concat(r.w-p,",").concat(r.h),"L".concat(p,",").concat(r.h),"L0,".concat(r.h/2),"Z"].join(" ");return i.setAttribute("d",f),i}(n),k=function(l){var r=l.extend,i=_("adj",l,.25*Math.min(r.w,r.h)),p=.098*r.h+i/r.w*.38*r.h,f=.088*r.w+.422*i;return{top:p,bottom:p,left:f,right:f,w:r.w-2*f,h:r.h-2*p}}(n);break;case"heptagon":y=function(l){var r=l.extend,i=document.createElementNS(M,"path"),p=["M".concat(r.w/2,",0"),"L".concat(.9*r.w,",").concat(.2*r.h),"L".concat(r.w,",").concat(.642*r.h),"L".concat(.722*r.w,",").concat(r.h),"L".concat(.278*r.w,",").concat(r.h),"L0,".concat(.642*r.h),"L".concat(.1*r.w,",").concat(.2*r.h),"Z"].join(" ");return i.setAttribute("d",p),i}(n),k=function(l){var r=l.extend;return{top:.2*r.h,bottom:.2*r.h,left:.1*r.w,right:.1*r.w,w:.8*r.w,h:.6*r.h}}(n);break;case"octagon":y=function(l){var r=l.extend,i=document.createElementNS(M,"path"),p=_("adj",l,.29*Math.min(r.w,r.h)),f=["M".concat(p,",0"),"L".concat(r.w-p,",0"),"L".concat(r.w,",").concat(p),"L".concat(r.w,",").concat(r.h-p),"L".concat(r.w-p,",").concat(r.h),"L".concat(p,",").concat(r.h),"L0,".concat(r.h-p),"L0,".concat(p),"Z"].join(" ");return i.setAttribute("d",f),i}(n),k=function(l){var r=l.extend,i=_("adj",l,.29*Math.min(r.w,r.h));return{top:.5*i,bottom:.5*i,left:.5*i,right:.5*i,w:r.w-i,h:r.h-i}}(n);break;case"decagon":y=function(l){var r=l.extend,i=document.createElementNS(M,"path"),p=.344,f=.117,b=.19,P=["M".concat(r.w*p,",0"),"L".concat(.656*r.w,",0"),"L".concat(.883*r.w,",").concat(r.h*b),"L".concat(r.w,",").concat(.5*r.h),"L".concat(.883*r.w,",").concat(.81*r.h),"L".concat(.656*r.w,",").concat(r.h),"L".concat(r.w*p,",").concat(r.h),"L".concat(r.w*f,",").concat(.81*r.h),"L0,".concat(.5*r.h),"L".concat(r.w*f,",").concat(r.h*b),"Z"].join(" ");return i.setAttribute("d",P),i}(n),k=function(l){var r=l.extend,i=.117,p=.19;return{top:r.h*p,bottom:r.h*p,left:r.w*i,right:r.w*i,w:.766*r.w,h:.62*r.h}}(n);break;case"dodecagon":y=function(l){var r=l.extend,i=document.createElementNS(M,"path"),p=.364,f=.133,b=.135,P=["M".concat(r.w*p,",0"),"L".concat(.636*r.w,",0"),"L".concat(.867*r.w,",").concat(r.h*b),"L".concat(r.w,",").concat(r.h*p),"L".concat(r.w,",").concat(.636*r.h),"L".concat(.867*r.w,",").concat(.865*r.h),"L".concat(.636*r.w,",").concat(r.h),"L".concat(r.w*p,",").concat(r.h),"L".concat(r.w*f,",").concat(.865*r.h),"L0,".concat(.636*r.h),"L0,".concat(r.h*p),"L".concat(r.w*f,",").concat(r.h*b),"Z"].join(" ");return i.setAttribute("d",P),i}(n),k=function(l){var r=l.extend,i=.133,p=.135;return{top:r.h*p,bottom:r.h*p,left:r.w*i,right:r.w*i,w:.734*r.w,h:.73*r.h}}(n);break;case"pie":y=function(l){var r=l.extend,i=document.createElementNS(M,"path"),p=K("adj1",l,360),f=K("adj2",l,270),b=r.w/2,P=r.h/2,S=r.w/2,A=r.h/2,C=tt(p,S,A,b,P),N=C[0],E=C[1],D=tt(f,S,A,b,P),W=D[0],H=D[1],B=yt(p,f),z="M".concat(S,",").concat(A,", L").concat(N," ").concat(E," A ").concat(b," ").concat(P," 0 ").concat(B," ").concat(1," ").concat(W," ").concat(H," Z");return i.setAttribute("d",z),i}(n),k=gt(n);break;case"chord":y=function(l){var r=l.extend,i=document.createElementNS(M,"path"),p=K("adj1",l,45),f=K("adj2",l,270),b=r.w/2,P=r.h/2,S=r.w/2,A=r.h/2,C=tt(p,S,A,b,P),N=C[0],E=C[1],D=tt(f,S,A,b,P),W=D[0],H=D[1],B=yt(p,f),z="M".concat(N," ").concat(E," A ").concat(b," ").concat(P," 0 ").concat(B," ").concat(1," ").concat(W," ").concat(H," Z");return i.setAttribute("d",z),i}(n),k=gt(n);break;case"teardrop":y=function(l){var r=l.extend,i=document.createElementNS(M,"path"),p=K("adj",l,1),f=r.w/2,b=r.h/2,P=r.w/2,S=r.h/2,A=tt(0,P,S,f,b),C=A[0],N=A[1],E=tt(270,P,S,f,b),D=E[0],W=E[1],H=yt(0,270),B="M".concat(C," ").concat(N," A ").concat(f," ").concat(b," 0 ").concat(H," ").concat(1," ").concat(D," ").concat(W),z=f*p,V=P+z,T=S-b*z/(r.w/2),G=(r.w/2+V)/2,Q=(r.h/2+T)/2;return B+=" Q".concat(G,",0 ").concat(V,",").concat(T),B+=" Q".concat(r.w,",").concat(Q," ").concat(P+f,",").concat(S),i.setAttribute("d",B),i}(n),k=gt(n);break;case"frame":y=function(l){var r=l.extend,i=document.createElementNS(M,"path"),p=_("adj1",l,.12*Math.min(r.w,r.h)),f=["M0,0","L".concat(r.w,",0"),"L".concat(r.w,",").concat(r.h),"L0,".concat(r.h),"Z","M".concat(p,",").concat(p),"L".concat(p,",").concat(r.h-p),"L".concat(r.w-p,",").concat(r.h-p),"L".concat(r.w-p,",").concat(p),"Z"].join(" ");return i.setAttribute("d",f),i}(n),k=function(l){var r=l.extend,i=_("adj1",l,.12*Math.min(r.w,r.h));return{top:i,bottom:i,left:i,right:i,w:r.w-2*i,h:r.h-2*i}}(n);break;case"halfFrame":y=function(l){var r=l.extend,i=document.createElementNS(M,"path"),p=_("adj1",l,.333*Math.min(r.w,r.h)),f=Math.min(_("adj2",l,.333*Math.min(r.w,r.h)),r.w*(1-p/r.h)),b=["M0,0","L".concat(r.w,",0"),"L".concat(r.w*(1-p/r.h),",").concat(p),"L".concat(f,",").concat(p),"L".concat(f,",").concat(r.h*(1-f/r.w)),"L0,".concat(r.h),"Z"].join(" ");return i.setAttribute("d",b),i}(n);break;case"corner":y=function(l){var r=l.extend,i=document.createElementNS(M,"path"),p=_("adj1",l,.5*Math.min(r.w,r.h)),f=_("adj2",l,.5*Math.min(r.w,r.h)),b=["M0,0","L".concat(f,",0"),"L".concat(f,",").concat(r.h-p),"L".concat(r.w,",").concat(r.h-p),"L".concat(r.w,",").concat(r.h),"L0,".concat(r.h),"Z"].join(" ");return i.setAttribute("d",b),i}(n),k=function(l){var r=l.extend,i=_("adj1",l,.5*Math.min(r.w,r.h));return{top:r.h-i,bottom:0,left:0,right:0,w:r.w,h:i}}(n);break;case"diagStripe":y=function(l){var r=l.extend,i=document.createElementNS(M,"path"),p=_("adj",l,.5*Math.min(r.w,r.h)),f=r.w*p/r.h,b=["M".concat(f,",0"),"L".concat(r.w,",0"),"L0,".concat(r.h),"L0,".concat(p),"Z"].join(" ");return i.setAttribute("d",b),i}(n),k=function(l){var r=l.extend,i=K("adj",l,.5),p=.5*(1-i)*r.h,f=.5*(1-i)*r.w;return{top:0,bottom:p,left:0,right:f,w:r.w-f,h:r.h-p}}(n);break;case"plus":y=function(l){var r=l.extend,i=document.createElementNS(M,"path"),p=_("adj",l,.25*Math.min(r.w,r.h)),f=["M".concat(p,",0"),"L".concat(r.w-p,",0"),"L".concat(r.w-p,",").concat(p),"L".concat(r.w,",").concat(p),"L".concat(r.w,",").concat(r.h-p),"L".concat(r.w-p,",").concat(r.h-p),"L".concat(r.w-p,",").concat(r.h),"L".concat(p,",").concat(r.h),"L".concat(p,",").concat(r.h-p),"L0,".concat(r.h-p),"L0,".concat(p),"L".concat(p,",").concat(p),"Z"].join(" ");return i.setAttribute("d",f),i}(n),k=function(l){var r=l.extend,i=_("adj",l,.25*Math.min(r.w,r.h));return{top:i,bottom:i,left:0,right:0,w:r.w,h:r.h-2*i}}(n);break;case"plaque":y=function(l){var r=l.extend,i=document.createElementNS(M,"path"),p=_("adj",l,.16667*Math.min(r.w,r.h)),f=["M".concat(p,",0"),"L".concat(r.w-p,",0"),"Q".concat(r.w-p,",").concat(p," ").concat(r.w,",").concat(p),"L".concat(r.w,",").concat(r.h-p),"Q".concat(r.w-p,",").concat(r.h-p," ").concat(r.w-p,",").concat(r.h),"L".concat(p,",").concat(r.h),"Q".concat(p,",").concat(r.h-p," 0,").concat(r.h-p),"L0,".concat(p),"Q".concat(p,",").concat(p," ").concat(p,",0"),"Z"].join(" ");return i.setAttribute("d",f),i}(n),k=function(l){var r=l.extend,i=_("adj",l,.16667*Math.min(r.w,r.h));return{top:.72*i,bottom:.72*i,left:.72*i,right:.72*i,w:r.w-1.44*i,h:r.w-1.44*i}}(n)}y&&(L?(s==null?void 0:s.type)==="blipFill"?function(l,r,i){var p=l.background,f=p===void 0?{}:p,b=l.extend,P=f.base64,S=f.alpha,A=f.fillRect,C=A===void 0?{}:A,N=C.b,E=N===void 0?0:N,D=C.t,W=D===void 0?0:D,H=C.l,B=H===void 0?0:H,z=C.r,V=z===void 0?0:z,T=document.createElementNS(I,"defs"),G=document.createElementNS(I,"pattern");G.setAttribute("id","background_"+l.uuid),G.setAttribute("patternUnits","userSpaceOnUse"),G.setAttribute("width",b.w+""),G.setAttribute("height",b.h+"");var Q=document.createElementNS(I,"image");Q.setAttribute("href",P),Q.setAttribute("preserveAspectRatio","none");var Wt=b.w*B,Ht=b.h*W,Vt=b.w*(1-B-V),Xt=b.h*(1-W-E);Q.setAttribute("width",Vt+""),Q.setAttribute("height",Xt+""),Q.setAttribute("x",Wt+""),Q.setAttribute("y",Ht+""),typeof S=="number"&&Q.setAttribute("opacity",S+""),G.appendChild(Q),T.appendChild(G),r.appendChild(T),i.setAttribute("fill","url(#background_".concat(l.uuid,")"))}(n,x,y):(s==null?void 0:s.type)==="gradFill"?function(l,r,i){var p=l.background,f=p===void 0?{}:p;l.extend;var b=f.gsList,P=f.lin,S=f.path,A=f.tileRect,C=A===void 0?{}:A,N=document.createElementNS(I,"defs"),E=document.createElementNS(I,S==="circle"?"radialGradient":"linearGradient");E.setAttribute("id","background_grad_fill_"+l.uuid);var D=b||[];if(D.sort(function(V,T){return V.pos-T.pos}),D.forEach(function(V){var T=document.createElementNS(I,"stop");T.setAttribute("offset","".concat(100*V.pos,"%")),T.setAttribute("stop-color",Z(V.color)),E.appendChild(T)}),S==="circle"){var W=C.r,H=C.l,B=C.t,z=C.b;W===-1?E.setAttribute("cx","100%"):H===-1&&E.setAttribute("cx","0%"),B===-1?E.setAttribute("cy","0%"):z===-1&&E.setAttribute("cy","100%")}else P!=null&&P.ang&&E.setAttribute("gradientTransform","rotate(".concat(P.ang,")"));N.appendChild(E),r.appendChild(N),i.setAttribute("fill","url(#background_grad_fill_".concat(l.uuid,")"))}(n,x,y):y.setAttribute("fill",Z(s)||"transparent"):y.setAttribute("fill","transparent"),e.width?(y.setAttribute("stroke-width",e.width+"px"),y.setAttribute("stroke",Z(e.color)||"transparent")):y.setAttribute("stroke-width","0"),y.setAttribute("stroke-dasharray",function(l){return l&&l.type!=="solid"?({sysDot:[1,1],sysDash:[3,1],dash:[4,3],dashDot:[4,3,1,3],lgDash:[8,3],lgDashDot:[8,3,1,3],lgDashDotDot:[8,3,1,3,1,3]}[l.type]||[]).map(function(r){return r*l.width}).join(","):""}(e)),y.setAttribute("stroke-linecap",e.cap&&{sq:"square",rnd:"round",flat:"butt"}[e.cap]||"square"),y.setAttribute("stroke-linejoin",e.lineJoin||"round"),e.lineJoin==="miter"&&y.setAttribute("stroke-miterlimit",e.miterLim+""),x.appendChild(y));var w=[];c&&w.push("scaleX(-1)"),h&&w.push("scaleY(-1)"),x.style.setProperty("transform",w.join(" ")),u.appendChild(x);var v=function(l,r,i){var p;i===void 0&&(i=!1);var f=l.inheritProps,b=l.props,P=l.paragraphs;if(!P||P.length===0)return null;var S=X(X({},f),b),A=document.createElement("div");switch(A.className="text-wrapper",A.style.boxSizing="border-box",A.style.position="absolute",A.style.left=r.left+"px",S.vert==="eaVert"?(A.style.writingMode="vertical-rl",A.style.height=r.h+"px"):A.style.width=r.w+"px",S.anchor){case"b":A.style.bottom=r.bottom+"px";break;case"t":A.style.top=r.top+"px";break;case"ctr":A.style.top=r.top+r.h/2+"px",A.style.transform="translateY(-50%)";break;default:i?A.style.top=r.top+"px":(A.style.top=r.top+r.h/2+"px",A.style.transform="translateY(-50%)")}var C=[S.hasOwnProperty("tIns")?S.tIns+"px":"3px",S.hasOwnProperty("rIns")?S.rIns+"px":"6px",S.hasOwnProperty("bIns")?S.bIns+"px":"3px",S.hasOwnProperty("lIns")?S.lIns+"px":"6px"];A.style.padding=C.join(" ");for(var N={},E=0,D=function(B){var z=X(X({},B.inheritProps),B.props),V=void 0;if(z.buAutoNum){var T=z.level?+z.level:0;N[T]||(N[T]=0),!((p=B.rows)===null||p===void 0)&&p.length&&N[T]++,Object.keys(N).forEach(function(G){+G>T&&(N[G]=0)}),V=Mt(B,N[T],{isFirst:E===0,isLast:P.length-1===E,bodyProps:S})}else V=Mt(B,0,{isFirst:E===0,isLast:P.length-1===E,bodyProps:S});A.appendChild(V),E++},W=0,H=P;W<H.length;W++)D(H[W]);return A}(n.textBody,k,n.isTextBox);return v&&u.appendChild(v),o&&u.style.setProperty("transform","rotate(".concat(o,"deg)")),u}function Ut(n){var t=document.createElement("div"),a=n.extend;n.chExtend;var e=n.offset,s=n.chOffset,o=n.flipV,c=n.flipH,h=n.rotate,u=e.x,m=e.y,g=a.w,y=a.h;t.className="group",t.style.position="absolute",t.style.left=u+"px",t.style.top=m+"px",t.style.width=g+"px",t.style.height=y+"px";var x=[];c&&x.push("scaleX(-1)"),o&&x.push("scaleY(-1)"),h&&x.push("rotate(".concat(h,"deg)")),t.style.transformOrigin="center center",t.style.transform=x.join(" ");for(var k=0;k<n.nodes.length;k++){var L=n.nodes[k],w=void 0;L instanceof bt?w=zt(L):L instanceof it?w=Zt(L):L instanceof vt&&(w=Ut(L)),w.style.left=parseInt(w.style.left)-s.x+"px",w.style.top=parseInt(w.style.top)-s.y+"px",t.appendChild(w)}return t}var be=function(){function n(t,a,e){this.scale=1,this.wrapper=t,this.pptx=a,this.options=e,this._calcScaleAndRenderPort()}return n.prototype._calcScaleAndRenderPort=function(){var t=this.options.viewPort.width/this.pptx.width,a=this.options.viewPort.height/this.pptx.height;if(this.scale=Math.min(t,a),t<a){var e=this.options.viewPort.width,s=this.pptx.height*this.scale;this.renderPort={width:e,height:s,left:0,top:(this.options.viewPort.height-s)/2}}else e=this.pptx.width*this.scale,s=this.options.viewPort.height,this.renderPort={width:e,height:s,left:(this.options.viewPort.width-e)/2,top:0}},n.prototype.renderSlide=function(t){var a=this.pptx.slides[t],e=document.createElement("div");e.classList.add("pptx-preview-slide-wrapper"),e.style.setProperty("width",this.renderPort.width+"px"),e.style.setProperty("height",this.renderPort.height+"px"),e.style.setProperty("position","relative"),e.style.margin="0 auto 10px",e.style.setProperty("background","#fff"),e.style.setProperty("overflow","hidden"),this._renderBackground(a,e),this._renderSlideMaster(a.slideMaster,e),this._renderSlideLayout(a.slideLayout,e),this._renderSlide(a,e),this.wrapper.append(e)},n.prototype._renderSlideMaster=function(t,a){var e=document.createElement("div");e.classList.add("slide-master-wrapper"),e.style.setProperty("position","absolute"),e.style.setProperty("left","0"),e.style.setProperty("top","0"),e.style.setProperty("width",this.pptx.width+"px"),e.style.setProperty("height",this.pptx.height+"px"),e.style.setProperty("transform","scale(".concat(this.scale,")")),e.style.setProperty("transform-origin","0 0");var s=pt([],t.nodes,!0).filter(function(h){return h.userDrawn});s.sort(function(h,u){return h.order>u.order?1:-1});for(var o=0;o<s.length;o++){var c=this._renderNode(s[o]);c&&e.append(c)}a.append(e)},n.prototype._renderSlideLayout=function(t,a){var e=document.createElement("div");e.classList.add("slide-layout-wrapper"),e.style.setProperty("position","absolute"),e.style.setProperty("left","0"),e.style.setProperty("top","0"),e.style.setProperty("width",this.pptx.width+"px"),e.style.setProperty("height",this.pptx.height+"px"),e.style.setProperty("transform","scale(".concat(this.scale,")")),e.style.setProperty("transform-origin","0 0");var s=pt([],t.nodes,!0).filter(function(h){return h.userDrawn});s.sort(function(h,u){return h.order>u.order?1:-1});for(var o=0;o<s.length;o++){var c=this._renderNode(s[o]);c&&e.append(c)}a.append(e)},n.prototype._renderSlide=function(t,a){var e=document.createElement("div");e.classList.add("slide-wrapper"),e.style.setProperty("position","absolute"),e.style.setProperty("left","0"),e.style.setProperty("top","0"),e.style.setProperty("width",this.pptx.width+"px"),e.style.setProperty("height",this.pptx.height+"px"),e.style.setProperty("transform","scale(".concat(this.scale,")")),e.style.setProperty("transform-origin","0 0");var s=pt([],t.nodes,!0);s.sort(function(h,u){return h.order>u.order?1:-1});for(var o=0;o<s.length;o++){var c=this._renderNode(s[o]);c&&e.append(c)}a.append(e)},n.prototype._renderNode=function(t){return t instanceof bt?zt(t):t instanceof it?Zt(t):t instanceof vt?Ut(t):void 0},n.prototype._renderBackground=function(t,a){var e,s=document.createElement("div");s.classList.add("slide-background"),s.style.setProperty("position","absolute"),s.style.setProperty("left","0"),s.style.setProperty("top","0"),s.style.setProperty("width","100%"),s.style.setProperty("height","100%");var o=t.background;if(o.type==="none"&&(o=t.slideLayout.background),o.type==="none"&&(o=t.slideMaster.background),o.type==="blipFill"){var c=o,h=c.base64,u=c.alpha,m=c.fillRect,g=m===void 0?{}:m,y=g.b,x=y===void 0?0:y,k=g.t,L=k===void 0?0:k,w=g.l,v=w===void 0?0:w,l=g.r,r=l===void 0?0:l,i=this.renderPort.width*v,p=this.renderPort.height*L,f=this.renderPort.width*(1-v-r),b=this.renderPort.height*(1-L-x);s.style.backgroundImage="url(".concat(h,")"),s.style.backgroundSize="".concat(f," ").concat(b),s.style.backgroundPosition="".concat(i,"px ").concat(p,"px"),u&&(s.style.opacity=u+""),s.style.backgroundRepeat="no-repeat"}else if(o.type==="solidFill"){var P=Z(t.background)||Z(t.slideLayout.background)||Z(t.slideMaster.background);P?s.style.setProperty("background",P):s.style.setProperty("background","#fff")}else if(o.type==="gradFill")if(o.path==="circle"){var S=o.tileRect||{},A=(x=S.b,L=S.t,v=S.l,"radial-gradient(circle at ");(r=S.r)===-1?A+=" right":v===-1&&(A+=" left"),L===-1?A+=" top":x===-1&&(A+=" bottom"),x||L||v||r||(A+=" center"),A+=",",A+=o.gsList.map(function(N){return"".concat(Z(N.color)," ").concat(100*N.pos+"%")}).join(","),s.style.setProperty("background",A)}else{var C=((e=o==null?void 0:o.lin)===null||e===void 0?void 0:e.ang)||0;A="linear-gradient(".concat(C+90,"deg,"),A+=o.gsList.map(function(N){return"".concat(Z(N.color)," ").concat(100*N.pos+"%")}).join(","),s.style.setProperty("background",A)}a.append(s)},n}(),ve=function(){function n(t,a){this.dom=t,this.options=a,this._renderWrapper()}return n.prototype._renderWrapper=function(){var t=document.createElement("div");t.classList.add("pptx-preview-wrapper"),t.style.setProperty("background","#000"),t.style.setProperty("width",this.options.width+"px"),this.options.height&&t.style.setProperty("height",this.options.height+"px"),t.style.setProperty("position","relative"),this.options.height&&t.style.setProperty("overflow-y","auto"),this.dom.append(t),this.wrapper=t},n.prototype.preview=function(t){var a=this;return new Promise(function(e,s){a.wrapper.innerHTML="";var o=new ye;o.load(t).then(function(){console.log("pptx 实例",o),console.log("slide1",o.slides[0]);var c=new be(a.wrapper,o,{viewPort:{width:a.options.width,height:a.options.height}});console.log("htmlRender",c);for(var h=0;h<o.slides.length;h++)c.renderSlide(h)})})},n}();function xe(n,t){return new ve(n,t)}const we=Qt({name:"VueOfficePptx",props:{src:[String,ArrayBuffer,Blob],requestOptions:{type:Object,default:()=>({})},options:{type:Object,default:()=>({})}},emits:["rendered","error"],setup(n,{emit:t}){let a=null;const e=Tt(null);function s(){let h=e.value,u=n.options.width||h.getBoundingClientRect().width||960,m=n.options.height||h.getBoundingClientRect().height||540;a=xe(h,{width:u,height:m})}function o(h){if(typeof h=="string")return fetch(h,n.requestOptions).then(u=>u.arrayBuffer());if(h instanceof ArrayBuffer)return Promise.resolve(h)}function c(){n.src&&o(n.src).then(h=>{a.preview(h),t("rendered")}).catch(h=>{t("error",h)})}return Yt(()=>{s(),c()}),Jt(()=>n.src,()=>{c()}),{rootRef:e}}}),Pe={class:"vue-office-pptx"},ke={class:"vue-office-pptx-main",ref:"rootRef"};function Ae(n,t,a,e,s,o){return Rt(),$t("div",Pe,[Kt("div",ke,null,512)])}const st=qt(we,[["render",Ae]]);st.install=function(n){n.component(st.name,st)};const Ce={__name:"PptxDemo",setup(n){function t(){xt.hideLoading()}function a(c){console.log("出差",c),xt.hideLoading()}const e=location.origin+(location.pathname+"/").replace("//","/")+"static/test-files/test.pptx",s=Tt(),o={headers:{}};return(c,h)=>(Rt(),te(ae,{accept:".pptx",placeholder:"请输入pptx文件地址","default-src":e},{default:ee(u=>[re(ne(st),{ref_key:"docxRef",ref:s,src:u.src,style:{flex:"1",height:"0"},"request-options":o,onRendered:t,onError:a},null,8,["src"])]),_:1}))}};export{Ce as default};
