import{o as Be}from"./jszip.min-c9c3a9f3.js";import{l as f}from"./lodash-c4fa4559.js";import{d as Oe,_ as Ee,r as ke,o as Ne,w as Fe,a as Pe,c as Ze,b as Se,e as De,f as ze,g as He,u as ue}from"./index-7ca3d7eb.js";import{P as Ue,u as fe}from"./PreviewWrapper-fde664c8.js";import"./_commonjs-dynamic-modules-302442b1.js";var he=function(o,n){return he=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(i[s]=a[s])},he(o,n)};function Mt(o,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");he(o,n);function i(){this.constructor=o}o.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}var S=function(){return S=Object.assign||function(n){for(var i,a=1,s=arguments.length;a<s;a++){i=arguments[a];for(var h in i)Object.prototype.hasOwnProperty.call(i,h)&&(n[h]=i[h])}return n},S.apply(this,arguments)};function q(o,n,i,a){function s(h){return h instanceof i?h:new i(function(d){d(h)})}return new(i||(i=Promise))(function(h,d){function u(y){try{b(a.next(y))}catch(g){d(g)}}function w(y){try{b(a.throw(y))}catch(g){d(g)}}function b(y){y.done?h(y.value):s(y.value).then(u,w)}b((a=a.apply(o,n||[])).next())})}function Y(o,n){var i={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},a,s,h,d=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return d.next=u(0),d.throw=u(1),d.return=u(2),typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function u(b){return function(y){return w([b,y])}}function w(b){if(a)throw new TypeError("Generator is already executing.");for(;d&&(d=0,b[0]&&(i=0)),i;)try{if(a=1,s&&(h=b[0]&2?s.return:b[0]?s.throw||((h=s.return)&&h.call(s),0):s.next)&&!(h=h.call(s,b[1])).done)return h;switch(s=0,h&&(b=[b[0]&2,h.value]),b[0]){case 0:case 1:h=b;break;case 4:return i.label++,{value:b[1],done:!1};case 5:i.label++,s=b[1],b=[0];continue;case 7:b=i.ops.pop(),i.trys.pop();continue;default:if(h=i.trys,!(h=h.length>0&&h[h.length-1])&&(b[0]===6||b[0]===2)){i=0;continue}if(b[0]===3&&(!h||b[1]>h[0]&&b[1]<h[3])){i.label=b[1];break}if(b[0]===6&&i.label<h[1]){i.label=h[1],h=b;break}if(h&&i.label<h[2]){i.label=h[2],i.ops.push(b);break}h[2]&&i.ops.pop(),i.trys.pop();continue}b=n.call(o,i)}catch(y){b=[6,y],s=0}finally{a=h=0}if(b[0]&5)throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}}function ae(o,n,i){if(i||arguments.length===2)for(var a=0,s=n.length,h;a<s;a++)(h||!(a in n))&&(h||(h=Array.prototype.slice.call(n,0,a)),h[a]=n[a]);return o.concat(h||Array.prototype.slice.call(n))}var X=[];for(var ne=0;ne<256;++ne)X.push((ne+256).toString(16).slice(1));function Qe(o,n=0){return(X[o[n+0]]+X[o[n+1]]+X[o[n+2]]+X[o[n+3]]+"-"+X[o[n+4]]+X[o[n+5]]+"-"+X[o[n+6]]+X[o[n+7]]+"-"+X[o[n+8]]+X[o[n+9]]+"-"+X[o[n+10]]+X[o[n+11]]+X[o[n+12]]+X[o[n+13]]+X[o[n+14]]+X[o[n+15]]).toLowerCase()}var vt,We=new Uint8Array(16);function Ve(){if(!vt&&(vt=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!vt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return vt(We)}var Ge=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const we={randomUUID:Ge};function Xe(o,n,i){if(we.randomUUID&&!n&&!o)return we.randomUUID();o=o||{};var a=o.random||(o.rng||Ve)();if(a[6]=a[6]&15|64,a[8]=a[8]&63|128,n){i=i||0;for(var s=0;s<16;++s)n[i+s]=a[s];return n}return Qe(a)}var gt=1;function $(o){var n="<".charCodeAt(0),i=">".charCodeAt(0),a="-".charCodeAt(0),s="/".charCodeAt(0),h="!".charCodeAt(0),d="'".charCodeAt(0),u='"'.charCodeAt(0),w="?".charCodeAt(0),b=`\r
	>/= `,y=0;return gt=1,Ce(function g(){for(var P=[];o[y];){if(o.charCodeAt(y)==n){if(o.charCodeAt(y+1)===s)return y=o.indexOf(">",y),P;if(o.charCodeAt(y+1)===h){if(o.charCodeAt(y+2)==a){for(;o.charCodeAt(y)!==i||o.charCodeAt(y-1)!=a||o.charCodeAt(y-2)!=a||y==-1;)y=o.indexOf(">",y+1);y===-1&&(y=o.length)}else for(y+=2;o.charCodeAt(y)!==i;y++);y++;continue}if(o.charCodeAt(y+1)===w){y=o.indexOf(">",y),y++;continue}for(var L=++y;b.indexOf(o[y])===-1;y++);for(var C=o.slice(L,y),R=!1,j={};o.charCodeAt(y)!==i;y++){var c=o.charCodeAt(y);if(c>64&&c<91||c>96&&c<123){for(L=y;b.indexOf(o[y])===-1;y++);for(var t=o.slice(L,y),r=o.charCodeAt(y);r!==d&&r!==u;)y++,r=o.charCodeAt(y);var e=o[y],l=++y;y=o.indexOf(e,l);var p=o.slice(l,y);R||(j={},R=!0),j[t]=p}}var v=[];o.charCodeAt(y-1)!==s&&(y++,v=g()),P.push({children:v,tagName:C,attrs:j})}else{var x=y;(y=o.indexOf("<",y)-1)===-2&&(y=o.length);var m=o.slice(x,y+1);m.length>0&&P.push(m)}y++}return P}())}function Ce(o){var n={};if(o===void 0)return{};if(o.length===1&&typeof o[0]=="string")return o[0];for(var i in o.forEach(function(a){if(n[a.tagName]||(n[a.tagName]=[]),typeof a=="object"){var s=Ce(a.children);typeof s=="object"&&(a.attrs&&(s.attrs=a.attrs),s.attrs===void 0?s.attrs={order:gt}:s.attrs.order=gt),gt++,n[a.tagName].push(s)}}),n)n[i].length==1&&(n[i]=n[i][0]);return n}function E(o){return o/12700}function mt(o){return o/100}function At(o){return o/6e4}function rt(o){return o/1e5}function re(o){var n=Math.ceil(o/26),i=(o%26||26)-1+65;return String.fromCharCode(i).repeat(n)}function V(o,n,i){var a={type:"solidFill"};if(o["a:srgbClr"])a.color="#"+o["a:srgbClr"].attrs.val;else if(o["a:schemeClr"]){var s=o["a:schemeClr"].attrs.val;i&&(s=i.getColorThemeName(s)),a.color=n.getColor(s)}else o["a:sysClr"]&&(a.color="#"+o["a:sysClr"].attrs.lastClr);var h=o["a:srgbClr"]||o["a:schemeClr"]||o["a:sysClr"],d=f.get(h,["a:alpha","attrs","val"],1e5);a.alpha=d/1e5;var u=f.get(h,["a:shade","attrs","val"]);u&&(a.shade=u/1e5);var w=f.get(h,["a:lumMod","attrs","val"]);w&&(a.lumMod=w/1e5);var b=f.get(h,["a:lumOff","attrs","val"]);b&&(a.lumOff=b/1e5);var y=f.get(h,["a:tint","attrs","val"]);return y&&(a.tint=y/1e5),a}function ut(o,n,i){var a,s={type:"blipFill"},h=f.get(o,["a:blip","attrs","r:embed"]);if(h){var d=(a=i.rels[h])===null||a===void 0?void 0:a.target;d&&(s.base64=n.getMedia(d))}var u=f.get(o,["a:blip","a:alphaModFix","attrs","amt"]);u&&(s.alpha=u/1e5);var w=f.get(o,["a:stretch","a:fillRect","attrs"]);return w&&(s.fillRect={},w.b&&(s.fillRect.b=w.b/1e5),w.t&&(s.fillRect.t=w.t/1e5),w.r&&(s.fillRect.r=w.r/1e5),w.l&&(s.fillRect.l=w.l/1e5)),s}function ft(o,n,i){var a={type:"gradFill",tileRect:{},lin:{},gsList:[]};a.flip=o.attrs.flip,a.path=f.get(o,["a:path","attrs","path"])||"linear",a.rotWithShape=o.attrs.rotWithShape==="1",f.get(o,["a:lin","attrs","ang"])&&(a.lin.ang=At(o["a:lin"].attrs.ang)),f.get(o,["a:lin","attrs","scaled"])&&(a.lin.scaled=o["a:lin"].attrs.scaled==="1");var s=f.get(o,["a:gsLst","a:gs"])||[];return a.gsList=s.map(function(h){return{color:V(h,n,i),pos:rt(h.attrs.pos)}}),f.get(o,["a:tileRect","attrs","l"])&&(a.tileRect.l=rt(o["a:tileRect"].attrs.l)),f.get(o,["a:tileRect","attrs","t"])&&(a.tileRect.t=rt(o["a:tileRect"].attrs.t)),f.get(o,["a:tileRect","attrs","r"])&&(a.tileRect.r=rt(o["a:tileRect"].attrs.r)),f.get(o,["a:tileRect","attrs","b"])&&(a.tileRect.b=rt(o["a:tileRect"].attrs.b)),a}function oe(o){return o<=.04045?o/12.92:Math.pow((o+.055)/1.055,2.4)}function ce(o){return o<.0031308?12.92*o:1.055*Math.pow(o,1/2.4)-.055}function ve(o,n){var i=o[0],a=o[1],s=o[2],h=oe(i/255)*n,d=oe(a/255)*n,u=oe(s/255)*n;return[Math.round(255*ce(h)),Math.round(255*ce(d)),Math.round(255*ce(u))]}function ie(o,n,i){var a=o/255,s=n/255,h=i/255,d=Math.max(a,s,h),u=Math.min(a,s,h),w=d-u,b=0,y=(d+u)/2;return w===0?b=0:d===a?b=(s-h)/w%6:d===s?b=(h-a)/w+2:d===h&&(b=(a-s)/w+4),(b=Math.round(60*b))<0&&(b+=360),{h:b,s:w===0||y===0||y===1?0:w/(1-Math.abs(2*y-1)),l:y}}function se(o,n,i){var a,s,h,d=(1-Math.abs(2*i-1))*n,u=d*(1-Math.abs(o/60%2-1)),w=i-d/2;return o<60?(a=d,s=u,h=0):o<120?(a=u,s=d,h=0):o<180?(a=0,s=d,h=u):o<240?(a=0,s=u,h=d):o<300?(a=u,s=0,h=d):(a=d,s=0,h=u),[a=Math.round(255*(a+w)),s=Math.round(255*(s+w)),h=Math.round(255*(h+w))]}function z(o,n){if(!o||o.type==="none")return"";if(o.type==="solidFill"&&/^#[\da-fA-F]{3,6}$/.test(o.color)){var i=parseInt(o.color.substr(1,2),16),a=parseInt(o.color.substr(3,2),16),s=parseInt(o.color.substr(5,2),16);if(o.shade){var h=ve([i,a,s],o.shade);i=h[0],a=h[1],s=h[2]}if(o.lumMod){var d=function(y,g,P,L){var C=ie(y,g,P),R=C.h,j=C.l*L;return j>=1&&(j=1),se(R,C.s,j)}(i,a,s,o.lumMod);i=d[0],a=d[1],s=d[2]}if(o.lumOff&&(d=function(y,g,P,L){var C=ie(y,g,P),R=C.h,j=L+C.l;return j>1&&(j=1),se(R,C.s,j)}(i,a,s,o.lumOff),i=d[0],a=d[1],s=d[2]),o.tint||n!=null&&n.light){var u=function(y,g,P,L){var C=ie(y,g,P),R=C.h,j=C.l;return L>=1&&(L=1),se(R,C.s,j*L+(1-L))}(i,a,s,o.tint||(n==null?void 0:n.light));i=u[0],a=u[1],s=u[2]}if(n!=null&&n.dark){var w=ve([i,a,s],n==null?void 0:n.dark);i=w[0],a=w[1],s=w[2]}var b=o.alpha;return"rgba(".concat(i,",").concat(a,",").concat(s,",").concat(b,")")}}var jt=function(){function o(n,i,a){this.uuid=Xe(),this.offset={x:0,y:0},this.extend={w:0,h:0},this.rotate=0,this.order=0,this.flipV=!1,this.flipH=!1,this.source=n,this.ctx=i,this.group=a;var s=f.get(n,["p:nvSpPr","p:nvPr"]);if(s){var h=f.get(s,"p:ph");h&&h.attrs&&(this.idx=h.attrs.idx,this.type=h.attrs.type),f.get(s,["attrs","userDrawn"])&&(this.userDrawn=f.get(s,["attrs","userDrawn"])==="1")}if(this.order=f.get(n,"attrs.order",0),this.source["p:spPr"])(d=this.getXfrm())&&(this.offset={x:Math.round(E(parseInt(d["a:off"].attrs.x))),y:Math.round(E(parseInt(d["a:off"].attrs.y)))},this.extend={w:Math.round(E(parseInt(d["a:ext"].attrs.cx))),h:Math.round(E(parseInt(d["a:ext"].attrs.cy)))},this.rotate=At(parseInt(f.get(d,"attrs.rot",0))),this.flipV=f.get(d,"attrs.flipV")==="1",this.flipH=f.get(d,"attrs.flipH")==="1");else if(this.source["p:xfrm"]){var d=this.source["p:xfrm"];this.offset={x:Math.round(E(parseInt(d["a:off"].attrs.x))),y:Math.round(E(parseInt(d["a:off"].attrs.y)))},this.extend={w:Math.round(E(parseInt(d["a:ext"].attrs.cx))),h:Math.round(E(parseInt(d["a:ext"].attrs.cy)))}}if(a){var u=a.extend,w=a.chExtend,b=a.chOffset,y=u.w/w.w,g=u.h/w.h;this.extend.w=this.extend.w*y,this.extend.h=this.extend.h*g,this.offset.x=(this.offset.x-b.x)*y,this.offset.y=(this.offset.y-b.y)*g}}return Object.defineProperty(o.prototype,"theme",{get:function(){return(this.ctx.sliderMaster||this.ctx).theme},enumerable:!1,configurable:!0}),o.prototype.getColorThemeName=function(n){return this.ctx.getColorThemeName(n)},o.prototype.getXfrm=function(){var n=this.source["p:spPr"]["a:xfrm"];return n||(this.idx?n=this.ctx.getNodeInheritAttrsByIdx(this.idx,["p:spPr","a:xfrm"]):this.type&&(n=this.ctx.getNodeInheritAttrsByType(this.type,["p:spPr","a:xfrm"]))),n},o}(),qe=function(){function o(n,i){this.props={},this.inheritProps={},this.source=n,this.node=i,this._getInheritBodyProps(),this._parseBodyProps(),this._parseLstStyle(),this._parseText()}return o.prototype._getInheritBodyProps=function(){var n,i=this.node.ctx,a=this.node.type,s=this.node.idx;if(a||s)switch(i.slideType){case"slideMaster":break;case"slideLayout":(n=a?i.slideMaster.getNodeByType(a):i.slideMaster.getNodeByIdx(s))&&(this.inheritProps=f.get(n,["textBody","props"])||{});break;case"slide":(n=a?i.slideLayout.slideMaster.getNodeByType(a):i.slideLayout.slideMaster.getNodeByIdx(s))&&Object.assign(this.inheritProps,f.get(n,["textBody","props"])||{}),(n=a?i.slideLayout.getNodeByType(a):i.slideLayout.getNodeByIdx(s))&&Object.assign(this.inheritProps,f.get(n,["textBody","props"])||{})}},o.prototype._parseBodyProps=function(){var n=this,i=f.get(this.source,["a:bodyPr","attrs"])||{};Object.keys(i).forEach(function(d){switch(d){case"anchor":n.props.anchor=i[d];break;case"rtlCol":n.props.rtlCol=i[d]==="1";break;case"lIns":case"rIns":case"tIns":case"bIns":n.props[d]=E(parseInt(i[d]));break;case"order":break;default:n.props[d]=i[d]}});var a=f.get(this.source,["a:bodyPr","a:normAutofit","attrs"]);if(a){this.props.normAutofit={};var s=a.fontScale;s&&(this.props.normAutofit.fontScale=rt(parseInt(s)));var h=a.lnSpcReduction;h&&(this.props.normAutofit.lnSpcReduction=rt(parseInt(h)))}},o.prototype._parseLstStyle=function(){var n=this,i={},a=f.get(this.source,"a:lstStyle")||{};Object.keys(a).forEach(function(s){if(s.startsWith("a:")&&s.endsWith("pPr")){var h=s.substr(2,s.length-5);i[h]={props:n._formatPPr(a[s])};var d=f.get(a[s],["a:defRPr"]);i[h].defRPr=n._formatRPr(d)}}),this.lstStyle=i},o.prototype._parseText=function(){var n=this,i=f.get(this.source,["a:p"])||[];Array.isArray(i)||(i=[i]),this.paragraphs=i.map(function(a){return n._parseParagraph(a)})},o.prototype._parseParagraph=function(n){var i=this,a={props:{},inheritProps:{},inheritRProps:{},endParaRProps:{},rows:[]},s=f.get(n,["a:pPr"])||{};a.props=this._formatPPr(s);var h=f.get(n,["a:endParaRPr"]);a.endParaRProps=this._formatRPr(h);var d=f.get(n,["a:r"])||[];Array.isArray(d)||(d=[d]);var u=f.get(n,["a:br"])||[];return Array.isArray(u)||(u=[u]),(d=d.concat(u.map(function(w){return S({isBr:!0},w)}))).sort(function(w,b){return f.get(w,["attrs","order"])-f.get(b,["attrs","order"])}),a.rows=d.map(function(w){return i._parseRow(w)}),a.inheritProps=this._getInheritPProps(a.props.level),a.inheritRProps=this._getInheritRProps(a.props.level),a},o.prototype._getInheritPProps=function(n){n===void 0&&(n="0");var i,a={},s=this.node.ctx,h=this.node.type,d=this.node.idx;switch(s.slideType){case"slideMaster":this.node.isTextBox?Object.assign(a,f.get(s.defaultTextStyle,["lvl".concat(n?+n+1:1),"props"])||{}):Object.assign(a,f.get(s,["textStyles","otherStyle","lvl".concat(n?+n+1:1),"props"])||{});break;case"slideLayout":this.node.isTextBox?Object.assign(a,f.get(s.slideMaster.defaultTextStyle,["lvl".concat(n?+n+1:1),"props"])||{}):Object.assign(a,f.get(s.slideMaster,["textStyles","otherStyle","lvl".concat(n?+n+1:1),"props"])||{}),(h||d)&&(i=h?s.slideMaster.getNodeByType(h):s.slideMaster.getNodeByIdx(d))&&Object.assign(a,f.get(i,["textBody","lstStyle","lvl".concat(n?+n+1:1),"props"])||{});break;case"slide":this.node.isTextBox?Object.assign(a,f.get(s.slideLayout.slideMaster.defaultTextStyle,["lvl".concat(n?+n+1:1),"props"])||{}):Object.assign(a,f.get(s.slideLayout.slideMaster,["textStyles","otherStyle","lvl".concat(n?+n+1:1),"props"])||{}),(h||d)&&(["subTitle","ctrTitle","title"].includes(h)&&Object.assign(a,f.get(s.slideLayout.slideMaster,["textStyles","titleStyle","lvl".concat(n?+n+1:1),"props"])||{}),(i=h?s.slideLayout.slideMaster.getNodeByType(h):s.slideLayout.slideMaster.getNodeByIdx(d))&&Object.assign(a,f.get(i,["textBody","lstStyle","lvl".concat(n?+n+1:1),"props"])||{}),(i=h?s.slideLayout.getNodeByType(h):s.slideLayout.getNodeByIdx(d))&&Object.assign(a,f.get(i,["textBody","lstStyle","lvl".concat(n?+n+1:1),"props"])||{}))}return a},o.prototype._getInheritRProps=function(n){n===void 0&&(n="0");var i,a={},s=this.node.ctx,h=this.node.type,d=this.node.idx;switch(s.slideType){case"slideMaster":this.node.isTextBox?Object.assign(a,f.get(s.defaultTextStyle,["lvl".concat(n?+n+1:1),"defRPr"])||{}):Object.assign(a,f.get(s,["textStyles","otherStyle","lvl".concat(n?+n+1:1),"defRPr"])||{});break;case"slideLayout":this.node.isTextBox?Object.assign(a,f.get(s.slideMaster.defaultTextStyle,["lvl".concat(n?+n+1:1),"defRPr"])||{}):Object.assign(a,f.get(s.slideMaster,["textStyles","otherStyle","lvl".concat(n?+n+1:1),"defRPr"])||{}),(h||d)&&(i=h?s.slideMaster.getNodeByType(h):s.slideMaster.getNodeByIdx(d))&&(a=f.get(i,["textBody","lstStyle","lvl".concat(n?+n+1:1),"defRPr"])||{});break;case"slide":this.node.isTextBox?Object.assign(a,f.get(s.slideLayout.slideMaster.defaultTextStyle,["lvl".concat(n?+n+1:1),"defRPr"])||{}):Object.assign(a,f.get(s.slideLayout.slideMaster,["textStyles","otherStyle","lvl".concat(n?+n+1:1),"defRPr"])||{}),(h||d)&&(["subTitle","ctrTitle","title"].includes(h)&&Object.assign(a,f.get(s.slideLayout.slideMaster,["textStyles","titleStyle","lvl".concat(n?+n+1:1),"defRPr"])||{}),(i=h?s.slideLayout.slideMaster.getNodeByType(h):s.slideLayout.slideMaster.getNodeByIdx(d))&&Object.assign(a,f.get(i,["textBody","lstStyle","lvl".concat(n?+n+1:1),"defRPr"])||{}),(i=h?s.slideLayout.getNodeByType(h):s.slideLayout.getNodeByIdx(d))&&Object.assign(a,f.get(i,["textBody","lstStyle","lvl".concat(n?+n+1:1),"defRPr"])||{}))}var u=f.get(this.node.source,["p:style","a:fontRef"]);return f.get(u,"a:schemeClr")&&(a.color=V(u,this.node.theme,this.node)),f.get(this.lstStyle,["lvl".concat(n?+n+1:1),"defRPr"])&&Object.assign(a,f.get(this.lstStyle,["lvl".concat(n?+n+1:1),"defRPr"])),a},o.prototype._formatPPr=function(n){var i={},a=f.get(n,"attrs")||{};return Object.keys(a).forEach(function(s){switch(s){case"algn":i.align=a[s];break;case"marL":i.marginLeft=E(parseInt(a[s]));break;case"indent":i.indent=E(parseInt(a[s]));break;case"lvl":i.level=a[s]}}),f.get(n,["a:lnSpc","a:spcPct","attrs","val"])&&(i.lineHeight=parseInt(n["a:lnSpc"]["a:spcPct"].attrs.val)/1e5),f.get(n,["a:buAutoNum","attrs","type"])&&(i.buAutoNum=n["a:buAutoNum"].attrs.type),f.get(n,["a:buChar","attrs","char"])&&(i.buChar=n["a:buChar"].attrs.char),f.get(n,["a:spcBef","a:spcPts","attrs","val"])&&(i.spaceBefore=mt(parseInt(n["a:spcBef"]["a:spcPts"].attrs.val))),f.get(n,["a:spcAft","a:spcPts","attrs","val"])&&(i.spaceAfter=mt(parseInt(n["a:spcAft"]["a:spcPts"].attrs.val))),i},o.prototype._parseRow=function(n){if(n.isBr)return{isBr:!0};var i={props:{},text:""},a=f.get(n,["a:rPr"])||{};return i.props=this._formatRPr(a),i.text=f.get(n,"a:t")||"",i},o.prototype._formatRPr=function(n){var i={},a=f.get(n,"attrs")||{};Object.keys(a).forEach(function(d){switch(d){case"sz":i.size=parseInt(a[d])/100;break;case"b":i.bold=a[d]==="1";break;case"i":i.italic=a[d]==="1";break;case"u":i.underline=a[d];break;case"strike":i.strike=a[d];break;case"order":case"dirty":break;default:i[d]=a[d]}});var s=f.get(n,"a:solidFill");s&&(i.color=V(s,this.node.theme,this.node));var h=f.get(n,"a:highlight");return h&&(i.background=V(h,this.node.theme,this.node)),i.typeface=f.get(n,["a:ea","attrs","typeface"]),i},o}();function it(o,n,i){var a={};if(!f.get(o,"a:noFill")){f.get(o,"attrs.w")&&(a.width=E(parseInt(f.get(o,"attrs.w"))));var s=f.get(o,"a:solidFill");s&&(a.color=V(s,n,i));var h=f.get(o,"a:prstDash");if(h&&(a.type=h.attrs.val),f.get(o,["a:miter"])&&(a.lineJoin="miter"),f.get(o,["a:bevel"])&&(a.lineJoin="bevel"),f.get(o,["a:round"])&&(a.lineJoin="round"),f.get(o,["a:miter","attrs","lim"])&&(a.miterLim=E(parseInt(f.get(o,["a:miter","attrs","lim"])))),f.get(o,["a:headEnd"])){var d=f.get(o,["a:headEnd","attrs"]);a.headEnd={type:d.type,len:d.len,w:d.w}}if(f.get(o,["a:tailEnd"])){var u=f.get(o,["a:tailEnd","attrs"]);a.tailEnd={type:u.type,len:u.len,w:u.w}}return a}}var pt=function(o){function n(i,a,s,h){var d=o.call(this,i,s,h)||this;return d.border={},d.prstGeom={},d.isTextBox=!1,d.pptx=a,d._parseShape(),d._parIsTextBox(),d._parsePrstGeom(),d._parseBackground(),d._parseBorder(),d._parseTxt(),d}return Mt(n,o),n.prototype._parseShape=function(){if(this.shape=f.get(this.source,["p:spPr","a:prstGeom","attrs","prst"]),!this.shape&&f.get(this.source,["p:spPr","a:custGeom"])){this.shape="customGeom";var i=f.get(this.source,["p:spPr","a:custGeom","a:pathLst","a:path"]),a=[],s=[],h=function(u){switch(u){case"a:moveTo":case"a:cubicBezTo":case"a:lnTo":s=Array.isArray(i[u])?i[u]:[i[u]],a=a.concat(s.map(function(w){return{order:w.attrs.order,type:u.split(":")[1],points:(Array.isArray(w["a:pt"])?w["a:pt"]:[w["a:pt"]]).map(function(b){return[E(parseInt(f.get(b,["attrs","x"]))),E(parseInt(f.get(b,["attrs","y"])))]})}}));break;case"a:close":s=Array.isArray(i[u])?i[u]:[i[u]],a=a.concat(s.map(function(w){return{order:w.attrs.order,type:u.split(":")[1]}}))}};for(var d in i)h(d);a.sort(function(u,w){return u.order-w.order}),this.prstGeom.pathList=a,f.get(i,["attrs","w"])&&(this.prstGeom.w=E(parseInt(f.get(i,["attrs","w"])))),f.get(i,["attrs","h"])&&(this.prstGeom.h=E(parseInt(f.get(i,["attrs","h"]))))}},n.prototype._parIsTextBox=function(){this.isTextBox=f.get(this.source,["p:nvSpPr","p:cNvSpPr","attrs","txBox"])==="1"},n.prototype._parsePrstGeom=function(){var i=this,a=f.get(this.source,["p:spPr","a:prstGeom"]),s=f.get(a,["a:avLst","a:gd"]);s&&(Array.isArray(s)||(s=[s]),this.prstGeom.gd=s.map(function(h){var d=["pie","chord","arc"].includes(i.shape)||["blockArc"].includes(i.shape)&&["adj1","adj2"].includes(h.attrs.name)?At(parseInt(h.attrs.fmla.split(" ")[1])):rt(parseInt(h.attrs.fmla.split(" ")[1]));return{name:h.attrs.name,fmla:d}}))},n.prototype._parseBackground=function(){if(!f.get(this.source,["p:spPr","a:noFill"]))if(f.get(this.source,["p:spPr","a:grpFill"])&&this.group)this.background=this.group.getBackground();else{var i=f.get(this.source,["p:spPr","a:solidFill"]);if(i)this.background=V(i,this.theme,this);else{var a=f.get(this.source,["p:spPr","a:gradFill"]);if(a)this.background=ft(a,this.theme,this);else{var s=f.get(this.source,["p:spPr","a:blipFill"]);if(s)this.background=ut(s,this.pptx,this.ctx);else{var h=f.get(this.source,["p:style","a:fillRef"]);h&&(this.background=V(h,this.theme,this))}}}}},n.prototype._parseBorder=function(){var i=f.get(this.source,["p:style","a:lnRef"]);if(i){var a=parseInt(i.attrs.idx),s=this.theme.getLineStyle(a);this.border=S(S({},s),this.border),this.border.color&&this.border.color.color||(this.border.color=V(i,this.theme,this))}var h=f.get(this.source,["p:spPr","a:ln"]);h&&Object.assign(this.border,it(h,this.theme,this)),this.border.color&&this.border.color.color&&!this.border.width&&(this.border.width=n.defaultBorderWidth)},n.prototype._parseTxt=function(){this.textBody=new qe(f.get(this.source,["p:txBody"]),this)},n.defaultBorderWidth=.75,n}(jt),xt=function(o){function n(i,a,s,h,d){var u,w,b=o.call(this,a,h,d)||this;b.userDrawn=!0,b.pptx=s,b.path=i;var y=f.get(b.source,["p:blipFill","a:srcRect"]);y&&(b.clip={},y.attrs.b&&(b.clip.b=parseInt(y.attrs.b)/1e5),y.attrs.t&&(b.clip.t=parseInt(y.attrs.t)/1e5),y.attrs.l&&(b.clip.l=parseInt(y.attrs.l)/1e5),y.attrs.r&&(b.clip.r=parseInt(y.attrs.r)/1e5));var g=f.get(a,["p:nvPicPr","p:nvPr","a:audioFile","attrs","r:link"]);if(g){var P=(u=b.ctx.rels[g])===null||u===void 0?void 0:u.target;b.audioFile=b.pptx.getMedia(P)}var L=f.get(a,["p:nvPicPr","p:nvPr","a:videoFile","attrs","r:link"]);if(L){var C=(w=b.ctx.rels[L])===null||w===void 0?void 0:w.target;b.videoFile=b.pptx.getMedia(C)}return b}return Mt(n,o),Object.defineProperty(n.prototype,"base64",{get:function(){return this.pptx.getMedia(this.path)},enumerable:!1,configurable:!0}),n}(jt),_e=function(o){function n(i,a,s,h){var d=o.call(this,i,s,h)||this;return d.userDrawn=!0,d.props={tableStyleId:""},d.tableGrid={gridCol:[]},d.tr=[],d.tableStyles={},d.pptx=a,d._parseTableProps(),d._parseTableGrid(),d._parseTr(),d._parseInheritStyles(),d}return Mt(n,o),Object.defineProperty(n.prototype,"slideMaster",{get:function(){return this.ctx.slideMaster||this.ctx},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"theme",{get:function(){return this.slideMaster.theme},enumerable:!1,configurable:!0}),n.prototype._parseTableProps=function(){var i=f.get(this.source,["a:graphic","a:graphicData","a:tbl","a:tblPr"]);this.props.tableStyleId=f.get(i,"a:tableStyleId"),this.tableStyles=f.get(this.slideMaster.tableStyles,this.props.tableStyleId)||{},f.get(i,["attrs","bandCol"])==="1"&&(this.props.bandCol=!0),f.get(i,["attrs","bandRow"])==="1"&&(this.props.bandRow=!0),f.get(i,["attrs","firstCol"])==="1"&&(this.props.firstCol=!0),f.get(i,["attrs","firstRow"])==="1"&&(this.props.firstRow=!0),f.get(i,["attrs","lastCol"])==="1"&&(this.props.lastCol=!0),f.get(i,["attrs","lastRow"])==="1"&&(this.props.lastRow=!0)},n.prototype._parseTableGrid=function(){var i=f.get(this.source,["a:graphic","a:graphicData","a:tbl","a:tblGrid","a:gridCol"]);if(i)for(var a=0;a<i.length;a++){var s=f.get(i[a],["attrs","w"]);this.tableGrid.gridCol.push({width:E(parseInt(s))})}},n.prototype._parseTr=function(){var i=[],a=f.get(this.source,["a:graphic","a:graphicData","a:tbl","a:tr"]);Array.isArray(a)||(a=[a]);for(var s=0;s<a.length;s++){var h={props:{},td:[]},d=a[s];h.props.height=E(parseInt(f.get(d,["attrs","h"])));var u=f.get(d,["a:tc"]);Array.isArray(u)||(u=[u]);for(var w=0;w<u.length;w++)h.td.push(this._parseTd(u[w]));i.push(h)}this.tr=i},n.prototype._parseTd=function(i){var a,s,h,d,u=this,w={props:{border:{}},paragraphs:[]},b=f.get(i,["a:tcPr","attrs"]);b!=null&&b.marB&&(w.props.marB=E(parseInt(b==null?void 0:b.marB))),b!=null&&b.marT&&(w.props.marT=E(parseInt(b==null?void 0:b.marT))),b!=null&&b.marL&&(w.props.marL=E(parseInt(b==null?void 0:b.marL))),b!=null&&b.marR&&(w.props.marR=E(parseInt(b==null?void 0:b.marR))),b!=null&&b.anchor&&(w.props.anchor=b==null?void 0:b.anchor);var y=f.get(i,["a:tcPr"]);f.get(y,["a:lnR"])&&(w.props.border.right=it(f.get(y,["a:lnR"]),this.theme,this.ctx)),f.get(y,["a:lnL"])&&(w.props.border.left=it(f.get(y,["a:lnL"]),this.theme,this.ctx)),f.get(y,["a:lnT"])&&(w.props.border.top=it(f.get(y,["a:lnT"]),this.theme,this.ctx)),f.get(y,["a:lnB"])&&(w.props.border.bottom=it(f.get(y,["a:lnB"]),this.theme,this.ctx)),!((a=i==null?void 0:i.attrs)===null||a===void 0)&&a.rowSpan&&(w.props.rowSpan=parseInt(i.attrs.rowSpan)),!((s=i==null?void 0:i.attrs)===null||s===void 0)&&s.gridSpan&&(w.props.gridSpan=parseInt(i.attrs.gridSpan)),!((h=i==null?void 0:i.attrs)===null||h===void 0)&&h.vMerge&&(w.props.vMerge=i.attrs.vMerge==="1"),!((d=i==null?void 0:i.attrs)===null||d===void 0)&&d.hMerge&&(w.props.hMerge=i.attrs.hMerge==="1");var g=f.get(i,["a:tcPr","a:solidFill"]);g&&(w.props.background=V(g,this.theme,this.ctx));var P=f.get(i,["a:txBody"]),L=f.get(P,["a:p"]);return Array.isArray(L)||(L=[L]),w.paragraphs=L.map(function(C){return u._parseParagraph(C)}),w},n.prototype._parseParagraph=function(i){var a=this,s={props:{},inheritProps:{},inheritRProps:{},endParaRProps:{},rows:[]},h=f.get(i,["a:pPr"])||{};s.props=this._formatPPr(h);var d=f.get(i,["a:endParaRPr"]);s.endParaRProps=this._formatRPr(d);var u=f.get(i,["a:r"])||[];Array.isArray(u)||(u=[u]);var w=f.get(i,["a:br"])||[];return Array.isArray(w)||(w=[w]),(u=u.concat(w.map(function(b){return S({isBr:!0},b)}))).sort(function(b,y){return f.get(b,["attrs","order"])-f.get(y,["attrs","order"])}),s.rows=u.map(function(b){return a._parseRow(b)}),s},n.prototype._parseRow=function(i){if(i.isBr)return{isBr:!0};var a={props:{},text:""},s=f.get(i,["a:rPr"])||{};return a.props=this._formatRPr(s),a.text=f.get(i,"a:t")||"",a},n.prototype._formatPPr=function(i){var a={},s=f.get(i,"attrs")||{};return Object.keys(s).forEach(function(h){h==="algn"&&(a.align=s[h])}),f.get(i,["a:lnSpc","a:spcPct","attrs","val"])&&(a.lineHeight=parseInt(i["a:lnSpc"]["a:spcPct"].attrs.val)/1e5),f.get(i,["a:buAutoNum","attrs","type"])&&(a.buAutoNum=i["a:buAutoNum"].attrs.type),f.get(i,["a:buChar","attrs","char"])&&(a.buChar=i["a:buChar"].attrs.char),f.get(i,["a:spcBef","a:spcPts","attrs","val"])&&(a.spaceBefore=mt(parseInt(i["a:spcBef"]["a:spcPts"].attrs.val))),f.get(i,["a:spcAft","a:spcPts","attrs","val"])&&(a.spaceAfter=mt(parseInt(i["a:spcAft"]["a:spcPts"].attrs.val))),a},n.prototype._formatRPr=function(i){var a={},s=f.get(i,"attrs")||{};Object.keys(s).forEach(function(u){switch(u){case"sz":a.size=parseInt(s[u])/100;break;case"b":a.bold=s[u]==="1";break;case"i":a.italic=s[u]==="1";break;case"u":a.underline=s[u];break;case"strike":a.strike=s[u];break;case"order":case"dirty":break;default:a[u]=s[u]}});var h=f.get(i,"a:solidFill");h&&(a.color=V(h,this.theme,this.ctx));var d=f.get(i,"a:highlight");return d&&(a.background=V(d,this.theme,this.ctx)),a.typeface=f.get(i,["a:ea","attrs","typeface"]),a},n.prototype._isLastCol=function(i,a){var s,h;if(a===i.length-1)return!0;for(var d=a+1;d<i.length;d++)if(!(!((s=i[d].props)===null||s===void 0)&&s.hMerge)&&!(!((h=i[d].props)===null||h===void 0)&&h.vMerge))return!1;return!0},n.prototype._isBandRow=function(i){var a;return!((a=this.props)===null||a===void 0)&&a.firstRow?i%2==1:i%2==0},n.prototype._isBandCol=function(i){var a;return!((a=this.props)===null||a===void 0)&&a.firstCol?i%2==1:i%2==0},n.prototype._parseInheritStyles=function(){var i,a,s,h,d,u,w,b,y=this,g=(a=(i=this.tableStyles)===null||i===void 0?void 0:i.wholeTbl)===null||a===void 0?void 0:a.tcStyle,P=(h=(s=this.tableStyles)===null||s===void 0?void 0:s.wholeTbl)===null||h===void 0?void 0:h.tcTxStyle,L=(u=(d=this.slideMaster.defaultTextStyle)===null||d===void 0?void 0:d.lvl1)===null||u===void 0?void 0:u.props,C=(b=(w=this.slideMaster.defaultTextStyle)===null||w===void 0?void 0:w.lvl1)===null||b===void 0?void 0:b.defRPr;this.tr.forEach(function(R,j){R.td.forEach(function(c,t){var r,e,l,p,v,x,m,_,k,I,B,O,D,N,U,F,H,Q,W,J,et,at,ot,ct,st,ht,kt,Pt,St,Ct,_t,It,Rt,Tt,Bt,Ot,Et,Nt,Ft,Zt,Dt,zt,Ht,Ut,Qt,Wt,Vt,Gt,Xt,qt,Yt,$t,Jt,Kt,te,ee,Z=S(S({},L),g),G=S(S({},C),P);y.props.firstRow&&j===0?(Z=S(S(S({},Z),(e=(r=y.tableStyles)===null||r===void 0?void 0:r.firstRow)===null||e===void 0?void 0:e.tcStyle),{border:S(S({},Z==null?void 0:Z.border),(v=(p=(l=y.tableStyles)===null||l===void 0?void 0:l.firstRow)===null||p===void 0?void 0:p.tcStyle)===null||v===void 0?void 0:v.border)}),G=S(S({},G),(m=(x=y.tableStyles)===null||x===void 0?void 0:x.firstRow)===null||m===void 0?void 0:m.tcTxStyle)):y.props.lastRow&&j===y.tr.length-1?(Z=S(S(S({},Z),(k=(_=y.tableStyles)===null||_===void 0?void 0:_.lastRow)===null||k===void 0?void 0:k.tcStyle),{border:S(S({},Z==null?void 0:Z.border),(O=(B=(I=y.tableStyles)===null||I===void 0?void 0:I.lastRow)===null||B===void 0?void 0:B.tcStyle)===null||O===void 0?void 0:O.border)}),G=S(S({},G),(N=(D=y.tableStyles)===null||D===void 0?void 0:D.lastRow)===null||N===void 0?void 0:N.tcTxStyle)):y.props.firstCol&&t===0?(Z=S(S(S({},Z),(F=(U=y.tableStyles)===null||U===void 0?void 0:U.firstCol)===null||F===void 0?void 0:F.tcStyle),{border:S(S({},Z==null?void 0:Z.border),(W=(Q=(H=y.tableStyles)===null||H===void 0?void 0:H.firstCol)===null||Q===void 0?void 0:Q.tcStyle)===null||W===void 0?void 0:W.border)}),G=S(S({},G),(et=(J=y.tableStyles)===null||J===void 0?void 0:J.firstCol)===null||et===void 0?void 0:et.tcTxStyle)):y.props.lastCol&&y._isLastCol(R.td,t)?(Z=S(S(S({},Z),(ot=(at=y.tableStyles)===null||at===void 0?void 0:at.lastCol)===null||ot===void 0?void 0:ot.tcStyle),{border:S(S({},Z==null?void 0:Z.border),(ht=(st=(ct=y.tableStyles)===null||ct===void 0?void 0:ct.lastCol)===null||st===void 0?void 0:st.tcStyle)===null||ht===void 0?void 0:ht.border)}),G=S(S({},G),(Pt=(kt=y.tableStyles)===null||kt===void 0?void 0:kt.lastCol)===null||Pt===void 0?void 0:Pt.tcTxStyle)):(y.props.bandRow&&(y._isBandRow(j)?(Z=S(S(S({},Z),(Ct=(St=y.tableStyles)===null||St===void 0?void 0:St.band1H)===null||Ct===void 0?void 0:Ct.tcStyle),{border:S(S({},Z==null?void 0:Z.border),(Rt=(It=(_t=y.tableStyles)===null||_t===void 0?void 0:_t.band1H)===null||It===void 0?void 0:It.tcStyle)===null||Rt===void 0?void 0:Rt.border)}),G=S(S({},G),(Bt=(Tt=y.tableStyles)===null||Tt===void 0?void 0:Tt.band1H)===null||Bt===void 0?void 0:Bt.tcTxStyle)):(Z=S(S(S({},Z),(Et=(Ot=y.tableStyles)===null||Ot===void 0?void 0:Ot.band2V)===null||Et===void 0?void 0:Et.tcStyle),{border:S(S({},Z==null?void 0:Z.border),(Zt=(Ft=(Nt=y.tableStyles)===null||Nt===void 0?void 0:Nt.band2V)===null||Ft===void 0?void 0:Ft.tcStyle)===null||Zt===void 0?void 0:Zt.border)}),G=S(S({},G),(zt=(Dt=y.tableStyles)===null||Dt===void 0?void 0:Dt.band2V)===null||zt===void 0?void 0:zt.tcTxStyle))),y.props.bandCol&&(y._isBandCol(t)?(Z=S(S(S({},Z),(Ut=(Ht=y.tableStyles)===null||Ht===void 0?void 0:Ht.band1V)===null||Ut===void 0?void 0:Ut.tcStyle),{border:S(S({},Z==null?void 0:Z.border),(Vt=(Wt=(Qt=y.tableStyles)===null||Qt===void 0?void 0:Qt.band1V)===null||Wt===void 0?void 0:Wt.tcStyle)===null||Vt===void 0?void 0:Vt.border)}),G=S(S({},G),(Xt=(Gt=y.tableStyles)===null||Gt===void 0?void 0:Gt.band1V)===null||Xt===void 0?void 0:Xt.tcTxStyle)):(Z=S(S(S({},Z),(Yt=(qt=y.tableStyles)===null||qt===void 0?void 0:qt.band2H)===null||Yt===void 0?void 0:Yt.tcStyle),{border:S(S({},Z==null?void 0:Z.border),(Kt=(Jt=($t=y.tableStyles)===null||$t===void 0?void 0:$t.band2H)===null||Jt===void 0?void 0:Jt.tcStyle)===null||Kt===void 0?void 0:Kt.border)}),G=S(S({},G),(ee=(te=y.tableStyles)===null||te===void 0?void 0:te.band2H)===null||ee===void 0?void 0:ee.tcTxStyle)))),c.inheritTcStyle=Z,c.inheritTcTxStyle=G})})},n}(jt),pe=function(){function o(n,i,a,s){if(this.offset={x:0,y:0},this.chOffset={x:0,y:0},this.extend={w:0,h:0},this.chExtend={w:0,h:0},this.rotate=0,this.nodes=[],this.flipV=!1,this.flipH=!1,this.userDrawn=!0,this.order=f.get(n,["attrs","order"]),this.pptx=i,this.ctx=a,this.source=n,this.group=s,this.source["p:grpSpPr"]){var h=f.get(this.source,["p:grpSpPr","a:xfrm"]);if(h&&(this.offset={x:Math.round(E(parseInt(h["a:off"].attrs.x))),y:Math.round(E(parseInt(h["a:off"].attrs.y)))},this.chOffset={x:Math.round(E(parseInt(h["a:chOff"].attrs.x))),y:Math.round(E(parseInt(h["a:chOff"].attrs.y)))},this.extend={w:Math.round(E(parseInt(h["a:ext"].attrs.cx))),h:Math.round(E(parseInt(h["a:ext"].attrs.cy)))},this.chExtend={w:Math.round(E(parseInt(h["a:chExt"].attrs.cx))),h:Math.round(E(parseInt(h["a:chExt"].attrs.cy)))},this.rotate=At(parseInt(f.get(h,"attrs.rot",0))),this.flipV=f.get(h,"attrs.flipV")==="1",this.flipH=f.get(h,"attrs.flipH")==="1"),s){var d=s.extend,u=s.chExtend,w=s.chOffset,b=d.w/u.w,y=d.h/u.h;this.extend.w=this.extend.w*b,this.extend.h=this.extend.h*y,this.offset.x=(this.offset.x-w.x)*b,this.offset.y=(this.offset.y-w.y)*y}}this._parseBackground(),this._parseNodes()}return o.prototype.getBackground=function(){return this.background&&this.background.type!=="none"?this.background:this.group?this.group.getBackground():void 0},o.prototype._parseBackground=function(){var n=f.get(this.source,["p:grpSpPr"]);n&&n["a:solidFill"]?this.background=V(n["a:solidFill"],this.ctx.theme,this.ctx):n&&n["a:gradFill"]?this.background=ft(n["a:gradFill"],this.ctx.theme,this.ctx):n&&n["a:blipFill"]&&(this.background=ut(n["a:blipFill"],this.pptx,this.ctx))},o.prototype._parseNodes=function(){var n=this.source;wt(this.nodes,n,this.pptx,this.ctx,this)},o}(),Ie=function(o){function n(i,a,s,h){var d=o.call(this,i,s,h)||this;return d.nodes=[],d.pptx=a,d.parseNode(),d}return Mt(n,o),n.prototype.parseNode=function(){return q(this,void 0,void 0,function(){var i,a,s,h,d,u,w,b,y;return Y(this,function(g){switch(g.label){case 0:return g.trys.push([0,3,,4]),(i=f.get(this.source,["a:graphic","a:graphicData","dgm:relIds","attrs","r:dm"]))&&this.ctx.rels[i]?(a=this.ctx.rels[i].target,h=$,[4,this.pptx.getXmlByPath(a)]):[2];case 1:return s=h.apply(void 0,[g.sent()]),(d=f.get(s,["dgm:dataModel","dgm:extLst","a:ext","dsp:dataModelExt","attrs","relId"]))&&this.ctx.rels[d]?(u=this.ctx.rels[d].target,[4,this.pptx.getXmlByPath(u)]):[2];case 2:return w=(w=g.sent()).replace(/dsp:/g,"p:"),b=$(w),y=f.get(b,["p:drawing","p:spTree"]),wt(this.nodes,y,this.pptx,this.ctx),[3,4];case 3:return g.sent(),[3,4];case 4:return[2]}})})},n}(jt);function ye(o){var n={},i=f.get(o,"attrs")||{};return Object.keys(i).forEach(function(a){switch(a){case"algn":n.align=i[a];break;case"marL":n.marginLeft=E(parseInt(i[a]));break;case"indent":n.indent=E(parseInt(i[a]));break;case"lvl":n.level=i[a]}}),f.get(o,["a:lnSpc","a:spcPct","attrs","val"])&&(n.lineHeight=parseInt(o["a:lnSpc"]["a:spcPct"].attrs.val)/1e5),n}function ge(o,n,i){var a={},s=f.get(o,"attrs")||{};Object.keys(s).forEach(function(d){switch(d){case"sz":a.size=parseInt(s[d])/100;break;case"b":a.bold=s[d]==="1";break;case"i":a.italic=s[d]==="1";break;case"u":a.underline=s[d];break;case"strike":a.strike=s[d];break;case"order":case"dirty":break;default:a[d]=s[d]}});var h=f.get(o,"a:solidFill");return h&&(a.color=V(h,n,i)),a}function wt(o,n,i,a,s){for(var h in n)switch(h){case"p:sp":for(var d=Array.isArray(n[h])?n[h]:[n[h]],u=0;u<d.length;u++){var w=d[u];o.push(new pt(w,i,a,s))}break;case"p:pic":var b=Array.isArray(n[h])?n[h]:[n[h]];for(u=0;u<b.length;u++){var y=b[u],g=y["p:blipFill"]["a:blip"].attrs["r:embed"],P=a.rels[g].target,L=new xt(P,y,i,a,s);o.push(L)}break;case"p:cxnSp":var C=Array.isArray(n[h])?n[h]:[n[h]];for(u=0;u<C.length;u++)w=C[u],o.push(new pt(w,i,a,s));break;case"p:graphicFrame":var R=Array.isArray(n[h])?n[h]:[n[h]];for(u=0;u<R.length;u++){var j=R[u];switch(f.get(j,["a:graphic","a:graphicData","attrs","uri"])){case"http://schemas.openxmlformats.org/drawingml/2006/table":o.push(new _e(j,i,a,s));break;case"http://schemas.openxmlformats.org/drawingml/2006/diagram":o.push(new Ie(j,i,a,s))}}break;case"p:grpSp":var c=Array.isArray(n[h])?n[h]:[n[h]];for(u=0;u<c.length;u++){var t=c[u];o.push(new pe(t,i,a,s))}}}var Ye=function(){function o(n,i,a){this.slideType="slide",this.rels={},this.background={type:"none"},this.nodes=[],this.name=n,this.source=i,this.pptx=a}return Object.defineProperty(o.prototype,"index",{get:function(){if(!this.name)return 0;var n=this.name.match(/(\d+)/);return n?parseInt(n[0]):1},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"slideMaster",{get:function(){return this.slideLayout&&this.slideLayout.slideMaster},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"theme",{get:function(){return this.slideMaster.theme},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"_relsPath",{get:function(){return this.name.replace("slides/slide","slides/_rels/slide")+".rels"},enumerable:!1,configurable:!0}),o.prototype.load=function(){return q(this,void 0,void 0,function(){return Y(this,function(n){switch(n.label){case 0:return[4,this._loadRels()];case 1:return n.sent(),this._loadBackground(),[4,this._loadNodes()];case 2:return n.sent(),[2]}})})},o.prototype._loadRels=function(){return q(this,void 0,void 0,function(){var n,i,a,s=this;return Y(this,function(h){switch(h.label){case 0:return i=$,[4,this.pptx.getXmlByPath(this._relsPath)];case 1:return n=i.apply(void 0,[h.sent()]),a=f.get(n,["Relationships","Relationship"])||[],Array.isArray(a)||(a=[a]),a.forEach(function(d){switch(f.get(d,["attrs","Type"])){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout":var u=d.attrs.Target.replace("../","ppt/");s.slideLayout=s.pptx.getSlideLayout(u);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image":case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/audio":case"http://schemas.microsoft.com/office/2007/relationships/media":case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/video":case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/diagramLayout":case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/diagramData":case"http://schemas.microsoft.com/office/2007/relationships/diagramDrawing":case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/diagramColors":s.rels[d.attrs.Id]={type:d.attrs.Type.split("/").pop(),target:d.attrs.Target.replace("../","ppt/")}}}),[2]}})})},o.prototype._loadBackground=function(){var n=f.get(this.source,["p:sld","p:cSld","p:bg","p:bgPr"]);n&&n["a:solidFill"]?this.background=V(n["a:solidFill"],this.theme,this):n&&n["a:gradFill"]?this.background=ft(n["a:gradFill"],this.theme,this):n&&n["a:blipFill"]&&(this.background=ut(n["a:blipFill"],this.pptx,this))},o.prototype._loadNodes=function(){return q(this,void 0,void 0,function(){var n;return Y(this,function(i){return n=f.get(this.source,["p:sld","p:cSld","p:spTree"]),wt(this.nodes,n,this.pptx,this),[2]})})},o.prototype.getColorThemeName=function(n){return this.slideLayout.getColorThemeName(n)},o.prototype.getNodeInheritAttrsByType=function(n,i){var a=this.slideLayout.getNodeByType(n),s=f.get(a.source,i);return s||this.slideLayout.getNodeInheritAttrsByType(n,i)},o.prototype.getNodeInheritAttrsByIdx=function(n,i){var a=this.slideLayout.getNodeByIdx(n),s=f.get(a.source,i);return s||this.slideLayout.getNodeInheritAttrsByIdx(n,i)},o}(),$e=function(){function o(n,i,a){this.slideType="slideLayout",this.rels={},this.background={type:"none"},this.nodes=[],this.name=n,this.source=i,this.pptx=a}return Object.defineProperty(o.prototype,"_relsPath",{get:function(){return this.name.replace("slideLayouts/slideLayout","slideLayouts/_rels/slideLayout")+".rels"},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"theme",{get:function(){return this.slideMaster.theme},enumerable:!1,configurable:!0}),o.prototype.load=function(){return q(this,void 0,void 0,function(){return Y(this,function(n){switch(n.label){case 0:return[4,this._loadRels()];case 1:return n.sent(),[4,this._loadBackground()];case 2:return n.sent(),[4,this._loadNodes()];case 3:return n.sent(),[2]}})})},o.prototype._loadRels=function(){return q(this,void 0,void 0,function(){var n,i,a,s=this;return Y(this,function(h){switch(h.label){case 0:return i=$,[4,this.pptx.getXmlByPath(this._relsPath)];case 1:return n=i.apply(void 0,[h.sent()]),a=f.get(n,["Relationships","Relationship"])||[],Array.isArray(a)||(a=[a]),a.forEach(function(d){switch(f.get(d,["attrs","Type"])){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster":var u=d.attrs.Target.replace("../","ppt/");s.slideMaster=s.pptx.getSlideMaster(u);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image":case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/audio":case"http://schemas.microsoft.com/office/2007/relationships/media":case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/video":s.rels[d.attrs.Id]={type:d.attrs.Type.split("/").pop(),target:d.attrs.Target.replace("../","ppt/")}}}),[2]}})})},o.prototype._loadBackground=function(){return q(this,void 0,void 0,function(){var n;return Y(this,function(i){return(n=f.get(this.source,["p:sldLayout","p:cSld","p:bg","p:bgPr"]))&&n["a:solidFill"]?this.background=V(n["a:solidFill"],this.theme):n&&n["a:gradFill"]?this.background=ft(n["a:gradFill"],this.theme,this):n&&n["a:blipFill"]&&(this.background=ut(n["a:blipFill"],this.pptx,this)),[2]})})},o.prototype._loadNodes=function(){return q(this,void 0,void 0,function(){var n;return Y(this,function(i){return n=f.get(this.source,["p:sldLayout","p:cSld","p:spTree"]),wt(this.nodes,n,this.pptx,this),[2]})})},o.prototype.getColorThemeName=function(n){return this.slideMaster.getColorThemeName(n)},o.prototype.getNodeByType=function(n){return this.nodes.find(function(i){return i.type===n})},o.prototype.getNodeByIdx=function(n){return this.nodes.find(function(i){return i.idx===n})},o.prototype.getNodeInheritAttrsByType=function(n,i){var a=this.slideMaster.getNodeByType(n);return a&&f.get(a.source,i)},o.prototype.getNodeInheritAttrsByIdx=function(n,i){var a=this.slideMaster.getNodeByIdx(n);return a&&f.get(a.source,i)},o}(),Je=function(){function o(n,i,a){this.slideType="slideMaster",this.rels={},this.background={type:"none"},this.textStyles={titleStyle:{},bodyStyle:{},otherStyle:{}},this.defaultTextStyle={},this.nodes=[],this.tableStyles={},this.name=n,this.source=i,this.pptx=a,this.load()}return Object.defineProperty(o.prototype,"_relsPath",{get:function(){return this.name.replace("slideMasters/slideMaster","slideMasters/_rels/slideMaster")+".rels"},enumerable:!1,configurable:!0}),o.prototype.load=function(){return q(this,void 0,void 0,function(){return Y(this,function(n){switch(n.label){case 0:return[4,this._parseRels()];case 1:return n.sent(),this._parseColorMap(),this._parseBackground(),this._parseTextStyles(),this._parseTableStyles(),this._parseDefaultTextStyle(),this._loadNodes(),[2]}})})},o.prototype._parseRels=function(){return q(this,void 0,void 0,function(){var n,i,a,s=this;return Y(this,function(h){switch(h.label){case 0:return i=$,[4,this.pptx.getXmlByPath(this._relsPath)];case 1:return n=i.apply(void 0,[h.sent()]),a=f.get(n,["Relationships","Relationship"])||[],Array.isArray(a)||(a=[a]),a.forEach(function(d){switch(f.get(d,["attrs","Type"])){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme":var u=d.attrs.Target.replace("../","ppt/");s.theme=s.pptx.getTheme(u);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image":case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/audio":case"http://schemas.microsoft.com/office/2007/relationships/media":case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/video":s.rels[d.attrs.Id]={type:d.attrs.Type.split("/").pop(),target:d.attrs.Target.replace("../","ppt/")}}}),[2]}})})},o.prototype._parseColorMap=function(){this.colorMap=f.omit(f.get(this.source,["p:sldMaster","p:clrMap","attrs"])||{},["order"])},o.prototype.getColorThemeName=function(n){return this.colorMap[n]||n},o.prototype._parseBackground=function(){var n=f.get(this.source,["p:sldMaster","p:cSld","p:bg","p:bgPr"]),i=f.get(this.source,["p:sldMaster","p:cSld","p:bg","p:bgRef"]);n&&n["a:solidFill"]?this.background=V(n["a:solidFill"],this.theme,this):n&&n["a:gradFill"]?this.background=ft(n["a:gradFill"],this.theme,this):n&&n["a:blipFill"]?this.background=ut(n["a:blipFill"],this.pptx,this):i&&(this.background=V(i,this.theme,this))},o.prototype._parseDefaultTextStyle=function(){var n=this,i=this.pptx.defaultTextStyleSource;Object.keys(i).forEach(function(a){if(a.startsWith("a:")&&a.endsWith("pPr")){var s=a.substr(2,a.length-5),h=f.get(i[a],["a:defRPr"]);n.defaultTextStyle[s]={props:ye(i[a]),defRPr:ge(h,n.theme,n)}}})},o.prototype._parseTextStyles=function(){var n=this,i=f.get(this.source,["p:sldMaster","p:txStyles"]);["titleStyle","bodyStyle","otherStyle"].forEach(function(a){var s=n.textStyles[a],h=f.get(i,"p:".concat(a))||{};Object.keys(h).forEach(function(d){if(d.startsWith("a:")&&d.endsWith("pPr")){var u=d.substr(2,d.length-5);s[u]={},s[u].props=ye(h[d]);var w=f.get(h[d],["a:defRPr"]);s[u].defRPr=ge(w,n.theme,n)}})})},o.prototype._parseTableStyles=function(){var n=this,i={},a=f.get(this.pptx.tableStyles,["a:tblStyleLst","a:tblStyle"])||[];Array.isArray(a)||(a=[a]),a.forEach(function(s){var h=f.get(s,["attrs","styleId"]);i[h]={},Object.keys(s).forEach(function(d){if(d.startsWith("a:")){var u=d.substr(2);i[h][u]={};var w=f.get(s[d],["a:tcStyle"]);if(w){var b={};f.get(w,["a:fill","a:solidFill"])&&(b.background=V(f.get(w,["a:fill","a:solidFill"]),n.theme,n));var y=f.get(w,"a:tcBdr");y&&(b.border={},Object.keys(y).forEach(function(L){if(L.startsWith("a:")){var C=L.substr(2),R=f.get(y[L],["a:ln"]);b.border[C]=it(R,n.theme,n)}})),i[h][u].tcStyle=b}var g=f.get(s[d],["a:tcTxStyle"]);if(g){var P={};P.color=V(g,n.theme,n),f.get(g,["attrs","b"])==="on"&&(P.bold=!0),i[h][u].tcTxStyle=P}}})}),this.tableStyles=i},o.prototype._loadNodes=function(){return q(this,void 0,void 0,function(){var n;return Y(this,function(i){return n=f.get(this.source,["p:sldMaster","p:cSld","p:spTree"]),wt(this.nodes,n,this.pptx,this),[2]})})},o.prototype.getNodeByType=function(n){return this.nodes.find(function(i){return i.type===n})},o.prototype.getNodeByIdx=function(n){return this.nodes.find(function(i){return i.idx===n})},o.prototype.getNodeInheritAttrsByType=function(n,i){},o.prototype.getNodeInheritAttrsByIdx=function(n,i){},o}(),Ke=function(){function o(n,i,a){this.clrScheme={},this.borderScheme=[],this.name=n,this.source=i,this.pptx=a,this._parseClrScheme(),this._parseLineStyleLst()}return o.prototype._parseClrScheme=function(){var n=f.get(this.source,["a:theme","a:themeElements","a:clrScheme"]);for(var i in n)if(i.startsWith("a:")){var a=i.substring(2),s=f.get(n[i],["a:sysClr","attrs","lastClr"])||f.get(n[i],["a:srgbClr","attrs","val"]);this.clrScheme[a]="#"+s}},o.prototype._parseLineStyleLst=function(){var n=this,i=f.get(this.source,["a:theme","a:themeElements","a:fmtScheme","a:lnStyleLst","a:ln"])||[];this.borderScheme=i.map(function(a){var s={color:{}};return f.get(a,["attrs","w"])&&(s.width=E(parseInt(f.get(a,["attrs","w"])))),f.get(a,["attrs","algn"])&&(s.algn=f.get(a,["attrs","algn"])),f.get(a,["attrs","cap"])&&(s.cap=f.get(a,["attrs","cap"])),f.get(a,["attrs","cmpd"])&&(s.cmpd=f.get(a,["attrs","cmpd"])),f.get(a,["a:miter","attrs","lim"])&&(s.miterLim=E(parseInt(f.get(a,["a:miter","attrs","lim"])))),f.get(a,["a:prstDash","attrs","val"])&&(s.type=f.get(a,["a:prstDash","attrs","val"])),f.get(a,["a:solidFill"])&&(s.color=V(f.get(a,["a:solidFill"]),n)),s})},o.prototype.getColor=function(n){if(n!=="phClr")return this.clrScheme[n]||this.defaultColor},o.prototype.getLineStyle=function(n){return this.borderScheme[n-1]},o}(),ta=function(){function o(){this.slides=[],this.slideLayouts=[],this.slideMaster=[],this.themes=[],this.medias={}}return o.prototype.load=function(n){return q(this,void 0,void 0,function(){var i,a;return Y(this,function(s){switch(s.label){case 0:return i=new Be,a=this,[4,i.loadAsync(n)];case 1:return a._zipContents=s.sent(),[4,this._loadThumbnail()];case 2:return s.sent(),[4,this._loadMedia()];case 3:return s.sent(),[4,this._loadPresentation()];case 4:return s.sent(),[4,this._loadContentTypes()];case 5:return s.sent(),[2]}})})},o.prototype._loadThumbnail=function(){return q(this,void 0,void 0,function(){var n;return Y(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),this._zipContents.files["docProps/thumbnail.jpeg"]?[4,this._zipContents.files["docProps/thumbnail.jpeg"].async("base64")]:[3,2];case 1:n=i.sent(),this.thumbnail="data:image/jpeg;base64,"+n,i.label=2;case 2:return[3,4];case 3:return i.sent(),[3,4];case 4:return[2]}})})},o.prototype._loadPresentation=function(){return q(this,void 0,void 0,function(){var n,i,a;return Y(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,this._zipContents.files["ppt/presentation.xml"].async("text")];case 1:return n=s.sent(),i=$(n),a=i["p:presentation"]["p:sldSz"].attrs,this.width=E(parseInt(a.cx)),this.height=E(parseInt(a.cy)),this.defaultTextStyleSource=f.get(i,["p:presentation","p:defaultTextStyle"]),[3,3];case 2:return s.sent(),[3,3];case 3:return[2]}})})},o.prototype._loadContentTypes=function(){return q(this,void 0,void 0,function(){var n,i,a,s,h,d,u,w,b,y,g,P,L,C,R,j,c,t,r,e,l;return Y(this,function(p){switch(p.label){case 0:return p.trys.push([0,22,,23]),i=$,[4,this._zipContents.files["[Content_Types].xml"].async("text")];case 1:if(n=i.apply(void 0,[p.sent()]),a=n.Types.Override,!(s=a.filter(function(v){return v.attrs.ContentType==="application/vnd.openxmlformats-officedocument.theme+xml"})))return[3,5];h=0,d=s,p.label=2;case 2:return h<d.length?(u=d[h],t=u.attrs.PartName.substr(1),w=$,[4,this._zipContents.files[t].async("text")]):[3,5];case 3:r=w.apply(void 0,[p.sent()]),this.themes.push(new Ke(t,r,this)),p.label=4;case 4:return h++,[3,2];case 5:return(b=a.find(function(v){return v.attrs.ContentType==="application/vnd.openxmlformats-officedocument.presentationml.tableStyles+xml"}))?(t=b.attrs.PartName.substr(1),y=$,[4,this._zipContents.files[t].async("text")]):[3,7];case 6:r=y.apply(void 0,[p.sent()]),this.tableStyles=r,p.label=7;case 7:g=a.filter(function(v){return v.attrs.ContentType==="application/vnd.openxmlformats-officedocument.presentationml.slideMaster+xml"}),c=0,p.label=8;case 8:return c<g.length?(t=g[c].attrs.PartName.substr(1),P=$,[4,this._zipContents.files[t].async("text")]):[3,11];case 9:r=P.apply(void 0,[p.sent()]),this.slideMaster.push(new Je(t,r,this)),p.label=10;case 10:return c++,[3,8];case 11:L=a.filter(function(v){return v.attrs.ContentType==="application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml"}),c=0,p.label=12;case 12:return c<L.length?(t=L[c].attrs.PartName.substr(1),C=$,[4,this._zipContents.files[t].async("text")]):[3,16];case 13:return r=C.apply(void 0,[p.sent()]),[4,(R=new $e(t,r,this)).load()];case 14:p.sent(),this.slideLayouts.push(R),p.label=15;case 15:return c++,[3,12];case 16:j=a.filter(function(v){return v.attrs.ContentType==="application/vnd.openxmlformats-officedocument.presentationml.slide+xml"}),c=0,p.label=17;case 17:return c<j.length?(t=j[c].attrs.PartName.substr(1),e=$,[4,this._zipContents.files[t].async("text")]):[3,21];case 18:return r=e.apply(void 0,[p.sent()]),[4,(l=new Ye(t,r,this)).load()];case 19:p.sent(),this.slides.push(l),p.label=20;case 20:return c++,[3,17];case 21:return this.slides.sort(function(v,x){return v.index-x.index}),[3,23];case 22:return p.sent(),[3,23];case 23:return[2]}})})},o.prototype._loadMedia=function(){return q(this,void 0,void 0,function(){var n,i,a,s,h,d,u,w,b,y,g,P=this;return Y(this,function(L){switch(L.label){case 0:n=Object.keys(this._zipContents.files).filter(function(R){return R.startsWith("ppt/media/image")}).map(function(R){return P._zipContents.files[R]}),i=0,a=n,L.label=1;case 1:return i<a.length?(s=a[i],h=function(R){var j;switch(R){case"jpg":case"jpeg":j="image/jpeg";break;case"png":j="image/png";break;case"gif":j="image/gif";break;case"emf":j="image/x-emf";break;case"wmf":j="image/x-wmf";break;default:j="image/*"}return j}((C=s.name).substr(2+(~-C.lastIndexOf(".")>>>0))),[4,s.async("base64")]):[3,4];case 2:d=L.sent(),this.medias[s.name]="data:".concat(h,";base64,").concat(d),L.label=3;case 3:return i++,[3,1];case 4:u=Object.keys(this._zipContents.files).filter(function(R){return R.startsWith("ppt/media/media")&&["mp3","wav","ogg","mp4","webm"].includes(R.split(".").pop().toLowerCase())}).map(function(R){return P._zipContents.files[R]}),w=0,b=u,L.label=5;case 5:return w<b.length?[4,(y=b[w]).async("blob")]:[3,8];case 6:g=L.sent(),this.medias[y.name]=URL.createObjectURL(g),L.label=7;case 7:return w++,[3,5];case 8:return[2]}var C})})},o.prototype.getXmlByPath=function(n){return q(this,void 0,void 0,function(){return Y(this,function(i){switch(i.label){case 0:if(!this._zipContents.files[n])throw new Error("文件不存在");return[4,this._zipContents.files[n].async("text")];case 1:return[2,i.sent()]}})})},o.prototype.getSlideLayout=function(n){return this.slideLayouts.find(function(i){return i.name===n})},o.prototype.getSlideMaster=function(n){return this.slideMaster.find(function(i){return i.name===n})},o.prototype.getTheme=function(n){return this.themes.find(function(i){return i.name===n})},o.prototype.getMedia=function(n){return this.medias[n]},o}();function le(o){var n=o.extend,i=o.offset,a=o.clip,s=o.base64,h=o.audioFile,d=o.videoFile,u=document.createElement("div");u.style.setProperty("position","absolute"),u.style.setProperty("left",i.x+"px"),u.style.setProperty("top",i.y+"px");var w,b,y,g,P=document.createElement("div");P.style.setProperty("position","absolute"),P.style.setProperty("left","0"),P.style.setProperty("top","0"),P.style.setProperty("width",n.w+"px"),P.style.setProperty("height",n.h+"px"),P.style.setProperty("overflow","hidden"),a?(w=n.w/(1-(a.l===void 0?0:a.l)-(a.r===void 0?0:a.r)),b=n.h/(1-(a.t===void 0?0:a.t)-(a.b===void 0?0:a.b)),y=-1*w*(a.l===void 0?0:a.l),g=-1*b*(a.t===void 0?0:a.t)):(w=n.w,b=n.h,y=0);var L=document.createElement("img");if(L.src=s,L.width=w,L.height=b,L.style.setProperty("position","absolute"),L.style.setProperty("left",y+"px"),L.style.setProperty("top",g+"px"),P.append(L),u.append(P),h){var C=document.createElement("audio");C.style.position="absolute",C.style.left="0",C.style.top="0",C.src=h,C.controls=!0,C.style.transform="translate(-50%)",u.append(C)}if(d){var R=document.createElement("video");R.style.position="absolute",R.style.left="0",R.style.top="0",R.width=n.w,R.height=n.h,R.src=d,R.controls=!0,u.append(R)}return u}function ea(o,n,i){var a,s=o.props,h=o.text,d=S(S({},n),s),u=document.createElement("span");u.innerHTML=h;var w=18;d.size&&(!((a=i==null?void 0:i.normAutofit)===null||a===void 0)&&a.fontScale?(w=d.size*i.normAutofit.fontScale,u.style.fontSize=w+"px"):(w=d.size,u.style.fontSize=w+"px"));var b=z(d.color);if(b&&(u.style.color=b),d.typeface){u.style.fontFamily=d.typeface;var y=/^[^\u4e00-\u9fff]+$/;switch(d.typeface){case"DengXian":y.test(h)&&(u.style.letterSpacing=-.04*w+"px");break;case"DengXian Light":y.test(h)&&(u.style.letterSpacing=-.05*w+"px");break;case"STLiti":case"SimSun":case"NSimSun":case"SimHei":y.test(h)&&(u.style.fontSize=.85*parseInt(u.style.fontSize)+"px");break;case"华文中宋":u.style.fontSize=.85*parseInt(u.style.fontSize)+"px";break;case"FangSong":u.style.letterSpacing=-.08*w+"px"}}return d.bold&&(u.style.fontWeight="bold"),d.italic&&(u.style.fontStyle="italic"),d.underline&&d.underline!=="none"&&(u.style.textDecoration="underline"),d.background&&(u.style.backgroundColor=z(d.background)),u.style.wordBreak="normal",u}function aa(o,n,i){var a=document.createElement("span"),s=o.firstElementChild;switch(a.style.fontSize=s.style.fontSize,a.style.color=s.style.color,a.style.fontWeight=s.style.fontWeight,a.style.fontStyle=s.style.fontStyle,a.style.marginRight="10px",n.buAutoNum){case"arabicPeriod":default:a.textContent=i+".";break;case"circleNumDbPlain":a.textContent=["①","②","③","④","⑤","⑥","⑦","⑧","⑨","⑩","⑪","⑫","⑬","⑭","⑮","⑯","⑰","⑱","⑲","⑳"][i-1]||i+"";break;case"romanUcPeriod":a.textContent=function(h){var d=[{value:1e3,numeral:"M"},{value:900,numeral:"CM"},{value:500,numeral:"D"},{value:400,numeral:"CD"},{value:100,numeral:"C"},{value:90,numeral:"XC"},{value:50,numeral:"L"},{value:40,numeral:"XL"},{value:10,numeral:"X"},{value:9,numeral:"IX"},{value:5,numeral:"V"},{value:4,numeral:"IV"},{value:1,numeral:"I"}];if(typeof h!="number"||h<1||h>3999)throw new Error("Input must be a number between 1 and 3999.");for(var u="",w=0;w<d.length;w++)for(;h>=d[w].value;)u+=d[w].numeral,h-=d[w].value;return u}(i)+".";break;case"alphaUcPeriod":a.textContent=re(i)+".";break;case"alphaLcPeriod":a.textContent=re(i).toLowerCase()+".";break;case"alphaLcParenR":a.textContent=re(i).toLowerCase()+")";break;case"ea1JpnChsDbPeriod":a.textContent=function(h){var d=["〇","一","二","三","四","五","六","七","八","九"];if(!Number.isInteger(h)||h<0)return"";for(var u="",w=h.toString(),b=0;b<w.length;b++)u+=d[parseInt(w[b],10)];return u}(i)+"."}o.prepend(a)}function Lt(o,n,i){var a,s,h,d;n===void 0&&(n=0),i===void 0&&(i={});var u=o.inheritProps,w=o.inheritRProps,b=o.props,y=o.rows,g=S(S({},u),b),P=function(){for(var p,v,x=0,m=0,_=y;m<_.length;m++){var k=_[m];k.props&&k.props.size&&(x=Math.max(x,k.props.size))}var I=((v=(p=i==null?void 0:i.bodyProps)===null||p===void 0?void 0:p.normAutofit)===null||v===void 0?void 0:v.fontScale)||1;return(x||w.size||18)*I},L=document.createElement("div"),C=i.isFirst?0:g.spaceBefore||0,R=i.isLast?0:g.spaceAfter||0;L.style.margin="".concat(Math.floor(.2*P()),"px  0 0 0"),L.style.padding="".concat(Math.floor(C),"px 0px ").concat(Math.floor(R),"px 0px");var j=document.createElement("p");j.style.margin="0",j.style.padding="0px",j.style.wordBreak="break-word",j.style.textAlign=g.align&&{ctr:"center",l:"left",r:"right",dist:"justify"}[g.align]||"center",g.align==="dist"&&(j.style.textAlignLast="justify");var c=g.hasOwnProperty("lineHeight")?g.lineHeight:1;if(!((s=(a=i.bodyProps)===null||a===void 0?void 0:a.normAutofit)===null||s===void 0)&&s.lnSpcReduction&&(c*=1-((d=(h=i.bodyProps)===null||h===void 0?void 0:h.normAutofit)===null||d===void 0?void 0:d.lnSpcReduction)),j.style.lineHeight=c+"",j.style.fontSize=P()+"px",y.length){for(var t=0,r=y;t<r.length;t++){var e=r[t];j.appendChild(ea(e,S(S({},w),{marginTop:Math.floor(.2*P())}),i.bodyProps))}g.buAutoNum?aa(j,g,n):g.buChar&&function(p,v){var x=document.createElement("span"),m=p.firstElementChild;x.style.color=m.style.color,x.style.fontSize=m.style.fontSize,x.textContent={n:"■",l:"●",u:"◆",p:"□",ü:"✔",Ø:"➢","•":"•"}[v.buChar]||"■",x.style.marginRight="10px",p.prepend(x)}(j,g),j.style.paddingLeft=(g.marginLeft||0)+(g.indent||0)+"px"}else{var l=document.createElement("span");l.innerHTML="&nbsp;",l.style.fontSize=w.size+"px",j.appendChild(l)}return L.appendChild(j),L}var Re="http://www.w3.org/2000/svg";function A(o){return document.createElementNS(Re,o)}function tt(o){var n=o.extend;return .16667*Math.min(n.w,n.h)}function T(o,n,i){i===void 0&&(i=0);var a=n.prstGeom,s=((a==null?void 0:a.gd)||[]).find(function(h){return h.name===o});return s?s.fmla:i}function M(o,n,i){i===void 0&&(i=0);var a=n.extend,s=n.prstGeom,h=((s==null?void 0:s.gd)||[]).find(function(d){return d.name===o});return h?Math.min(a.w,a.h)*h.fmla:i}function be(o,n,i){i===void 0&&(i=0);var a=n.extend,s=n.prstGeom,h=((s==null?void 0:s.gd)||[]).find(function(d){return d.name===o});return h?Math.max(a.w,a.h)*h.fmla:i}function K(o,n){var i=0;switch(o){case"sm":i=1*n;break;case"med":i=1.5*n;break;case"lg":i=2.5*n}return Math.max(i,2)}function me(o,n,i,a){a===void 0&&(a=!1);var s=o.border,h=s===void 0?{}:s,d=o.uuid,u=h.headEnd,w=h.width,b=h.color,y=h.tailEnd,g=a?u:y,P=g.len,L=P===void 0?"med":P,C=g.w,R=C===void 0?"med":C,j=K(L,w),c=K(R,w),t=A("defs"),r=A("marker"),e="marker-".concat(d,"-").concat(a?"start":"end");r.setAttribute("id",e),r.setAttribute("viewBox","0 0 ".concat(2*j," ").concat(2*c)),r.setAttribute("refX",j+"px"),r.setAttribute("refY",c+"px"),r.setAttribute("markerWidth",2*j+"px"),r.setAttribute("markerHeight",2*c+"px"),r.setAttribute("orient","auto"),r.setAttribute("markerUnits","userSpaceOnUse");var l=A("ellipse");l.setAttribute("cx",j+"px"),l.setAttribute("cy",c+"px"),l.setAttribute("rx",j+"px"),l.setAttribute("ry",c+"px"),l.setAttribute("fill",z(b)||"transparent"),r.appendChild(l),t.appendChild(r),n.appendChild(t),i.setAttribute(a?"marker-start":"marker-end","url(#".concat(e,")"))}function xe(o,n,i,a){a===void 0&&(a=!1);var s=o.border,h=s===void 0?{}:s,d=o.uuid,u=h.headEnd,w=h.width,b=h.color,y=h.tailEnd,g=a?u:y,P=g.len,L=P===void 0?"med":P,C=g.w,R=C===void 0?"med":C,j=K(L,w),c=K(R,w),t=A("defs"),r=A("marker"),e="marker-".concat(d,"-").concat(a?"start":"end");r.setAttribute("id",e),r.setAttribute("viewBox","0 0 ".concat(2*j," ").concat(2*c)),r.setAttribute("refX",(a?.9*j:1.1*j)+"px"),r.setAttribute("refY",c+"px"),r.setAttribute("markerWidth",2*j+"px"),r.setAttribute("markerHeight",2*c+"px"),r.setAttribute("orient","auto"),r.setAttribute("markerUnits","userSpaceOnUse");var l=A("path"),p=a?["M ".concat(2*j,",0"),"L 0,".concat(c),"L ".concat(2*j,",").concat(2*c),"Z"].join(" "):["M 0,0","L ".concat(2*j,",").concat(c),"L 0,".concat(2*c),"Z"].join(" ");l.setAttribute("d",p),l.setAttribute("fill",z(b)||"transparent"),r.appendChild(l),t.appendChild(r),n.appendChild(t),i.setAttribute(a?"marker-start":"marker-end","url(#".concat(e,")"))}function Le(o,n,i,a){a===void 0&&(a=!1);var s=o.border,h=s===void 0?{}:s,d=o.uuid,u=h.headEnd,w=h.width,b=h.color,y=h.tailEnd,g=a?u:y,P=g.len,L=P===void 0?"med":P,C=g.w,R=C===void 0?"med":C,j=K(L,w),c=K(R,w),t=A("defs"),r=A("marker"),e="marker-".concat(d,"-").concat(a?"start":"end");r.setAttribute("id",e),r.setAttribute("viewBox","0 0 ".concat(2*j," ").concat(2*c)),r.setAttribute("refX",j+"px"),r.setAttribute("refY",c+"px"),r.setAttribute("markerWidth",2*j+"px"),r.setAttribute("markerHeight",2*c+"px"),r.setAttribute("orient","auto"),r.setAttribute("markerUnits","userSpaceOnUse");var l=A("path"),p=["M 0,".concat(c),"L ".concat(j,",0"),"L ".concat(2*j,",").concat(c),"L ".concat(j,",").concat(2*c),"Z"].join(" ");l.setAttribute("d",p),l.setAttribute("fill",z(b)||"transparent"),r.appendChild(l),t.appendChild(r),n.appendChild(t),i.setAttribute(a?"marker-start":"marker-end","url(#".concat(e,")"))}function Me(o,n,i,a){a===void 0&&(a=!1);var s=o.border,h=s===void 0?{}:s,d=o.uuid,u=h.headEnd,w=h.width,b=h.color,y=h.tailEnd,g=a?u:y,P=g.len,L=P===void 0?"med":P,C=g.w,R=C===void 0?"med":C,j=K(L,w),c=K(R,w),t=A("defs"),r=A("marker"),e="marker-".concat(d,"-").concat(a?"start":"end");r.setAttribute("id",e),r.setAttribute("viewBox","0 0 ".concat(2*j+2*w," ").concat(2*c+2*w));var l=a?R==="lg"?2*w:3*w:R==="lg"?2*j:2*j-w;r.setAttribute("refX",l+"px"),r.setAttribute("refY",c+w+"px"),r.setAttribute("markerWidth",2*j+"px"),r.setAttribute("markerHeight",2*c+"px"),r.setAttribute("orient","auto"),r.setAttribute("markerUnits","userSpaceOnUse");var p=A("path"),v=a?["M ".concat(2*j+w,", ").concat(w),"L ".concat(w,",").concat(c+w),"L ".concat(2*j+w,",").concat(2*c+w)].join(" "):["M ".concat(w,", ").concat(w),"L ".concat(2*j+w,",").concat(c+w),"L ".concat(w,",").concat(2*c+w)].join(" ");p.setAttribute("d",v),p.setAttribute("stroke-width",w+"px"),p.setAttribute("stroke",z(b)||"transparent"),p.setAttribute("fill","transparent"),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","miter"),p.style.overflow="visible",r.appendChild(p),t.appendChild(r),n.appendChild(t),i.setAttribute(a?"marker-start":"marker-end","url(#".concat(e,")"))}function Ae(o,n,i,a){a===void 0&&(a=!1);var s=o.border,h=s===void 0?{}:s,d=o.uuid,u=h.headEnd,w=h.width,b=h.color,y=h.tailEnd,g=a?u:y,P=g.len,L=P===void 0?"med":P,C=g.w,R=C===void 0?"med":C,j=K(L,w),c=K(R,w),t=A("defs"),r=A("marker"),e="marker-".concat(d,"-").concat(a?"start":"end");r.setAttribute("id",e),r.setAttribute("viewBox","0 0 ".concat(2*j," ").concat(2*c));var l=a?R==="sm"?1.5*w:2*w:R==="sm"?2*j-1.5*w:2*j-2*w;r.setAttribute("refX",l+"px"),r.setAttribute("refY",c+"px"),r.setAttribute("markerWidth",2*j+"px"),r.setAttribute("markerHeight",2*c+"px"),r.setAttribute("orient","auto"),r.setAttribute("markerUnits","userSpaceOnUse");var p=A("path"),v=a?["M 0, ".concat(c),"L ".concat(2*j,",0"),"L ".concat(j,",").concat(c),"L ".concat(2*j,",").concat(2*c),"Z"].join(" "):["M 0,0","L ".concat(2*j,",").concat(c),"L 0,".concat(2*c),"L ".concat(j,",").concat(c),"Z"].join(" ");p.setAttribute("d",v),p.setAttribute("fill",z(b)||"transparent"),p.style.overflow="visible",r.appendChild(p),t.appendChild(r),n.appendChild(t),i.setAttribute(a?"marker-start":"marker-end","url(#".concat(e,")"))}function lt(o,n,i){var a=o.border,s=a===void 0?{}:a;o.extend;var h=s.headEnd,d=s.tailEnd;if(h&&h.type!=="none")switch(h.type){case"triangle":xe(o,n,i,!0);break;case"oval":me(o,n,i,!0);break;case"diamond":Le(o,n,i,!0);break;case"arrow":Me(o,n,i,!0);break;case"stealth":Ae(o,n,i,!0)}if(d&&d.type!=="none")switch(d.type){case"triangle":xe(o,n,i,!1);break;case"oval":me(o,n,i,!1);break;case"diamond":Le(o,n,i,!1);break;case"arrow":Me(o,n,i,!1);break;case"stealth":Ae(o,n,i,!1)}}function je(o){var n=o.extend,i=A("rect");return i.setAttribute("x","0"),i.setAttribute("y","0"),i.setAttribute("width",n.w+"px"),i.setAttribute("height",n.h+"px"),i}function nt(o,n,i,a,s){var h=o*Math.PI/180;return[h===0||h===2*Math.PI?n+a:h===Math.PI?n-a:h===Math.PI/2||h===3*Math.PI/2?n:h>0&&h<Math.PI/2||h>3*Math.PI/2&&h<2*Math.PI?n+Math.sqrt(1/(1/Math.pow(a,2)+Math.pow(Math.tan(h),2)/Math.pow(s,2))):n-Math.sqrt(1/(1/Math.pow(a,2)+Math.pow(Math.tan(h),2)/Math.pow(s,2))),h===0||h===2*Math.PI||h===Math.PI?i:h===Math.PI/2?i+s:h===3*Math.PI/2?i-s:h>Math.PI&&h<2*Math.PI?i-Math.sqrt(1/(1/Math.pow(s,2)+Math.pow(1/Math.tan(h),2)/Math.pow(a,2))):i+Math.sqrt(1/(1/Math.pow(s,2)+Math.pow(1/Math.tan(h),2)/Math.pow(a,2)))]}function yt(o,n){var i=0;return(n>o&&n-o>180||n<o&&o-n<180)&&(i=1),i}function dt(o){var n=o.extend,i=.146*n.w,a=.146*n.h;return{top:a,bottom:a,left:i,right:i,w:n.w-2*i,h:n.h-2*a}}function de(o){var n=o.extend,i=o.offset,a=o.border,s=o.background,h=o.rotate,d=o.flipH,u=o.flipV,w=document.createElement("div"),b=i.x,y=i.y;w.className="shape-wrapper shape-".concat(o.shape),w.style.setProperty("position","absolute"),w.style.setProperty("width",(n.w||1)+"px"),w.style.setProperty("height",(n.h||1)+"px"),w.style.setProperty("left",b+"px"),w.style.setProperty("top",y+"px");var g,P=document.createElementNS(Re,"svg");P.style.setProperty("position","absolute"),P.setAttribute("width","100%"),P.setAttribute("height","100%"),P.style.setProperty("left","0"),P.style.setProperty("top","0"),P.style.overflow="visible";var L={left:0,top:0,right:0,bottom:0,w:n.w,h:n.h},C=!0;switch(o.shape){case"customGeom":g=function(c){var t=c.prstGeom,r=t===void 0?{}:t,e=c.extend,l=r.pathList,p=r.w,v=r.h,x=A("path"),m={moveTo:"M",lnTo:"L",cubicBezTo:"C",close:"Z"},_=e.w/p,k=e.h/v,I=l.map(function(B){var O=m[B.type],D=Array.isArray(B.points)?B.points.map(function(N){return"".concat(N[0]*_,",").concat(N[1]*k)}).join(" "):"";return D?"".concat(O," ").concat(D):"".concat(O)}).join(" ");return x.setAttribute("d",I),x.style.fillRule="evenodd",x}(o),lt(o,P,g);break;case"flowChartProcess":case"rect":g=je(o);break;case"snip1Rect":g=function(c){var t=c.extend,r=A("polygon"),e=M("adj",c,tt(c)),l=["0,0","".concat(t.w-e,",0"),"".concat(t.w,",").concat(e),"".concat(t.w,",").concat(t.h),"0,".concat(t.h)].join(" ");return r.setAttribute("points",l),r}(o);break;case"snip2SameRect":g=function(c){var t=c.extend,r=A("polygon"),e=M("adj1",c,tt(c)),l=M("adj2",c,0),p=[[e,0],[t.w-e,0],[t.w,e],[t.w,t.h-l],[t.w-l,t.h],[l,t.h],[0,t.h-l],[0,e]].map(function(v){return"".concat(v[0],",").concat(v[1])}).join(" ");return r.setAttribute("points",p),r}(o);break;case"snip2DiagRect":g=function(c){var t=c.extend,r=A("polygon"),e=M("adj1",c,0),l=M("adj2",c,tt(c)),p=[[e,0],[t.w-l,0],[t.w,l],[t.w,t.h-e],[t.w-e,t.h],[l,t.h],[0,t.h-l],[0,e]].map(function(v){return"".concat(v[0],",").concat(v[1])}).join(" ");return r.setAttribute("points",p),r}(o);break;case"snipRoundRect":g=function(c){var t=c.extend,r=A("path"),e=M("adj1",c,tt(c)),l=M("adj2",c,tt(c)),p=["M ".concat(e,",0"),"L ".concat(t.w-l,",0"),"L ".concat(t.w,",").concat(l),"L ".concat(t.w,",").concat(t.h),"L 0,".concat(t.h),"L 0,".concat(e),"Q 0,0 ".concat(e,",0"),"Z"].join(" ");return r.setAttribute("d",p),r}(o);break;case"roundRect":g=function(c){var t=je(c),r=M("adj",c,tt(c));return t.setAttribute("rx",r+"px"),t.setAttribute("ry",r+"px"),t}(o);break;case"round1Rect":g=function(c){var t=c.extend,r=A("path"),e=M("adj",c,tt(c)),l=["M 0,0","L ".concat(t.w-e,",0"),"Q ".concat(t.w,",0 ").concat(t.w,",").concat(e),"L ".concat(t.w,",").concat(t.h),"L 0,".concat(t.h),"Z"].join(" ");return r.setAttribute("d",l),r}(o);break;case"round2SameRect":g=function(c){var t=c.extend,r=A("path"),e=M("adj1",c,tt(c)),l=M("adj2",c,0),p=["M ".concat(e,",0"),"L ".concat(t.w-e,",0"),"Q ".concat(t.w,",0 ").concat(t.w,",").concat(e),"L ".concat(t.w,",").concat(t.h-l),"Q ".concat(t.w,",").concat(t.h," ").concat(t.w-l,",").concat(t.h),"L ".concat(l,",").concat(t.h),"Q 0,".concat(t.h," 0,").concat(t.h-l),"L 0,".concat(e),"Q 0,0 ".concat(e,",0"),"Z"].join(" ");return r.setAttribute("d",p),r}(o);break;case"round2DiagRect":g=function(c){var t=c.extend,r=A("path"),e=M("adj1",c,tt(c)),l=M("adj2",c,0),p=["M ".concat(e,",0"),"L ".concat(t.w-l,",0"),"Q ".concat(t.w,",0 ").concat(t.w,",").concat(l),"L ".concat(t.w,",").concat(t.h-e),"Q ".concat(t.w,",").concat(t.h," ").concat(t.w-e,",").concat(t.h),"L ".concat(l,",").concat(t.h),"Q 0,".concat(t.h," 0,").concat(t.h-l),"L 0,".concat(e),"Q 0,0 ".concat(e,",0"),"Z"].join(" ");return r.setAttribute("d",p),r}(o);break;case"triangle":g=function(c){var t=c.extend,r=A("polygon"),e=["".concat(t.w/2,",0"),"0,".concat(t.h),"".concat(t.w,",").concat(t.h)].join(" ");return r.setAttribute("points",e),r}(o);break;case"rtTriangle":g=function(c){var t=c.extend,r=A("polygon"),e=["0,".concat(t.h),"0,0","".concat(t.w,",").concat(t.h)].join(" ");return r.setAttribute("points",e),r}(o);break;case"ellipse":g=function(c){var t=c.extend,r=A("ellipse"),e=t.w/2,l=t.h/2,p=e,v=l;return r.setAttribute("cx",e+"px"),r.setAttribute("cy",l+"px"),r.setAttribute("rx",p+"px"),r.setAttribute("ry",v+"px"),r}(o);break;case"line":g=function(c){var t=c.extend,r=A("path"),e=["M 0,0","L ".concat(t.w,",").concat(t.h)].join(" ");return r.setAttribute("d",e),r}(o),lt(o,P,g),C=!1;break;case"straightConnector1":g=function(c){var t=c.extend,r=A("path"),e=["M 0,0","L ".concat(t.w,",").concat(t.h)].join(" ");return r.setAttribute("d",e),r}(o),lt(o,P,g),C=!1;break;case"bentConnector3":g=function(c){var t=c.extend,r=A("path"),e=be("adj1",c,.5*Math.max(t.w,t.h)),l=["M 0,0","L ".concat(e,",0"),"L ".concat(e,",").concat(t.h),"L ".concat(t.w,",").concat(t.h)].join(" ");return r.setAttribute("d",l),r}(o),lt(o,P,g),C=!1;break;case"curvedConnector3":g=function(c){var t=c.extend,r=A("path"),e=be("adj1",c,.5*Math.max(t.w,t.h)),l=["M0,0","Q".concat(e,",0 ").concat(e,",").concat(t.h/2),"T".concat(t.w,",").concat(t.h)].join(" ");return r.setAttribute("d",l),r}(o),lt(o,P,g),C=!1;break;case"parallelogram":g=function(c){var t=c.extend,r=A("path"),e=M("adj",c,.5*Math.min(t.w,t.h)),l=["M".concat(e,",0"),"L".concat(t.w,",0"),"L".concat(t.w-e,",").concat(t.h),"L0,".concat(t.h),"Z"].join(" ");return r.setAttribute("d",l),r}(o),L=function(c){var t=c.extend,r=M("adj",c,.5*Math.min(t.w,t.h)),e=.84*(t.w-r),l=.08*t.h+r/t.w*t.h*.42;return{top:l,bottom:l,left:(t.w-e)/2,right:(t.w-e)/2,w:e,h:t.h-2*l}}(o);break;case"trapezoid":g=function(c){var t=c.extend,r=A("path"),e=M("adj",c,.25*Math.min(t.w,t.h)),l=["M".concat(e,",0"),"L".concat(t.w-e,",0"),"L".concat(t.w,",").concat(t.h),"L0,".concat(t.h),"Z"].join(" ");return r.setAttribute("d",l),r}(o),L=function(c){var t=c.extend,r=M("adj",c,.5*Math.min(t.w,t.h)),e=r/t.w*.66*t.h,l=.66*r;return{top:e,bottom:0,left:l,right:l,w:t.w-2*l,h:t.h-e}}(o);break;case"diamond":g=function(c){var t=c.extend,r=A("path"),e=["M".concat(t.w/2,",0"),"L".concat(t.w,",").concat(t.h/2),"L".concat(t.w/2,",").concat(t.h),"L0,".concat(t.h/2),"Z"].join(" ");return r.setAttribute("d",e),r}(o),L=function(c){var t=c.extend,r=.25*t.h,e=.25*t.w;return{top:r,bottom:r,left:e,right:e,w:.5*t.w,h:.5*t.h}}(o);break;case"pentagon":g=function(c){var t=c.extend,r=A("path"),e=["M".concat(t.w/2,",0"),"L".concat(t.w,",").concat(.3771*t.h),"L".concat(.808*t.w,",").concat(t.h),"L".concat(.192*t.w,",").concat(t.h),"L0,".concat(.3771*t.h),"Z"].join(" ");return r.setAttribute("d",e),r}(o),L=function(c){var t=c.extend,r=.227*t.h,e=.192*t.w;return{top:r,bottom:0,left:e,right:e,w:.616*t.w,h:.773*t.h}}(o);break;case"hexagon":g=function(c){var t=c.extend,r=A("path"),e=M("adj",c,.25*Math.min(t.w,t.h)),l=["M".concat(e,",0"),"L".concat(t.w-e,",0"),"L".concat(t.w,",").concat(t.h/2),"L".concat(t.w-e,",").concat(t.h),"L".concat(e,",").concat(t.h),"L0,".concat(t.h/2),"Z"].join(" ");return r.setAttribute("d",l),r}(o),L=function(c){var t=c.extend,r=M("adj",c,.25*Math.min(t.w,t.h)),e=.098*t.h+r/t.w*.38*t.h,l=.088*t.w+.422*r;return{top:e,bottom:e,left:l,right:l,w:t.w-2*l,h:t.h-2*e}}(o);break;case"heptagon":g=function(c){var t=c.extend,r=A("path"),e=["M".concat(t.w/2,",0"),"L".concat(.9*t.w,",").concat(.2*t.h),"L".concat(t.w,",").concat(.642*t.h),"L".concat(.722*t.w,",").concat(t.h),"L".concat(.278*t.w,",").concat(t.h),"L0,".concat(.642*t.h),"L".concat(.1*t.w,",").concat(.2*t.h),"Z"].join(" ");return r.setAttribute("d",e),r}(o),L=function(c){var t=c.extend;return{top:.2*t.h,bottom:.2*t.h,left:.1*t.w,right:.1*t.w,w:.8*t.w,h:.6*t.h}}(o);break;case"octagon":g=function(c){var t=c.extend,r=A("path"),e=M("adj",c,.29*Math.min(t.w,t.h)),l=["M".concat(e,",0"),"L".concat(t.w-e,",0"),"L".concat(t.w,",").concat(e),"L".concat(t.w,",").concat(t.h-e),"L".concat(t.w-e,",").concat(t.h),"L".concat(e,",").concat(t.h),"L0,".concat(t.h-e),"L0,".concat(e),"Z"].join(" ");return r.setAttribute("d",l),r}(o),L=function(c){var t=c.extend,r=M("adj",c,.29*Math.min(t.w,t.h));return{top:.5*r,bottom:.5*r,left:.5*r,right:.5*r,w:t.w-r,h:t.h-r}}(o);break;case"decagon":g=function(c){var t=c.extend,r=A("path"),e=.344,l=.117,p=.19,v=["M".concat(t.w*e,",0"),"L".concat(.656*t.w,",0"),"L".concat(.883*t.w,",").concat(t.h*p),"L".concat(t.w,",").concat(.5*t.h),"L".concat(.883*t.w,",").concat(.81*t.h),"L".concat(.656*t.w,",").concat(t.h),"L".concat(t.w*e,",").concat(t.h),"L".concat(t.w*l,",").concat(.81*t.h),"L0,".concat(.5*t.h),"L".concat(t.w*l,",").concat(t.h*p),"Z"].join(" ");return r.setAttribute("d",v),r}(o),L=function(c){var t=c.extend,r=.117,e=.19;return{top:t.h*e,bottom:t.h*e,left:t.w*r,right:t.w*r,w:.766*t.w,h:.62*t.h}}(o);break;case"dodecagon":g=function(c){var t=c.extend,r=A("path"),e=.364,l=.133,p=.135,v=["M".concat(t.w*e,",0"),"L".concat(.636*t.w,",0"),"L".concat(.867*t.w,",").concat(t.h*p),"L".concat(t.w,",").concat(t.h*e),"L".concat(t.w,",").concat(.636*t.h),"L".concat(.867*t.w,",").concat(.865*t.h),"L".concat(.636*t.w,",").concat(t.h),"L".concat(t.w*e,",").concat(t.h),"L".concat(t.w*l,",").concat(.865*t.h),"L0,".concat(.636*t.h),"L0,".concat(t.h*e),"L".concat(t.w*l,",").concat(t.h*p),"Z"].join(" ");return r.setAttribute("d",v),r}(o),L=function(c){var t=c.extend,r=.133,e=.135;return{top:t.h*e,bottom:t.h*e,left:t.w*r,right:t.w*r,w:.734*t.w,h:.73*t.h}}(o);break;case"pie":g=function(c){var t=c.extend,r=A("path"),e=T("adj1",c,360),l=T("adj2",c,270),p=t.w/2,v=t.h/2,x=t.w/2,m=t.h/2,_=nt(e,x,m,p,v),k=_[0],I=_[1],B=nt(l,x,m,p,v),O=B[0],D=B[1],N=yt(e,l),U="M".concat(x,",").concat(m,", L").concat(k," ").concat(I," A ").concat(p," ").concat(v," 0 ").concat(N," ").concat(1," ").concat(O," ").concat(D," Z");return r.setAttribute("d",U),r}(o),L=dt(o);break;case"arc":g=function(c){var t=c.extend,r=A("path"),e=T("adj1",c,270),l=T("adj2",c,0),p=t.w/2,v=t.h/2,x=t.w/2,m=t.h/2,_=nt(e,x,m,p,v),k=_[0],I=_[1],B=nt(l,x,m,p,v),O=B[0],D=B[1],N=yt(e,l),U="M".concat(k,",").concat(I," A ").concat(p," ").concat(v," 0 ").concat(N," ").concat(1," ").concat(O," ").concat(D);return r.setAttribute("d",U),r}(o),C=!1;break;case"bracketPair":g=function(c){var t=c.extend,r=A("path"),e=M("adj",c,.16667*Math.min(t.w,t.h)),l=["M".concat(e,",").concat(t.h),"Q".concat(0,",").concat(t.h," ").concat(0,",").concat(t.h-e),"L".concat(0,",").concat(e),"Q".concat(0,",").concat(0," ").concat(e,",").concat(0),"M".concat(t.w-e,",").concat(0),"Q".concat(t.w,",").concat(0," ").concat(t.w,",").concat(e),"L".concat(t.w,",").concat(t.h-e),"Q".concat(t.w,",").concat(t.h," ").concat(t.w-e,",").concat(t.h)].join(" ");return r.setAttribute("d",l),r}(o),L=function(c){var t=c.extend,r=.285*M("adj",c,.16667*Math.min(t.w,t.h));return{top:r,bottom:r,left:r,right:r,w:t.w-2*r,h:t.h-2*r}}(o),C=!1;break;case"bracePair":g=function(c){var t=c.extend,r=A("path"),e=M("adj",c,.083335*Math.min(t.w,t.h)),l=["M".concat(2*e,",").concat(t.h),"Q".concat(e,",").concat(t.h," ").concat(e,",").concat(t.h-e),"L".concat(e,",").concat(t.h/2+e),"Q".concat(e,",").concat(t.h/2," ").concat(0,",").concat(t.h/2),"Q".concat(e,",").concat(t.h/2," ").concat(e,",").concat(t.h/2-e),"L".concat(e,",").concat(e),"Q".concat(e,",").concat(0," ").concat(2*e,",").concat(0),"M".concat(t.w-2*e,",").concat(0),"Q".concat(t.w-e,",").concat(0," ").concat(t.w-e,",").concat(e),"L".concat(t.w-e,",").concat(t.h/2-e),"Q".concat(t.w-e,",").concat(t.h/2," ").concat(t.w,",").concat(t.h/2),"Q".concat(t.w-e,",").concat(t.h/2," ").concat(t.w-e,",").concat(t.h/2+e),"L".concat(t.w-e,",").concat(t.h-e),"Q".concat(t.w-e,",").concat(t.h," ").concat(t.w-2*e,",").concat(t.h)].join(" ");return r.setAttribute("d",l),r}(o),L=function(c){var t=c.extend,r=.285*M("adj",c,.16667*Math.min(t.w,t.h));return{top:r,bottom:r,left:r,right:r,w:t.w-2*r,h:t.h-2*r}}(o),C=!1;break;case"chord":g=function(c){var t=c.extend,r=A("path"),e=T("adj1",c,45),l=T("adj2",c,270),p=t.w/2,v=t.h/2,x=t.w/2,m=t.h/2,_=nt(e,x,m,p,v),k=_[0],I=_[1],B=nt(l,x,m,p,v),O=B[0],D=B[1],N=yt(e,l),U="M".concat(k," ").concat(I," A ").concat(p," ").concat(v," 0 ").concat(N," ").concat(1," ").concat(O," ").concat(D," Z");return r.setAttribute("d",U),r}(o),L=dt(o);break;case"teardrop":g=function(c){var t=c.extend,r=A("path"),e=T("adj",c,1),l=t.w/2,p=t.h/2,v=t.w/2,x=t.h/2,m=nt(0,v,x,l,p),_=m[0],k=m[1],I=nt(270,v,x,l,p),B=I[0],O=I[1],D=yt(0,270),N="M".concat(_," ").concat(k," A ").concat(l," ").concat(p," 0 ").concat(D," ").concat(1," ").concat(B," ").concat(O),U=l*e,F=v+U,H=x-p*U/(t.w/2),Q=(t.w/2+F)/2,W=(t.h/2+H)/2;return N+=" Q".concat(Q,",0 ").concat(F,",").concat(H),N+=" Q".concat(t.w,",").concat(W," ").concat(v+l,",").concat(x),r.setAttribute("d",N),r}(o),L=dt(o);break;case"frame":g=function(c){var t=c.extend,r=A("path"),e=M("adj1",c,.12*Math.min(t.w,t.h)),l=["M0,0","L".concat(t.w,",0"),"L".concat(t.w,",").concat(t.h),"L0,".concat(t.h),"Z","M".concat(e,",").concat(e),"L".concat(e,",").concat(t.h-e),"L".concat(t.w-e,",").concat(t.h-e),"L".concat(t.w-e,",").concat(e),"Z"].join(" ");return r.setAttribute("d",l),r}(o),L=function(c){var t=c.extend,r=M("adj1",c,.12*Math.min(t.w,t.h));return{top:r,bottom:r,left:r,right:r,w:t.w-2*r,h:t.h-2*r}}(o);break;case"halfFrame":g=function(c){var t=c.extend,r=A("path"),e=M("adj1",c,.333*Math.min(t.w,t.h)),l=Math.min(M("adj2",c,.333*Math.min(t.w,t.h)),t.w*(1-e/t.h)),p=["M0,0","L".concat(t.w,",0"),"L".concat(t.w*(1-e/t.h),",").concat(e),"L".concat(l,",").concat(e),"L".concat(l,",").concat(t.h*(1-l/t.w)),"L0,".concat(t.h),"Z"].join(" ");return r.setAttribute("d",p),r}(o);break;case"corner":g=function(c){var t=c.extend,r=A("path"),e=M("adj1",c,.5*Math.min(t.w,t.h)),l=M("adj2",c,.5*Math.min(t.w,t.h)),p=["M0,0","L".concat(l,",0"),"L".concat(l,",").concat(t.h-e),"L".concat(t.w,",").concat(t.h-e),"L".concat(t.w,",").concat(t.h),"L0,".concat(t.h),"Z"].join(" ");return r.setAttribute("d",p),r}(o),L=function(c){var t=c.extend,r=M("adj1",c,.5*Math.min(t.w,t.h));return{top:t.h-r,bottom:0,left:0,right:0,w:t.w,h:r}}(o);break;case"diagStripe":g=function(c){var t=c.extend,r=A("path"),e=M("adj",c,.5*Math.min(t.w,t.h)),l=t.w*e/t.h,p=["M".concat(l,",0"),"L".concat(t.w,",0"),"L0,".concat(t.h),"L0,".concat(e),"Z"].join(" ");return r.setAttribute("d",p),r}(o),L=function(c){var t=c.extend,r=T("adj",c,.5),e=.5*(1-r)*t.h,l=.5*(1-r)*t.w;return{top:0,bottom:e,left:0,right:l,w:t.w-l,h:t.h-e}}(o);break;case"plus":g=function(c){var t=c.extend,r=A("path"),e=M("adj",c,.25*Math.min(t.w,t.h)),l=["M".concat(e,",0"),"L".concat(t.w-e,",0"),"L".concat(t.w-e,",").concat(e),"L".concat(t.w,",").concat(e),"L".concat(t.w,",").concat(t.h-e),"L".concat(t.w-e,",").concat(t.h-e),"L".concat(t.w-e,",").concat(t.h),"L".concat(e,",").concat(t.h),"L".concat(e,",").concat(t.h-e),"L0,".concat(t.h-e),"L0,".concat(e),"L".concat(e,",").concat(e),"Z"].join(" ");return r.setAttribute("d",l),r}(o),L=function(c){var t=c.extend,r=M("adj",c,.25*Math.min(t.w,t.h));return{top:r,bottom:r,left:0,right:0,w:t.w,h:t.h-2*r}}(o);break;case"plaque":g=function(c){var t=c.extend,r=A("path"),e=M("adj",c,.16667*Math.min(t.w,t.h)),l=["M".concat(e,",0"),"L".concat(t.w-e,",0"),"Q".concat(t.w-e,",").concat(e," ").concat(t.w,",").concat(e),"L".concat(t.w,",").concat(t.h-e),"Q".concat(t.w-e,",").concat(t.h-e," ").concat(t.w-e,",").concat(t.h),"L".concat(e,",").concat(t.h),"Q".concat(e,",").concat(t.h-e," 0,").concat(t.h-e),"L0,".concat(e),"Q".concat(e,",").concat(e," ").concat(e,",0"),"Z"].join(" ");return r.setAttribute("d",l),r}(o),L=function(c){var t=c.extend,r=M("adj",c,.16667*Math.min(t.w,t.h));return{top:.72*r,bottom:.72*r,left:.72*r,right:.72*r,w:t.w-1.44*r,h:t.w-1.44*r}}(o);break;case"can":g=function(c){var t=c.extend,r=c.background,e=A("g"),l=A("path"),p=M("adj",c,.25*Math.min(t.w,t.h)),v=["M0,".concat(p/2),"L0,".concat(t.h-p/2),"A".concat(t.w/2,",").concat(p/2," 0 0 0 ").concat(t.w,",").concat(t.h-p/2),"L".concat(t.w,",").concat(p/2),"A".concat(t.w/2,",").concat(p/2," 0 0 1 0,").concat(p/2),"Z"].join(" ");l.setAttribute("d",v);var x=A("ellipse"),m=t.w/2,_=p/2,k=t.w/2,I=p/2;return x.setAttribute("cx",m+"px"),x.setAttribute("cy",_+"px"),x.setAttribute("rx",k+"px"),x.setAttribute("ry",I+"px"),(r==null?void 0:r.type)==="solidFill"&&x.setAttribute("fill",z(r,{light:.5})||"transparent"),e.appendChild(l),e.appendChild(x),e}(o),L=function(c){var t=c.extend,r=M("adj",c,.25*Math.min(t.w,t.h));return{top:r,bottom:0,left:0,right:0,w:t.w,h:t.h-r}}(o);break;case"cube":g=function(c){var t=c.extend,r=c.background,e=M("adj",c,.25*Math.min(t.w,t.h)),l=A("g"),p=A("path"),v=["M0,".concat(e),"L".concat(t.w-e,",").concat(e),"L".concat(t.w-e,",").concat(t.h),"L0,".concat(t.h),"Z"].join(" ");p.setAttribute("d",v);var x=A("path"),m=["M0,".concat(e),"L".concat(e,",0"),"L".concat(t.w,",0"),"L".concat(t.w-e,",").concat(e),"Z"].join(" ");x.setAttribute("d",m),(r==null?void 0:r.type)==="solidFill"&&x.setAttribute("fill",z(r,{light:.8})||"transparent");var _=A("path"),k=["M".concat(t.w,",0"),"L".concat(t.w-e,",").concat(e),"L".concat(t.w-e,",").concat(t.h),"L".concat(t.w,",").concat(t.h-e),"Z"].join(" ");return _.setAttribute("d",k),(r==null?void 0:r.type)==="solidFill"&&_.setAttribute("fill",z(r,{dark:.6})||"transparent"),l.appendChild(p),l.appendChild(x),l.appendChild(_),l}(o),L=function(c){var t=c.extend,r=M("adj",c,.25*Math.min(t.w,t.h));return{top:r,bottom:0,left:0,right:r,w:t.w-r,h:t.h-r}}(o);break;case"bevel":g=function(c){var t=c.extend,r=c.background,e=M("adj",c,.125*Math.min(t.w,t.h)),l=A("g"),p=A("path"),v=["M".concat(e,",").concat(e),"L".concat(t.w-e,",").concat(e),"L".concat(t.w-e,",").concat(t.h-e),"L".concat(e,",").concat(t.h-e),"Z"].join(" ");p.setAttribute("d",v);var x=A("path"),m=["M0,0","L".concat(e,",").concat(e),"L".concat(t.w-e,",").concat(e),"L".concat(t.w,",0"),"Z"].join(" ");x.setAttribute("d",m),(r==null?void 0:r.type)==="solidFill"&&x.setAttribute("fill",z(r,{light:.8})||"transparent");var _=A("path"),k=["M".concat(t.w,",0"),"L".concat(t.w-e,",").concat(e),"L".concat(t.w-e,",").concat(t.h-e),"L".concat(t.w,",").concat(t.h),"Z"].join(" ");_.setAttribute("d",k),(r==null?void 0:r.type)==="solidFill"&&_.setAttribute("fill",z(r,{dark:.6})||"transparent");var I=A("path"),B=["M".concat(t.w,",").concat(t.h),"L".concat(t.w-e,",").concat(t.h-e),"L".concat(e,",").concat(t.h-e),"L0,".concat(t.h),"Z"].join(" ");I.setAttribute("d",B),(r==null?void 0:r.type)==="solidFill"&&I.setAttribute("fill",z(r,{dark:.625})||"transparent");var O=A("path"),D=["M0,".concat(t.h),"L".concat(e,",").concat(t.h-e),"L".concat(e,",").concat(e),"L0,0","Z"].join(" ");return O.setAttribute("d",D),(r==null?void 0:r.type)==="solidFill"&&O.setAttribute("fill",z(r,{light:.6})||"transparent"),l.appendChild(p),l.appendChild(x),l.appendChild(_),l.appendChild(I),l.appendChild(O),l}(o),L=function(c){var t=c.extend,r=M("adj",c,.125*Math.min(t.w,t.h));return{top:r,bottom:r,left:r,right:r,w:t.w-2*r,h:t.h-2*r}}(o);break;case"donut":g=function(c){var t=c.extend,r=M("adj",c,.25*Math.min(t.w,t.h)),e=A("path"),l=["M0,".concat(t.h/2),"A".concat(t.w/2,",").concat(t.h/2," 0 1,1 0,").concat(t.h/2+1),"Z","M".concat(t.w-r,",").concat(t.h/2),"A".concat(t.w/2-r,",").concat(t.h/2-r," 0 1,0 ").concat(t.w-r,",").concat(t.h/2+1),"Z"].join(" ");return e.setAttribute("d",l),e}(o),L=dt(o);break;case"noSmoking":g=function(c){var t=c.extend,r=M("adj",c,.25*Math.min(t.w,t.h)),e=A("path"),l=Math.atan(t.h/t.w),p=r/2/Math.sin(l),v=t.w/2,x=t.h/2,m=-1*t.h/t.w,_=t.h*p/t.w,k=t.w/2-r,I=t.h/2-r,B=-2*k*k*m*_,O=Math.sqrt(Math.pow(2*k*k*m*_,2)-4*(I*I+k*k*m*m)*k*k*(_*_-I*I)),D=2*(I*I+k*k*m*m),N=(B-O)/D,U=m*N+_,F=(B+O)/D,H=m*F+_,Q=-t.h*p/t.w,W=-2*k*k*m*Q,J=Math.sqrt(Math.pow(2*k*k*m*Q,2)-4*(I*I+k*k*m*m)*k*k*(Q*Q-I*I)),et=2*(I*I+k*k*m*m),at=(W-J)/et,ot=m*at+Q,ct=(W+J)/et,st=m*ct+Q,ht=["M0,".concat(t.h/2),"A".concat(t.w/2,",").concat(t.h/2," 0 1,1 0,").concat(t.h/2+1),"Z","M".concat(v+F,",").concat(x-H),"A".concat(k,",").concat(I," 0 0 0 ").concat(v+N,",").concat(x-U),"Z","M".concat(v+at,",").concat(x-ot),"A".concat(k,",").concat(I," 0 0 0 ").concat(v+ct,",").concat(x-st),"Z"].join(" ");return e.setAttribute("d",ht),e}(o),L=dt(o);break;case"rightArrow":g=function(c){var t=c.extend,r=M("adj1",c,.5*Math.min(t.w,t.h)),e=M("adj2",c,.5*Math.min(t.w,t.h)),l=A("path"),p=["M0,".concat(t.h/2-r/2),"L".concat(t.w-e,",").concat(t.h/2-r/2),"L".concat(t.w-e,",0"),"L".concat(t.w,",").concat(t.h/2),"L".concat(t.w-e,",").concat(t.h),"L".concat(t.w-e,",").concat(t.h/2+r/2),"L0,".concat(t.h/2+r/2),"Z"].join(" ");return l.setAttribute("d",p),l}(o),L=function(c){var t=c.extend,r=M("adj1",c,.5*Math.min(t.w,t.h)),e=r*M("adj2",c,.5*Math.min(t.w,t.h))/t.h;return{top:t.h/2-r/2,bottom:t.h/2-r/2,left:0,right:e,w:t.w-e,h:r}}(o);break;case"leftArrow":g=function(c){var t=c.extend,r=M("adj1",c,.5*Math.min(t.w,t.h)),e=M("adj2",c,.5*Math.min(t.w,t.h)),l=A("path"),p=["M0,".concat(t.h/2),"L".concat(e,",0"),"L".concat(e,",").concat(t.h/2-r/2),"L".concat(t.w,",").concat(t.h/2-r/2),"L".concat(t.w,",").concat(t.h/2+r/2),"L".concat(e,",").concat(t.h/2+r/2),"L".concat(e,",").concat(t.h),"Z"].join(" ");return l.setAttribute("d",p),l}(o),L=function(c){var t=c.extend,r=M("adj1",c,.5*Math.min(t.w,t.h)),e=r*M("adj2",c,.5*Math.min(t.w,t.h))/t.h;return{top:t.h/2-r/2,bottom:t.h/2-r/2,left:e,right:0,w:t.w-e,h:r}}(o);break;case"upArrow":g=function(c){var t=c.extend,r=M("adj1",c,.5*Math.min(t.w,t.h)),e=M("adj2",c,.5*Math.min(t.w,t.h)),l=A("path"),p=["M".concat(t.w/2,",0"),"L".concat(t.w,",").concat(e),"L".concat(t.w/2+r/2,",").concat(e),"L".concat(t.w/2+r/2,",").concat(t.h),"L".concat(t.w/2-r/2,",").concat(t.h),"L".concat(t.w/2-r/2,",").concat(e),"L0,".concat(e),"Z"].join(" ");return l.setAttribute("d",p),l}(o),L=function(c){var t=c.extend,r=M("adj1",c,.5*Math.min(t.w,t.h)),e=r*M("adj2",c,.5*Math.min(t.w,t.h))/t.w;return{top:e,bottom:0,left:t.w/2-r/2,right:t.w/2-r/2,w:r,h:t.h-e}}(o);break;case"downArrow":g=function(c){var t=c.extend,r=M("adj1",c,.5*Math.min(t.w,t.h)),e=M("adj2",c,.5*Math.min(t.w,t.h)),l=A("path"),p=["M".concat(t.w/2,",").concat(t.h),"L0,".concat(t.h-e),"L".concat(t.w/2-r/2,",").concat(t.h-e),"L".concat(t.w/2-r/2,",0"),"L".concat(t.w/2+r/2,",0"),"L".concat(t.w/2+r/2,",").concat(t.h-e),"L".concat(t.w,",").concat(t.h-e),"Z"].join(" ");return l.setAttribute("d",p),l}(o),L=function(c){var t=c.extend,r=M("adj1",c,.5*Math.min(t.w,t.h)),e=r*M("adj2",c,.5*Math.min(t.w,t.h))/t.w;return{top:0,bottom:e,left:t.w/2-r/2,right:t.w/2-r/2,w:r,h:t.h-e}}(o);break;case"leftRightArrow":g=function(c){var t=c.extend,r=M("adj1",c,.5*Math.min(t.w,t.h)),e=M("adj2",c,.5*Math.min(t.w,t.h)),l=A("path"),p=["M0,".concat(t.h/2),"L".concat(e,",0"),"L".concat(e,",").concat(t.h/2-r/2),"L".concat(t.w-e,",").concat(t.h/2-r/2),"L".concat(t.w-e,",0"),"L".concat(t.w,",").concat(t.h/2),"L".concat(t.w-e,",").concat(t.h),"L".concat(t.w-e,",").concat(t.h/2+r/2),"L".concat(e,",").concat(t.h/2+r/2),"L".concat(e,",").concat(t.h),"Z"].join(" ");return l.setAttribute("d",p),l}(o),L=function(c){var t=c.extend,r=M("adj1",c,.5*Math.min(t.w,t.h)),e=r*M("adj2",c,.5*Math.min(t.w,t.h))/t.h;return{top:t.h/2-r/2,bottom:t.h/2-r/2,left:e,right:e,w:t.w-2*e,h:r}}(o);break;case"upDownArrow":g=function(c){var t=c.extend,r=M("adj1",c,.5*Math.min(t.w,t.h)),e=M("adj2",c,.5*Math.min(t.w,t.h)),l=A("path"),p=["M".concat(t.w/2,",").concat(t.h),"L0,".concat(t.h-e),"L".concat(t.w/2-r/2,",").concat(t.h-e),"L".concat(t.w/2-r/2,",").concat(e),"L0,".concat(e),"L".concat(t.w/2,",0"),"L".concat(t.w,",").concat(e),"L".concat(t.w/2+r/2,",").concat(e),"L".concat(t.w/2+r/2,",").concat(t.h-e),"L".concat(t.w,",").concat(t.h-e),"Z"].join(" ");return l.setAttribute("d",p),l}(o),L=function(c){var t=c.extend,r=M("adj1",c,.5*Math.min(t.w,t.h)),e=r*M("adj2",c,.5*Math.min(t.w,t.h))/t.w;return{top:e,bottom:e,left:t.w/2-r/2,right:t.w/2-r/2,w:r,h:t.h-2*e}}(o);break;case"quadArrow":g=function(c){var t=c.extend,r=M("adj1",c,.225*Math.min(t.w,t.h)),e=M("adj2",c,.225*Math.min(t.w,t.h)),l=M("adj3",c,.225*Math.min(t.w,t.h)),p=A("path"),v=["M0,".concat(t.h/2),"L".concat(l,",").concat(t.h/2-e),"L".concat(l,",").concat(t.h/2-r/2),"L".concat(t.w/2-r/2,",").concat(t.h/2-r/2),"L".concat(t.w/2-r/2,",").concat(l),"L".concat(t.w/2-e,",").concat(l),"L".concat(t.w/2,",0"),"L".concat(t.w/2+e,",").concat(l),"L".concat(t.w/2+r/2,",").concat(l),"L".concat(t.w/2+r/2,",").concat(t.h/2-r/2),"L".concat(t.w-l,",").concat(t.h/2-r/2),"L".concat(t.w-l,",").concat(t.h/2-e),"L".concat(t.w,",").concat(t.h/2),"L".concat(t.w-l,",").concat(t.h/2+e),"L".concat(t.w-l,",").concat(t.h/2+r/2),"L".concat(t.w/2+r/2,",").concat(t.h/2+r/2),"L".concat(t.w/2+r/2,",").concat(t.h-l),"L".concat(t.w/2+e,",").concat(t.h-l),"L".concat(t.w/2,",").concat(t.h),"L".concat(t.w/2-e,",").concat(t.h-l),"L".concat(t.w/2-r/2,",").concat(t.h-l),"L".concat(t.w/2-r/2,",").concat(t.h/2+r/2),"L".concat(l,",").concat(t.h/2+r/2),"L".concat(l,",").concat(t.h/2+e),"Z"].join(" ");return p.setAttribute("d",v),p}(o),L=function(c){var t=c.extend,r=M("adj1",c,.225*Math.min(t.w,t.h)),e=M("adj2",c,.225*Math.min(t.w,t.h)),l=M("adj3",c,.225*Math.min(t.w,t.h)),p=e===0?0:r*l/e/2;return{top:t.h/2-r/2,bottom:t.h/2-r/2,left:p,right:p,w:t.w-2*p,h:r}}(o);break;case"leftRightUpArrow":g=function(c){var t=c.extend,r=M("adj1",c,.225*Math.min(t.w,t.h)),e=M("adj2",c,.225*Math.min(t.w,t.h)),l=M("adj3",c,.225*Math.min(t.w,t.h)),p=A("path");r>2*e&&(r=2*e);var v=["M0,".concat(t.h-e),"L".concat(l,",").concat(t.h-2*e),"L".concat(l,",").concat(t.h-e-r/2),"L".concat(t.w/2-r/2,",").concat(t.h-e-r/2),"L".concat(t.w/2-r/2,",").concat(l),"L".concat(t.w/2-e,",").concat(l),"L".concat(t.w/2,",0"),"L".concat(t.w/2+e,",").concat(l),"L".concat(t.w/2+r/2,",").concat(l),"L".concat(t.w/2+r/2,",").concat(t.h-e-r/2),"L".concat(t.w-l,",").concat(t.h-e-r/2),"L".concat(t.w-l,",").concat(t.h-2*e),"L".concat(t.w,",").concat(t.h-e),"L".concat(t.w-l,",").concat(t.h),"L".concat(t.w-l,",").concat(t.h-e+r/2),"L".concat(l,",").concat(t.h-e+r/2),"L".concat(l,",").concat(t.h),"Z"].join(" ");return p.setAttribute("d",v),p}(o),L=function(c){var t=c.extend,r=M("adj1",c,.225*Math.min(t.w,t.h)),e=M("adj2",c,.225*Math.min(t.w,t.h)),l=M("adj3",c,.225*Math.min(t.w,t.h)),p=e===0?0:r*l/e/2;return{top:t.h-e-r/2,bottom:e-r/2,left:p,right:p,w:t.w-2*p,h:r}}(o);break;case"bentArrow":g=function(c){var t=c.extend,r=M("adj1",c,.25*Math.min(t.w,t.h)),e=M("adj2",c,.25*Math.min(t.w,t.h)),l=M("adj3",c,.25*Math.min(t.w,t.h)),p=M("adj4",c,.4375*Math.min(t.w,t.h)),v=A("path");r>2*e&&(r=2*e);var x=p-r;x<0&&(x=0);var m=["M0,".concat(t.h),"L0,".concat(e-r/2+p),"A".concat(p," ").concat(p," 0 0 1 ").concat(p," ").concat(e-r/2),"L".concat(t.w-l,",").concat(e-r/2),"L".concat(t.w-l,",0"),"L".concat(t.w,",").concat(e),"L".concat(t.w-l,",").concat(2*e),"L".concat(t.w-l,",").concat(e+r/2),"L".concat(r+x,",").concat(e+r/2),"A".concat(x," ").concat(x,"  0 0 0 ").concat(r," ").concat(e+r/2+x),"L".concat(r,",").concat(t.h),"Z"].join(" ");return v.setAttribute("d",m),v}(o);break;case"uturnArrow":g=function(c){var t=c.extend,r=M("adj1",c,.25*Math.min(t.w,t.h)),e=M("adj2",c,.25*Math.min(t.w,t.h)),l=M("adj3",c,.25*Math.min(t.w,t.h)),p=M("adj4",c,.4375*Math.min(t.w,t.h)),v=M("adj5",c,.75*Math.min(t.w,t.h)),x=A("path");r>2*e&&(r=2*e),v<l&&(v=l+r),p>v-l&&(p=v-l);var m=p-r;m>v-l-r&&(m=v-l-r),m<0&&(m=0);var _=e-r/2,k=["M0,".concat(t.h),"L0,".concat(p),"A".concat(p," ").concat(p," 0 0 1 ").concat(p," 0"),"L".concat(t.w-p-_,",0"),"A".concat(p," ").concat(p," 0 0 1 ").concat(t.w-_," ").concat(p),"L".concat(t.w-_,",").concat(v-l),"L".concat(t.w,",").concat(v-l),"L".concat(t.w-e,",").concat(v),"L".concat(t.w-2*e,",").concat(v-l),"L".concat(t.w-e-r/2,",").concat(v-l),"L".concat(t.w-e-r/2,",").concat(r+m),"A".concat(m," ").concat(m,"  0 0 0 ").concat(t.w-m-e-r/2," ").concat(r),"L".concat(r+m,",").concat(r),"A".concat(m," ").concat(m,"  0 0 0 ").concat(r," ").concat(r+m),"L".concat(r,",").concat(t.h),"Z"].join(" ");return x.setAttribute("d",k),x}(o);break;case"leftUpArrow":g=function(c){var t=c.extend,r=M("adj1",c,.25*Math.min(t.w,t.h)),e=M("adj2",c,.25*Math.min(t.w,t.h)),l=M("adj3",c,.25*Math.min(t.w,t.h));r>2*e&&(r=2*e);var p=Math.min(t.w,t.h)-2*e;l>p&&(l=p),l<0&&(l=0);var v=e-r/2,x=A("path"),m=["M0,".concat(t.h-e),"L".concat(l,",").concat(t.h-2*e),"L".concat(l,",").concat(t.h-e-r/2),"L".concat(t.w-e-r/2,",").concat(t.h-e-r/2),"L".concat(t.w-e-r/2,",").concat(l),"L".concat(t.w-2*e,",").concat(l),"L".concat(t.w-e,",0"),"L".concat(t.w,",").concat(l),"L".concat(t.w-v,",").concat(l),"L".concat(t.w-v,",").concat(t.h-v),"L".concat(l,",").concat(t.h-v),"L".concat(l,",").concat(t.h),"Z"].join(" ");return x.setAttribute("d",m),x}(o),L=function(c){var t=c.extend,r=M("adj1",c,.25*Math.min(t.w,t.h)),e=M("adj2",c,.25*Math.min(t.w,t.h)),l=M("adj3",c,.25*Math.min(t.w,t.h));r>2*e&&(r=2*e);var p=Math.min(t.w,t.h)-2*e;l>p&&(l=p),l<0&&(l=0);var v=e===0?0:r*l/e/2;return{top:t.h-e-r/2,bottom:e-r/2,left:v,right:e,w:t.w-v-e,h:r}}(o);break;case"bentUpArrow":g=function(c){var t=c.extend,r=M("adj1",c,.25*Math.min(t.w,t.h)),e=M("adj2",c,.25*Math.min(t.w,t.h)),l=M("adj3",c,.25*Math.min(t.w,t.h));r>2*e&&(r=2*e);var p=Math.min(t.w,t.h)-2*e;l>p&&(l=p),l<0&&(l=0);var v=e-r/2,x=A("path"),m=["M0,".concat(t.h),"L0,".concat(t.h-r),"L".concat(t.w-e-r/2,",").concat(t.h-r),"L".concat(t.w-e-r/2,",").concat(l),"L".concat(t.w-2*e,",").concat(l),"L".concat(t.w-e,",0"),"L".concat(t.w,",").concat(l),"L".concat(t.w-v,",").concat(l),"L".concat(t.w-v,",").concat(t.h),"Z"].join(" ");return x.setAttribute("d",m),x}(o),L=function(c){var t=c.extend,r=M("adj1",c,.25*Math.min(t.w,t.h));return{top:t.h-r,bottom:0,left:0,right:0,w:t.w,h:r}}(o);break;case"curvedRightArrow":g=function(c){var t=c.extend,r=c.background,e=M("adj1",c,.25*Math.min(t.w,t.h)),l=M("adj2",c,.5*Math.min(t.w,t.h)),p=M("adj3",c,.25*Math.min(t.w,t.h));e>l&&(e=l);var v=l/2-e/2,x=(t.h-l/2-e/2)/2,m=(t.h-v-e)/2,_=A("g"),k=A("path"),I=["M".concat(t.w,",0"),"A ".concat(t.w," ").concat(x," 0 0 0 ").concat(0," ").concat(x),"L0,".concat(m+e),"A ".concat(t.w," ").concat(m," 0 0 1 ").concat(t.w," ").concat(e),"Z"].join(" ");k.setAttribute("d",I),(r==null?void 0:r.type)==="solidFill"&&k.setAttribute("fill",z(r,{dark:.6})||"transparent");var B=A("path"),O=["M0,".concat(x),"A ".concat(t.w," ").concat(x," 0 0 0 ").concat(t.w-p," ").concat(t.h-l/2-e/2),"L".concat(t.w-p,",").concat(t.h-l),"L".concat(t.w,",").concat(t.h-l/2),"L".concat(t.w-p,",").concat(t.h),"L".concat(t.w-p,",").concat(t.h-v),"A ".concat(t.w," ").concat(m," 0 0 1 0 ").concat(e+m),"Z"].join(" ");return B.setAttribute("d",O),_.appendChild(k),_.appendChild(B),_}(o);break;case"curvedLeftArrow":g=function(c){var t=c.extend,r=c.background,e=M("adj1",c,.25*Math.min(t.w,t.h)),l=M("adj2",c,.5*Math.min(t.w,t.h)),p=M("adj3",c,.25*Math.min(t.w,t.h));e>l&&(e=l);var v=l/2-e/2,x=(t.h-l/2-e/2)/2,m=(t.h-v-e)/2,_=A("g"),k=A("path"),I=["M0,".concat(t.h-l/2),"L".concat(p,",").concat(t.h-l),"L".concat(p,",").concat(t.h-l/2-e/2),"A".concat(t.w," ").concat(x," 0 0 0 ").concat(t.w," ").concat(x),"L".concat(t.w,",").concat(m+e),"A ".concat(t.w," ").concat(m," 0 0 1 ").concat(p," ").concat(t.h-v),"L".concat(p,",").concat(t.h),"Z"].join(" ");k.setAttribute("d",I);var B=A("path"),O=["M0,0","A ".concat(t.w," ").concat(x," 0 0 1 ").concat(t.w," ").concat(x),"L".concat(t.w,",").concat(m+e),"A ".concat(t.w," ").concat(m," 0 0 0 ").concat(0," ").concat(e),"Z"].join(" ");return B.setAttribute("d",O),(r==null?void 0:r.type)==="solidFill"&&B.setAttribute("fill",z(r,{dark:.6})||"transparent"),_.appendChild(k),_.appendChild(B),_}(o);break;case"curvedUpArrow":g=function(c){var t=c.extend,r=c.background,e=M("adj1",c,.25*Math.min(t.w,t.h)),l=M("adj2",c,.5*Math.min(t.w,t.h)),p=M("adj3",c,.25*Math.min(t.w,t.h));e>l&&(e=l);var v=l/2-e/2,x=(t.w-l/2-e/2)/2,m=(t.w-v-e)/2,_=A("g"),k=A("path"),I=["M".concat(t.w-l/2,",").concat(0),"L".concat(t.w-l,",").concat(p),"L".concat(t.w-l/2-e/2,",").concat(p),"A".concat(x," ").concat(t.h," 0 0 1 ").concat(x," ").concat(t.h),"L".concat(x+e,",").concat(t.h),"A".concat(m," ").concat(t.h," 0 0 0 ").concat(t.w-v," ").concat(p),"L".concat(t.w,",").concat(p),"Z"].join(" ");k.setAttribute("d",I);var B=A("path"),O=["M".concat(e,",0"),"L".concat(0,",").concat(0),"A ".concat(x," ").concat(t.h," 0 0 0 ").concat(x," ").concat(t.h),"L".concat(x+e,",").concat(t.h),"A ".concat(m," ").concat(t.h," 0 0 1 ").concat(e," ").concat(0),"Z"].join(" ");return B.setAttribute("d",O),(r==null?void 0:r.type)==="solidFill"&&B.setAttribute("fill",z(r,{dark:.6})||"transparent"),_.appendChild(k),_.appendChild(B),_}(o);break;case"curvedDownArrow":g=function(c){var t=c.extend,r=c.background,e=M("adj1",c,.25*Math.min(t.w,t.h)),l=M("adj2",c,.5*Math.min(t.w,t.h)),p=M("adj3",c,.25*Math.min(t.w,t.h));e>l&&(e=l);var v=l/2-e/2,x=(t.w-l/2-e/2)/2,m=(t.w-v-e)/2,_=A("g"),k=A("path"),I=["M".concat(0,",").concat(t.h),"L".concat(e,",").concat(t.h),"A".concat(m," ").concat(t.h," 0 0 1 ").concat(m+e," ").concat(0),"L".concat(x,",").concat(0),"A".concat(x," ").concat(t.h," 0 0 0 ").concat(0," ").concat(t.h),"Z"].join(" ");k.setAttribute("d",I),(r==null?void 0:r.type)==="solidFill"&&k.setAttribute("fill",z(r,{dark:.6})||"transparent");var B=A("path"),O=["M".concat(t.w-l/2,",").concat(t.h),"L".concat(t.w-l,",").concat(t.h-p),"L".concat(t.w-l/2-e/2,",").concat(t.h-p),"A ".concat(x," ").concat(t.h," 0 0 0 ").concat(x," ").concat(0),"L".concat(x+e,",").concat(0),"A ".concat(m," ").concat(t.h," 0 0 1 ").concat(t.w-v," ").concat(t.h-p),"L".concat(t.w,",").concat(t.h-p),"Z"].join(" ");return B.setAttribute("d",O),_.appendChild(k),_.appendChild(B),_}(o);break;case"stripedRightArrow":g=function(c){var t=c.extend,r=A("g"),e=Math.min(t.w,t.h),l=T("adj1",c,.5)*t.h,p=T("adj2",c,.5)*e,v=e/8,x=e/16,m=e/32,_=5*e/32,k=t.h/2-l/2,I=t.h/2+l/2,B=A("path");B.setAttribute("d",["M".concat(0,",").concat(k),"L".concat(m,",").concat(k),"L".concat(m,",").concat(I),"L".concat(0,",").concat(I),"Z"].join(" "));var O=A("path");O.setAttribute("d",["M".concat(x,",").concat(k),"L".concat(v,",").concat(k),"L".concat(v,",").concat(I),"L".concat(x,",").concat(I),"Z"].join(" "));var D=A("path"),N=["M".concat(_,",").concat(k),"L".concat(t.w-p,",").concat(k),"L".concat(t.w-p,",").concat(0),"L".concat(t.w,",").concat(t.h/2),"L".concat(t.w-p,",").concat(t.h),"L".concat(t.w-p,",").concat(I),"L".concat(_,",").concat(I),"Z"].join(" ");return D.setAttribute("d",N),r.appendChild(D),r.appendChild(B),r.appendChild(O),r}(o),L=function(c){var t=c.extend,r=Math.min(t.w,t.h),e=T("adj1",c,.5)*t.h,l=e*(T("adj2",c,.5)*r)/t.h;return{top:t.h/2-e/2,bottom:t.h/2-e/2,left:0,right:l,w:t.w-l,h:e}}(o);break;case"notchedRightArrow":g=function(c){var t=c.extend,r=Math.min(t.w,t.h),e=T("adj1",c,.5)*t.h,l=T("adj2",c,.5)*r,p=e*l/t.h,v=t.h/2-e/2,x=t.h/2+e/2,m=A("path"),_=["M".concat(0,",").concat(v),"L".concat(t.w-l,",").concat(v),"L".concat(t.w-l,",").concat(0),"L".concat(t.w,",").concat(t.h/2),"L".concat(t.w-l,",").concat(t.h),"L".concat(t.w-l,",").concat(x),"L".concat(0,",").concat(x),"L".concat(p,",").concat(t.h/2),"Z"].join(" ");return m.setAttribute("d",_),m}(o),L=function(c){var t=c.extend,r=Math.min(t.w,t.h),e=T("adj1",c,.5)*t.h,l=T("adj2",c,.5)*r,p=e*l/t.h,v=e*l/t.h;return{top:t.h/2-e/2,bottom:t.h/2-e/2,left:p,right:v,w:t.w-p-v,h:e}}(o);break;case"homePlate":g=function(c){var t=c.extend,r=Math.min(t.w,t.h),e=T("adj",c,.5)*r,l=A("path"),p=["M".concat(0,",").concat(0),"L".concat(t.w-e,",").concat(0),"L".concat(t.w,",").concat(t.h/2),"L".concat(t.w-e,",").concat(t.h),"L".concat(0,",").concat(t.h),"Z"].join(" ");return l.setAttribute("d",p),l}(o),L=function(c){var t=c.extend,r=Math.min(t.w,t.h),e=T("adj",c,.5)*r;return{top:0,bottom:0,left:0,right:e/2,w:t.w-e/2,h:t.h}}(o);break;case"chevron":g=function(c){var t=c.extend,r=Math.min(t.w,t.h),e=T("adj",c,.5)*r,l=A("path"),p=["M".concat(0,",").concat(0),"L".concat(t.w-e,",").concat(0),"L".concat(t.w,",").concat(t.h/2),"L".concat(t.w-e,",").concat(t.h),"L".concat(0,",").concat(t.h),"L".concat(e,",").concat(t.h/2),"Z"].join(" ");return l.setAttribute("d",p),l}(o),L=function(c){var t=c.extend,r=Math.min(t.w,t.h),e=T("adj",c,.5)*r;return{top:0,bottom:0,left:e,right:e,w:t.w-2*e,h:t.h}}(o);break;case"rightArrowCallout":g=function(c){var t=c.extend,r=Math.min(t.w,t.h),e=T("adj1",c,.25)*r,l=T("adj2",c,.25)*r,p=T("adj3",c,.25)*r,v=T("adj4",c,.64977)*t.w,x=A("path"),m=["M".concat(0,",").concat(0),"L".concat(v,",").concat(0),"L".concat(v,",").concat(t.h/2-e/2),"L".concat(t.w-p,",").concat(t.h/2-e/2),"L".concat(t.w-p,",").concat(t.h/2-l),"L".concat(t.w,",").concat(t.h/2),"L".concat(t.w-p,",").concat(t.h/2+l),"L".concat(t.w-p,",").concat(t.h/2+e/2),"L".concat(v,",").concat(t.h/2+e/2),"L".concat(v,",").concat(t.h),"L".concat(0,",").concat(t.h),"Z"].join(" ");return x.setAttribute("d",m),x}(o),L=function(c){var t=c.extend,r=T("adj4",c,.64977)*t.w;return{top:0,bottom:0,left:0,right:t.w-r,w:r,h:t.h}}(o);break;case"leftArrowCallout":g=function(c){var t=c.extend,r=Math.min(t.w,t.h),e=T("adj1",c,.25)*r,l=T("adj2",c,.25)*r,p=T("adj3",c,.25)*r,v=T("adj4",c,.64977)*t.w,x=A("path"),m=["M".concat(0,",").concat(t.h/2),"L".concat(p,",").concat(t.h/2-l),"L".concat(p,",").concat(t.h/2-e/2),"L".concat(t.w-v,",").concat(t.h/2-e/2),"L".concat(t.w-v,",").concat(0),"L".concat(t.w,",").concat(0),"L".concat(t.w,",").concat(t.h),"L".concat(t.w-v,",").concat(t.h),"L".concat(t.w-v,",").concat(t.h/2+e/2),"L".concat(p,",").concat(t.h/2+e/2),"L".concat(p,",").concat(t.h/2+l),"Z"].join(" ");return x.setAttribute("d",m),x}(o),L=function(c){var t=c.extend,r=T("adj4",c,.64977)*t.w;return{top:0,bottom:0,left:t.w-r,right:0,w:r,h:t.h}}(o);break;case"upArrowCallout":g=function(c){var t=c.extend,r=Math.min(t.w,t.h),e=T("adj1",c,.25)*r,l=T("adj2",c,.25)*r,p=T("adj3",c,.25)*r,v=T("adj4",c,.64977)*t.h,x=A("path"),m=["M".concat(0,",").concat(t.h-v),"L".concat(t.w/2-e/2,",").concat(t.h-v),"L".concat(t.w/2-e/2,",").concat(p),"L".concat(t.w/2-l,",").concat(p),"L".concat(t.w/2,",").concat(0),"L".concat(t.w/2+l,",").concat(p),"L".concat(t.w/2+e/2,",").concat(p),"L".concat(t.w/2+e/2,",").concat(t.h-v),"L".concat(t.w,",").concat(t.h-v),"L".concat(t.w,",").concat(t.h),"L".concat(0,",").concat(t.h),"Z"].join(" ");return x.setAttribute("d",m),x}(o),L=function(c){var t=c.extend,r=T("adj4",c,.64977)*t.h;return{top:t.h-r,bottom:0,left:0,right:0,w:t.w,h:r}}(o);break;case"downArrowCallout":g=function(c){var t=c.extend,r=Math.min(t.w,t.h),e=T("adj1",c,.25)*r,l=T("adj2",c,.25)*r,p=T("adj3",c,.25)*r,v=T("adj4",c,.64977)*t.h,x=A("path"),m=["M".concat(0,",").concat(0),"L".concat(t.w,",").concat(0),"L".concat(t.w,",").concat(v),"L".concat(t.w/2+e/2,",").concat(v),"L".concat(t.w/2+e/2,",").concat(t.h-p),"L".concat(t.w/2+l,",").concat(t.h-p),"L".concat(t.w/2,",").concat(t.h),"L".concat(t.w/2-l,",").concat(t.h-p),"L".concat(t.w/2-e/2,",").concat(t.h-p),"L".concat(t.w/2-e/2,",").concat(v),"L".concat(0,",").concat(v),"Z"].join(" ");return x.setAttribute("d",m),x}(o),L=function(c){var t=c.extend,r=T("adj4",c,.64977)*t.h;return{top:0,bottom:t.h-r,left:0,right:0,w:t.w,h:r}}(o);break;case"leftRightArrowCallout":g=function(c){var t=c.extend,r=Math.min(t.w,t.h),e=T("adj1",c,.25)*r,l=T("adj2",c,.25)*r,p=T("adj3",c,.25)*r,v=T("adj4",c,.48123)*t.w,x=A("path"),m=["M".concat(0,",").concat(t.h/2),"L".concat(p,",").concat(t.h/2-l),"L".concat(p,",").concat(t.h/2-e/2),"L".concat(t.w/2-v/2,",").concat(t.h/2-e/2),"L".concat(t.w/2-v/2,",").concat(0),"L".concat(t.w/2+v/2,",").concat(0),"L".concat(t.w/2+v/2,",").concat(t.h/2-e/2),"L".concat(t.w-p,",").concat(t.h/2-e/2),"L".concat(t.w-p,",").concat(t.h/2-l),"L".concat(t.w,",").concat(t.h/2),"L".concat(t.w-p,",").concat(t.h/2+l),"L".concat(t.w-p,",").concat(t.h/2+e/2),"L".concat(t.w/2+v/2,",").concat(t.h/2+e/2),"L".concat(t.w/2+v/2,",").concat(t.h),"L".concat(t.w/2-v/2,",").concat(t.h),"L".concat(t.w/2-v/2,",").concat(t.h/2+e/2),"L".concat(p,",").concat(t.h/2+e/2),"L".concat(p,",").concat(t.h/2+l),"Z"].join(" ");return x.setAttribute("d",m),x}(o),L=function(c){var t=c.extend,r=T("adj4",c,.48123)*t.w;return{top:0,bottom:0,left:t.w/2-r/2,right:t.w/2-r/2,w:r,h:t.h}}(o);break;case"quadArrowCallout":g=function(c){var t=c.extend,r=Math.min(t.w,t.h),e=T("adj1",c,.18515)*r,l=T("adj2",c,.18515)*r,p=T("adj3",c,.18515)*r,v=T("adj4",c,.48123)*t.w,x=T("adj4",c,.48123)*t.h,m=A("path"),_=["M".concat(0,",").concat(t.h/2),"L".concat(p,",").concat(t.h/2-l),"L".concat(p,",").concat(t.h/2-e/2),"L".concat(t.w/2-v/2,",").concat(t.h/2-e/2),"L".concat(t.w/2-v/2,",").concat(t.h/2-x/2),"L".concat(t.w/2-e/2,",").concat(t.h/2-x/2),"L".concat(t.w/2-e/2,",").concat(p),"L".concat(t.w/2-l,",").concat(p),"L".concat(t.w/2,",").concat(0),"L".concat(t.w/2+l,",").concat(p),"L".concat(t.w/2+e/2,",").concat(p),"L".concat(t.w/2+e/2,",").concat(t.h/2-x/2),"L".concat(t.w/2+v/2,",").concat(t.h/2-x/2),"L".concat(t.w/2+v/2,",").concat(t.h/2-e/2),"L".concat(t.w-p,",").concat(t.h/2-e/2),"L".concat(t.w-p,",").concat(t.h/2-l),"L".concat(t.w,",").concat(t.h/2),"L".concat(t.w-p,",").concat(t.h/2+l),"L".concat(t.w-p,",").concat(t.h/2+e/2),"L".concat(t.w/2+v/2,",").concat(t.h/2+e/2),"L".concat(t.w/2+v/2,",").concat(t.h/2+x/2),"L".concat(t.w/2+e/2,",").concat(t.h/2+x/2),"L".concat(t.w/2+e/2,",").concat(t.h-p),"L".concat(t.w/2+l,",").concat(t.h-p),"L".concat(t.w/2,",").concat(t.h),"L".concat(t.w/2-l,",").concat(t.h-p),"L".concat(t.w/2-e/2,",").concat(t.h-p),"L".concat(t.w/2-e/2,",").concat(t.h/2+x/2),"L".concat(t.w/2-v/2,",").concat(t.h/2+x/2),"L".concat(t.w/2-v/2,",").concat(t.h/2+e/2),"L".concat(p,",").concat(t.h/2+e/2),"L".concat(p,",").concat(t.h/2+l),"Z"].join(" ");return m.setAttribute("d",_),m}(o),L=function(c){var t=c.extend,r=T("adj4",c,.48123)*t.w,e=T("adj4",c,.48123)*t.h;return{top:t.h/2-e/2,bottom:t.h/2-e/2,left:t.w/2-r/2,right:t.w/2-r/2,w:r,h:e}}(o)}g&&(C?(s==null?void 0:s.type)==="blipFill"?function(c,t,r){var e=c.background,l=e===void 0?{}:e,p=c.extend,v=l.base64,x=l.alpha,m=l.fillRect,_=m===void 0?{}:m,k=_.b,I=k===void 0?0:k,B=_.t,O=B===void 0?0:B,D=_.l,N=D===void 0?0:D,U=_.r,F=U===void 0?0:U,H=A("defs"),Q=A("pattern");Q.setAttribute("id","background_"+c.uuid),Q.setAttribute("patternUnits","userSpaceOnUse"),Q.setAttribute("width",p.w+""),Q.setAttribute("height",p.h+"");var W=A("image");W.setAttribute("href",v),W.setAttribute("preserveAspectRatio","none");var J=p.w*N,et=p.h*O,at=p.w*(1-N-F),ot=p.h*(1-O-I);W.setAttribute("width",at+""),W.setAttribute("height",ot+""),W.setAttribute("x",J+""),W.setAttribute("y",et+""),typeof x=="number"&&W.setAttribute("opacity",x+""),Q.appendChild(W),H.appendChild(Q),t.appendChild(H),r.setAttribute("fill","url(#background_".concat(c.uuid,")"))}(o,P,g):(s==null?void 0:s.type)==="gradFill"?function(c,t,r){var e=c.background,l=e===void 0?{}:e;c.extend;var p=l.gsList,v=l.lin,x=l.path,m=l.tileRect,_=m===void 0?{}:m,k=A("defs"),I=A(x==="circle"?"radialGradient":"linearGradient");I.setAttribute("id","background_grad_fill_"+c.uuid);var B=p||[];if(B.sort(function(F,H){return F.pos-H.pos}),B.forEach(function(F){var H=A("stop");H.setAttribute("offset","".concat(100*F.pos,"%")),H.setAttribute("stop-color",z(F.color)),I.appendChild(H)}),x==="circle"){var O=_.r,D=_.l,N=_.t,U=_.b;O===-1?I.setAttribute("cx","100%"):D===-1&&I.setAttribute("cx","0%"),N===-1?I.setAttribute("cy","0%"):U===-1&&I.setAttribute("cy","100%")}else v!=null&&v.ang&&I.setAttribute("gradientTransform","rotate(".concat(v.ang,")"));k.appendChild(I),t.appendChild(k),r.setAttribute("fill","url(#background_grad_fill_".concat(c.uuid,")"))}(o,P,g):g.setAttribute("fill",z(s)||"transparent"):g.setAttribute("fill","transparent"),a.width?(g.setAttribute("stroke-width",a.width+"px"),g.setAttribute("stroke",z(a.color)||"transparent")):g.setAttribute("stroke-width","0"),g.setAttribute("stroke-dasharray",function(c){return c&&c.type!=="solid"?({sysDot:[1,1],sysDash:[3,1],dash:[4,3],dashDot:[4,3,1,3],lgDash:[8,3],lgDashDot:[8,3,1,3],lgDashDotDot:[8,3,1,3,1,3]}[c.type]||[]).map(function(t){return t*c.width}).join(","):""}(a)),g.setAttribute("stroke-linecap",a.cap&&{sq:"square",rnd:"round",flat:"butt"}[a.cap]||"square"),g.setAttribute("stroke-linejoin",a.lineJoin||"round"),a.lineJoin==="miter"&&g.setAttribute("stroke-miterlimit",a.miterLim+""),P.appendChild(g));var R=[];d&&R.push("scaleX(-1)"),u&&R.push("scaleY(-1)"),P.style.setProperty("transform",R.join(" ")),w.appendChild(P);var j=function(c,t,r){var e;r===void 0&&(r=!1);var l=c.inheritProps,p=c.props,v=c.paragraphs;if(!v||v.length===0)return null;var x=S(S({},l),p),m=document.createElement("div");switch(m.className="text-wrapper",m.style.boxSizing="border-box",m.style.position="absolute",m.style.left=t.left+"px",x.vert==="eaVert"?(m.style.writingMode="vertical-rl",m.style.height=t.h+"px"):m.style.width=t.w+"px",x.anchor){case"b":m.style.bottom=t.bottom+"px";break;case"t":m.style.top=t.top+"px";break;case"ctr":m.style.top=t.top+t.h/2+"px",m.style.transform="translateY(-50%)";break;default:r?m.style.top=t.top+"px":(m.style.top=t.top+t.h/2+"px",m.style.transform="translateY(-50%)")}var _=[x.hasOwnProperty("tIns")?Math.floor(x.tIns)+"px":"3px",x.hasOwnProperty("rIns")?Math.floor(x.rIns)+"px":"5px",x.hasOwnProperty("bIns")?Math.floor(x.bIns)+"px":"3px",x.hasOwnProperty("lIns")?Math.floor(x.lIns)+"px":"5px"];m.style.padding=_.join(" ");for(var k={},I=0,B=function(N){var U=S(S({},N.inheritProps),N.props),F=void 0;if(U.buAutoNum){var H=U.level?+U.level:0;k[H]||(k[H]=0),!((e=N.rows)===null||e===void 0)&&e.length&&k[H]++,Object.keys(k).forEach(function(Q){+Q>H&&(k[Q]=0)}),F=Lt(N,k[H],{isFirst:I===0,isLast:v.length-1===I,bodyProps:x})}else F=Lt(N,0,{isFirst:I===0,isLast:v.length-1===I,bodyProps:x});m.appendChild(F),I++},O=0,D=v;O<D.length;O++)B(D[O]);return m}(o.textBody,L,o.isTextBox);return j&&w.appendChild(j),h&&w.style.setProperty("transform","rotate(".concat(h,"deg)")),w}function Te(o){var n=document.createElement("div"),i=o.extend;o.chExtend;var a=o.offset;o.chOffset;var s=o.flipV,h=o.flipH,d=o.rotate,u=a.x,w=a.y,b=i.w,y=i.h;n.className="group",n.style.position="absolute",n.style.left=u+"px",n.style.top=w+"px",n.style.width=b+"px",n.style.height=y+"px";var g=[];h&&g.push("scaleX(-1)"),s&&g.push("scaleY(-1)"),d&&g.push("rotate(".concat(d,"deg)")),n.style.transformOrigin="center center",n.style.transform=g.join(" ");for(var P=0;P<o.nodes.length;P++){var L=o.nodes[P],C=void 0;L instanceof xt?C=le(L):L instanceof pt?C=de(L):L instanceof pe&&(C=Te(L)),n.appendChild(C)}return n}var na=function(){function o(n,i,a){this.scale=1,this.wrapper=n,this.pptx=i,this.options=a,this._calcScaleAndRenderPort()}return o.prototype._calcScaleAndRenderPort=function(){var n=this.options.viewPort.width/this.pptx.width;this.scale=n;var i=this.options.viewPort.width,a=this.pptx.height*this.scale;this.renderPort={width:i,height:a,left:0,top:0}},o.prototype.renderSlide=function(n){var i=this.pptx.slides[n],a=document.createElement("div");a.classList.add("pptx-preview-slide-wrapper"),a.style.setProperty("width",this.renderPort.width+"px"),a.style.setProperty("height",this.renderPort.height+"px"),a.style.setProperty("position","relative"),a.style.margin="0 auto 10px",a.style.setProperty("background","#fff"),a.style.setProperty("overflow","hidden"),this._renderBackground(i,a),this._renderSlideMaster(i.slideMaster,a),this._renderSlideLayout(i.slideLayout,a),this._renderSlide(i,a),this.wrapper.append(a)},o.prototype._renderSlideMaster=function(n,i){var a=document.createElement("div");a.classList.add("slide-master-wrapper"),a.style.setProperty("position","absolute"),a.style.setProperty("left","0"),a.style.setProperty("top","0"),a.style.setProperty("width",this.pptx.width+"px"),a.style.setProperty("height",this.pptx.height+"px"),a.style.setProperty("transform","scale(".concat(this.scale,")")),a.style.setProperty("transform-origin","0 0");var s=ae([],n.nodes,!0).filter(function(u){return u.userDrawn});s.sort(function(u,w){return u.order>w.order?1:-1});for(var h=0;h<s.length;h++){var d=this._renderNode(s[h]);d&&a.append(d)}i.append(a)},o.prototype._renderSlideLayout=function(n,i){var a=document.createElement("div");a.classList.add("slide-layout-wrapper"),a.style.setProperty("position","absolute"),a.style.setProperty("left","0"),a.style.setProperty("top","0"),a.style.setProperty("width",this.pptx.width+"px"),a.style.setProperty("height",this.pptx.height+"px"),a.style.setProperty("transform","scale(".concat(this.scale,")")),a.style.setProperty("transform-origin","0 0");var s=ae([],n.nodes,!0).filter(function(u){return u.userDrawn});s.sort(function(u,w){return u.order>w.order?1:-1});for(var h=0;h<s.length;h++){var d=this._renderNode(s[h]);d&&a.append(d)}i.append(a)},o.prototype._renderSlide=function(n,i){var a=document.createElement("div");a.classList.add("slide-wrapper"),a.style.setProperty("position","absolute"),a.style.setProperty("left","0"),a.style.setProperty("top","0"),a.style.setProperty("width",this.pptx.width+"px"),a.style.setProperty("height",this.pptx.height+"px"),a.style.setProperty("transform","scale(".concat(this.scale,")")),a.style.setProperty("transform-origin","0 0");var s=ae([],n.nodes,!0);s.sort(function(u,w){return u.order>w.order?1:-1});for(var h=0;h<s.length;h++){var d=this._renderNode(s[h]);d&&a.append(d)}i.append(a)},o.prototype._renderNode=function(n){return n instanceof xt?le(n):n instanceof pt?de(n):n instanceof pe?Te(n):n instanceof Ie?function(i){var a=document.createElement("div"),s=i.extend,h=i.offset,d=i.flipV,u=i.flipH,w=i.rotate,b=h.x,y=h.y,g=s.w,P=s.h;a.className="smart-chart-diagram",a.style.position="absolute",a.style.left=b+"px",a.style.top=y+"px",a.style.width=g+"px",a.style.height=P+"px";var L=[];u&&L.push("scaleX(-1)"),d&&L.push("scaleY(-1)"),w&&L.push("rotate(".concat(w,"deg)")),a.style.transformOrigin="center center",a.style.transform=L.join(" ");for(var C=0;C<i.nodes.length;C++){var R=i.nodes[C],j=void 0;R instanceof xt?j=le(R):R instanceof pt&&(j=de(R)),a.appendChild(j)}return a}(n):n instanceof _e?function(i){var a=i.extend,s=i.offset,h=i.tr,d=i.tableGrid.gridCol,u=document.createElement("div");u.style.position="absolute",u.style.left=s.x+"px",u.style.top=s.y+"px",u.style.width=a.w+"px",u.style.height=a.h+"px";var w=document.createElement("table");return w.style.borderCollapse="collapse",h.forEach(function(b){var y=b.props,g=b.td,P=y.height,L=document.createElement("tr");L.style.height=P+"px",g.forEach(function(C,R){var j,c=C.props,t=C.inheritTcStyle,r=C.inheritTcTxStyle,e=C.paragraphs;if(!c.vMerge&&!c.hMerge){var l=document.createElement("td");l.style.width=d[R].width+"px",c.rowSpan&&l.setAttribute("rowspan",c.rowSpan+""),c.gridSpan&&l.setAttribute("colspan",c.gridSpan+"");var p=c.background||t.background;p&&(l.style.background=z(p));var v=S(S({},t.border),c.border),x=function(F){return F?F.toLowerCase().includes("dash")?"dashed":F.toLowerCase().includes("dot")?"dotted":"solid":"solid"};v.bottom&&(l.style.borderBottom="".concat(v.bottom.width,"px ").concat(x(v.bottom.type)," ").concat(z(v.bottom.color))),v.top&&(l.style.borderTop="".concat(v.top.width,"px ").concat(x(v.top.type)," ").concat(z(v.top.color))),v.left&&(l.style.borderLeft="".concat(v.left.width,"px ").concat(x(v.left.type)," ").concat(z(v.left.color))),v.right&&(l.style.borderRight="".concat(v.right.width,"px ").concat(x(v.right.type)," ").concat(z(v.right.color)));var m=document.createElement("div");switch(m.className="text-wrapper",m.style.boxSizing="border-box",m.style.width="100%",m.style.height="100%",m.style.overflow="hidden",m.style.display="flex",m.style.flexDirection="column",c.anchor){case"b":m.style.justifyContent="flex-end";break;case"t":m.style.justifyContent="flex-start";break;case"ctr":m.style.justifyContent="center"}var _=[c.hasOwnProperty("marT")?Math.floor(c.marT)+"px":"3px",c.hasOwnProperty("marR")?Math.floor(c.marR-1)+"px":"5px",c.hasOwnProperty("marB")?Math.floor(c.marB)+"px":"3px",c.hasOwnProperty("marL")?Math.floor(c.marL-1)+"px":"5px"];m.style.padding=_.join(" ");for(var k=S({},c),I={},B=e.map(function(F){return S(S({},F),{props:S({align:"l"},F.props),inheritRProps:S(S({},F.inheritRProps),r)})}),O=0,D=function(F){var H=S(S({},F.inheritProps),F.props),Q=void 0;if(H.buAutoNum){var W=H.level?+H.level:0;I[W]||(I[W]=0),!((j=F.rows)===null||j===void 0)&&j.length&&I[W]++,Object.keys(I).forEach(function(J){+J>W&&(I[J]=0)}),Q=Lt(F,I[W],{isFirst:O===0,isLast:e.length-1===O,bodyProps:k})}else Q=Lt(F,0,{isFirst:O===0,isLast:e.length-1===O,bodyProps:k});m.appendChild(Q),O++},N=0,U=B;N<U.length;N++)D(U[N]);l.append(m),L.append(l)}}),w.append(L)}),u.append(w),u}(n):void 0},o.prototype._renderBackground=function(n,i){var a,s=document.createElement("div");s.classList.add("slide-background"),s.style.setProperty("position","absolute"),s.style.setProperty("left","0"),s.style.setProperty("top","0"),s.style.setProperty("width","100%"),s.style.setProperty("height","100%");var h=n.background;if(h.type==="none"&&(h=n.slideLayout.background),h.type==="none"&&(h=n.slideMaster.background),h.type==="blipFill"){var d=h,u=d.base64,w=d.alpha,b=d.fillRect,y=b===void 0?{}:b,g=y.b,P=g===void 0?0:g,L=y.t,C=L===void 0?0:L,R=y.l,j=R===void 0?0:R,c=y.r,t=c===void 0?0:c,r=this.renderPort.width*j,e=this.renderPort.height*C,l=this.renderPort.width*(1-j-t),p=this.renderPort.height*(1-C-P);s.style.backgroundImage="url(".concat(u,")"),s.style.backgroundSize="".concat(l," ").concat(p),s.style.backgroundPosition="".concat(r,"px ").concat(e,"px"),w&&(s.style.opacity=w+""),s.style.backgroundRepeat="no-repeat"}else if(h.type==="solidFill"){var v=z(n.background)||z(n.slideLayout.background)||z(n.slideMaster.background);v?s.style.setProperty("background",v):s.style.setProperty("background","#fff")}else if(h.type==="gradFill")if(h.path==="circle"){var x=h.tileRect||{},m=(P=x.b,C=x.t,j=x.l,"radial-gradient(circle at ");(t=x.r)===-1?m+=" right":j===-1&&(m+=" left"),C===-1?m+=" top":P===-1&&(m+=" bottom"),P||C||j||t||(m+=" center"),m+=",",m+=h.gsList.map(function(k){return"".concat(z(k.color)," ").concat(100*k.pos+"%")}).join(","),s.style.setProperty("background",m)}else{var _=((a=h==null?void 0:h.lin)===null||a===void 0?void 0:a.ang)||0;m="linear-gradient(".concat(_+90,"deg,"),m+=h.gsList.map(function(k){return"".concat(z(k.color)," ").concat(100*k.pos+"%")}).join(","),s.style.setProperty("background",m)}i.append(s)},o}(),ra=function(){function o(n,i){this.dom=n,this.options=i,this._renderWrapper()}return o.prototype._renderWrapper=function(){var n=document.createElement("div");n.classList.add("pptx-preview-wrapper"),n.style.setProperty("background","#000"),n.style.setProperty("width",this.options.width+"px"),this.options.height&&n.style.setProperty("height",this.options.height+"px"),n.style.setProperty("position","relative"),n.style.setProperty("margin","0 auto"),this.options.height&&n.style.setProperty("overflow-y","auto"),this.dom.append(n),this.wrapper=n},o.prototype.preview=function(n){var i=this;return new Promise(function(a,s){i.wrapper.innerHTML="";var h=new ta;h.load(n).then(function(){try{for(var d=new na(i.wrapper,h,{viewPort:{width:i.options.width,height:i.options.height}}),u=0;u<h.slides.length;u++)d.renderSlide(u);a(h)}catch(w){s(w)}}).catch(function(d){s(d)})})},o}();function oa(o,n){return new ra(o,n)}const ca=Oe({name:"VueOfficePptx",props:{src:[String,ArrayBuffer,Blob],requestOptions:{type:Object,default:()=>({})},options:{type:Object,default:()=>({})}},emits:["rendered","error"],setup(o,{emit:n}){let i=null;const a=ke(null);function s(){let u=a.value,w=o.options.width||u.getBoundingClientRect().width||960,b=o.options.height||u.getBoundingClientRect().height||540;i=oa(u,{width:w,height:b})}function h(u){if(typeof u=="string")return fetch(u,o.requestOptions).then(w=>w.arrayBuffer());if(u instanceof ArrayBuffer)return Promise.resolve(u)}function d(){o.src&&h(o.src).then(u=>{i.preview(u).then(w=>{n("rendered",w)}).catch(w=>{n("error",w)})}).catch(u=>{n("error",u)})}return Ne(()=>{s(),d()}),Fe(()=>o.src,()=>{d()}),{rootRef:a}}}),ia={class:"vue-office-pptx"},sa={class:"vue-office-pptx-main",ref:"rootRef",style:{width:"100%",height:"100%"}};function ha(o,n,i,a,s,h){return Pe(),Ze("div",ia,[Se("div",sa,null,512)])}const bt=Ee(ca,[["render",ha]]);bt.install=function(o){o.component(bt.name,bt)};const la={style:{flex:"1",height:"0",background:"black"}},va={__name:"PptxDemo",setup(o){function n(){fe.hideLoading()}function i(u){console.log("出差",u),fe.hideLoading()}const a=location.origin+(location.pathname+"/").replace("//","/")+"static/test-files/test.pptx",s=ke(),h=Math.min(960,window.innerWidth),d={headers:{}};return(u,w)=>(Pe(),De(Ue,{accept:".pptx",placeholder:"请输入pptx文件地址","default-src":a},{default:ze(b=>[Se("div",la,[He(ue(bt),{ref_key:"docxRef",ref:s,src:b.src,"request-options":d,style:{height:"calc(100vh - 100px)"},options:{width:ue(h)},onRendered:n,onError:i},null,8,["src","options"])])]),_:1}))}};export{va as default};
